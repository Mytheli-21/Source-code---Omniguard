<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OmniProtect | AI-Powered Security Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d5bbb;
            --primary-light: #4a9aff;
            --secondary: #34a853;
            --secondary-light: #5dd67d;
            --danger: #ea4335;
            --danger-light: #ff6b5c;
            --warning: #f9ab00;
            --warning-light: #ffc233;
            --accent: #9c27b0;
            --accent-light: #c158dc;
            --purple: #8a2be2;
            --cyan: #00bcd4;
            --light: #f8f9fa;
            --dark: #202124;
            --gray-100: #f5f7fa;
            --gray-200: #e4e7eb;
            --gray-300: #cbd2d9;
            --gray-700: #52606d;
            --gray-800: #323f4b;
            --gray-900: #1f2933;
            --text: #333;
            --bg: #ffffff;
            --card-bg: #ffffff;
            --border: #dadce0;
            --shadow: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        .dark-mode {
            --primary: #4a9aff;
            --primary-dark: #1a73e8;
            --primary-light: #6cb2ff;
            --secondary: #5dd67d;
            --secondary-light: #7fe49d;
            --danger: #ff6b5c;
            --danger-light: #ff8a7e;
            --warning: #ffc233;
            --warning-light: #ffd166;
            --accent: #c158dc;
            --accent-light: #d77bee;
            --purple: #a855f7;
            --cyan: #22d3ee;
            --light: #1f2933;
            --dark: #f8f9fa;
            --text: #e8eaed;
            --bg: #0f172a;
            --card-bg: #1e293b;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.3);
            --glass-bg: rgba(30, 41, 59, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            background: radial-gradient(ellipse at top, var(--primary-dark) 0%, transparent 70%),
                        radial-gradient(ellipse at bottom, var(--accent) 0%, transparent 70%);
            background-attachment: fixed;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Particle Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        /* Enhanced Landing Page */
        .landing-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .landing-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--accent) 100%);
            opacity: 0.9;
            z-index: -1;
        }

        .background-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.2;
            z-index: -2;
            filter: blur(1px);
        }

        .landing-logo {
            margin-bottom: 30px;
            position: relative;
        }

        .landing-logo h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: white;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #fff 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo-quote {
            font-size: 1.2rem;
            opacity: 0.9;
            font-style: italic;
            margin-top: 10px;
            color: rgba(255, 255, 255, 0.8);
            max-width: 600px;
            line-height: 1.6;
        }

        .protection-status {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            margin: 30px 0;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .protection-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .protection-status h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 600;
            color: white;
        }

        .protection-icons {
            display: flex;
            justify-content: space-around;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
            position: relative;
        }

        .protection-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 250px;
            max-width: 300px;
            position: relative;
            cursor: pointer;
            z-index: 2;
            padding: 20px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.05);
        }

        .protection-icon:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.1);
        }

        .protection-icon:hover .icon-container {
            transform: scale(1.1) rotate(360deg);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.3);
        }

        .protection-icon .tooltip-content {
    position: absolute;
    top: 100%;
    background: white; /* Changed from glass-bg to white */
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    padding: 12px;
    color: #333; /* Black text color */
    font-size: 0.75rem; /* Reduced font size */
    line-height: 1.4;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    z-index: 10;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-15px);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    pointer-events: none;
    margin-top: 12px;
    max-height: 300px;
    overflow-y: auto;
    min-width: 250px;
    max-width: 280px;
}

/* WhatsApp tooltip positioned to the left */
#whatsappIcon .tooltip-content {
    left: -20px;
    right: auto;
}

/* Web Protection tooltip positioned to the right */
#webIcon .tooltip-content {
    right: -20px;
    left: auto;
}

.protection-icon:hover .tooltip-content {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* ===== ENHANCED TOOLTIP WITH ANIMATIONS ===== */
.protection-icon .tooltip-content {
    position: absolute;
    top: 100%;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 15px;
    color: white;
    font-size: 0.75rem;
    line-height: 1.5;
    box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    z-index: 10;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-15px) scale(0.95);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    pointer-events: none;
    margin-top: 15px;
    max-height: 320px;
    overflow-y: auto;
    width: 280px;
}

/* WhatsApp tooltip positioned to avoid cutoff */
#whatsappIcon .tooltip-content {
    left: -30px;
    right: auto;
}

/* Web Protection tooltip positioned to avoid cutoff */
#webIcon .tooltip-content {
    right: -30px;
    left: auto;
}

.protection-icon:hover .tooltip-content {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
    animation: tooltipEntry 0.5s ease-out,
               tooltipFloat 3s ease-in-out infinite 0.5s,
               tooltipGlow 2s ease-in-out infinite 0.5s;
}

/* Entry animation */
@keyframes tooltipEntry {
    0% {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }
    70% {
        transform: translateY(5px) scale(1.02);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Floating animation */
@keyframes tooltipFloat {
    0%, 100% { 
        transform: translateY(0);
    }
    50% { 
        transform: translateY(-5px);
    }
}

/* Glow animation */
@keyframes tooltipGlow {
    0%, 100% { 
        box-shadow: 
            0 15px 35px rgba(0, 0, 0, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2),
            0 0 20px rgba(26, 115, 232, 0.3);
    }
    50% { 
        box-shadow: 
            0 20px 40px rgba(0, 0, 0, 0.5),
            inset 0 1px 0 rgba(255, 255, 255, 0.3),
            0 0 30px rgba(26, 115, 232, 0.5);
    }
}

/* Tooltip content styles */
.tooltip-content h4 {
    margin-bottom: 10px;
    color: rgb(16, 14, 14);
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 8px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.tooltip-content p {
    margin-bottom: 10px;
    font-size: 0.75rem;
    opacity: 0.9;
    line-height: 1.4;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.tooltip-content ul {
    list-style: none;
    margin: 8px 0 12px 0;
    padding: 0;
}

.tooltip-content li {
    margin-bottom: 6px;
    padding-left: 18px;
    position: relative;
    font-size: 0.7rem;
    opacity: 0.9;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
}

.tooltip-content li:hover {
    opacity: 1;
    transform: translateX(5px);
}

.tooltip-content li::before {
    content: 'âœ“';
    position: absolute;
    left: 0;
    color: #5dd67d;
    font-weight: bold;
    font-size: 0.8rem;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    animation: checkPulse 2s infinite;
}

@keyframes checkPulse {
    0%, 100% { 
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        transform: scale(1);
    }
    50% { 
        text-shadow: 0 0 10px #5dd67d;
        transform: scale(1.2);
    }
}

/* Scrollbar styling */
.tooltip-content::-webkit-scrollbar {
    width: 5px;
}

.tooltip-content::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    backdrop-filter: blur(10px);
}

.tooltip-content::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 10px;
}

.tooltip-content::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}

/* ===== ENHANCED DUAL ICONS ANIMATIONS ===== */
.dual-icons {
    display: flex;
    gap: 15px;
    position: relative;
    z-index: 2;
}

.dual-icons i {
    font-size: 48px;
    color: rgb(169, 165, 165);
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    animation: iconPulse 2s infinite;
}

.dual-icons i:first-child {
    transform: translateX(0px) translateY(0px); /* Center it */
    animation-delay: 0s;
}

.dual-icons i:last-child {
    transform: translateX(0px) translateY(0px); /* Center it */
    animation-delay: 0.5s;
}
/* ADD YOUR CODE RIGHT HERE */
/* Specific fix for WhatsApp icon */
#whatsappIcon .dual-icons i:first-child {
    transform: translateX(-3px) translateY(1px) scale(0.95);
}

#whatsappIcon .dual-icons i:last-child {
    transform: translateX(3px) translateY(-1px) scale(0.95);
}
/* END OF YOUR CODE */

@keyframes iconPulse {
    0%, 100% { 
        transform: translateX(0) scale(1);
        filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    }
    50% { 
        transform: translateX(0) scale(1.1);
        filter: drop-shadow(0 8px 16px rgba(0,0,0,0.4));
    }
}

.protection-icon:hover .dual-icons i:first-child {
    transform: translateX(0) rotate(-20deg) scale(1.2);
    animation: whatsappSpin 0.8s ease-out;
}

.protection-icon:hover .dual-icons i:last-child {
    transform: translateX(0) rotate(20deg) scale(1.2);
    animation: shieldSpin 0.8s ease-out;
}

@keyframes whatsappSpin {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(-180deg) scale(1.3); }
    100% { transform: rotate(-20deg) scale(1.2); }
}

@keyframes shieldSpin {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(180deg) scale(1.3); }
    100% { transform: rotate(20deg) scale(1.2); }
}

/* Icon glow effect on hover */
.protection-icon:hover .dual-icons i {
    filter: drop-shadow(0 8px 20px rgba(255, 255, 255, 0.3));
    animation: iconGlow 1s infinite alternate;
}

@keyframes iconGlow {
    from { 
        filter: drop-shadow(0 8px 20px rgba(255, 255, 255, 0.3));
    }
    to { 
        filter: drop-shadow(0 8px 30px rgba(255, 255, 255, 0.6));
    }
}

.protection-icon span {
    font-size: 18px;
    font-weight: 700;
    color: rgb(28, 27, 27);
    margin-top: 15px;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

.protection-icon:hover span {
    transform: translateY(-3px);
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    color: rgba(255, 255, 255, 0.95);
    animation: textGlow 1.5s infinite alternate;
}

@keyframes textGlow {
    from { text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); }
    to { text-shadow: 0 0 20px rgba(255, 255, 255, 0.5), 0 2px 5px rgba(0, 0, 0, 0.3); }
}

.protection-icon small {
    font-size: 13px;
    opacity: 0.8;
    color: rgba(255, 255, 255, 0.8);
    margin-top: 5px;
    max-width: 200px;
    line-height: 1.4;
    transition: all 0.3s ease;
}

.protection-icon:hover small {
    opacity: 1;
    transform: translateY(-2px);
    color: white;
}

/* Icon container enhanced animations */
.icon-container {
    width: 140px;
    height: 140px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    animation: containerFloat 3s ease-in-out infinite;
}

@keyframes containerFloat {
    0%, 100% { 
        transform: translateY(0) rotate(0deg);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    50% { 
        transform: translateY(-10px) rotate(5deg);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
    }
}

.protection-icon:hover .icon-container {
    transform: scale(1.1) rotate(360deg);
    box-shadow: 0 0 50px rgba(255, 255, 255, 0.4);
    animation: containerSpin 0.8s ease-out, 
               containerGlow 2s infinite alternate;
}

@keyframes containerSpin {
    0% { transform: scale(1) rotate(0deg); }
    100% { transform: scale(1.1) rotate(360deg); }
}

@keyframes containerGlow {
    0% { box-shadow: 0 0 30px rgba(255, 255, 255, 0.3); }
    100% { box-shadow: 0 0 60px rgba(255, 255, 255, 0.6); }
}

.icon-container::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background: inherit;
    border-radius: 50%;
    filter: blur(15px);
    opacity: 0.5;
    animation: pulseGlow 2s infinite;
    z-index: 1;
}

@keyframes pulseGlow {
    0%, 100% { 
        opacity: 0.5; 
        transform: scale(1);
    }
    50% { 
        opacity: 0.8; 
        transform: scale(1.2);
    }
}

/* Make sure icons stay above the glow */
.dual-icons i {
    position: relative;
    z-index: 2;
}

        .proceed-btn {
            background: white;
            color: var(--primary);
            border: none;
            border-radius: 50px;
            padding: 18px 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 30px auto 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(26, 115, 232, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 10px 30px rgba(26, 115, 232, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 15px 40px rgba(26, 115, 232, 0.5); }
        }

        .proceed-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 40px rgba(26, 115, 232, 0.5);
            animation: none;
        }

        .proceed-btn i {
            font-size: 1.2rem;
        }

        .landing-features {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 25px;
            margin-top: 50px;
            max-width: 1200px;
        }

        @media (max-width: 1024px) {
            .landing-features {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .landing-features {
                grid-template-columns: 1fr;
            }
        }

        .feature {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            opacity: 0.8;
            transition: all 0.3s ease;
            padding: 25px 20px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            min-height: 200px;
        }

        .feature:hover {
            opacity: 1;
            transform: translateY(-10px) scale(1.05);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .feature i {
            font-size: 40px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .feature:hover i {
            transform: rotate(360deg);
        }

        .feature span {
            color: white;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
        }

        .feature-desc {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            text-align: center;
            line-height: 1.5;
            transition: all 0.3s ease;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }

        .feature:hover .feature-desc {
            opacity: 1;
            max-height: 100px;
            margin-top: 10px;
        }

        /* Enhanced Dashboard */
        .dashboard {
            display: none;
        }

        /* Modern Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 3px;
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .logo-icon {
            font-size: 36px;
            color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: spinSlow 20s linear infinite;
        }

        @keyframes spinSlow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logo-text h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .logo-text .tagline {
            font-size: 12px;
            opacity: 0.7;
            font-style: italic;
            color: var(--text);
        }

        .version-badge {
            background: linear-gradient(135deg, var(--accent), var(--purple));
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 10px;
            position: absolute;
            top: -8px;
            right: -25px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--card-bg);
            padding: 8px 16px;
            border-radius: 25px;
            box-shadow: 0 4px 6px var(--shadow);
            border: 1px solid var(--border);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--gray-300) 0%, var(--gray-700) 100%);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        input:checked + .slider {
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), var(--danger-light));
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), var(--warning-light));
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-light));
            color: white;
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--purple), var(--accent));
            color: white;
        }

        .btn-cyan {
            background: linear-gradient(135deg, var(--cyan), var(--primary));
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px var(--shadow);
        }

        .btn-text {
            font-size: 14px;
        }

        /* Status Cards */
        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px var(--shadow);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            animation: cardAppear 0.6s ease-out backwards;
            min-height: 180px;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .status-card:nth-child(1) { animation-delay: 0.1s; }
        .status-card:nth-child(2) { animation-delay: 0.2s; }
        .status-card:nth-child(3) { animation-delay: 0.3s; }
        .status-card:nth-child(4) { animation-delay: 0.4s; }

        .status-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px var(--shadow);
        }

        .status-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        .status-card.danger::before {
            background: linear-gradient(90deg, var(--danger), var(--warning));
        }

        .status-card.warning::before {
            background: linear-gradient(90deg, var(--warning), var(--accent));
        }

        .status-card.success::before {
            background: linear-gradient(90deg, var(--secondary), var(--cyan));
        }

        .status-card h3 {
            font-size: 14px;
            margin-bottom: 15px;
            color: var(--text);
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-card .value {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-card.danger .value {
            background: linear-gradient(135deg, var(--danger), var(--warning));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-card.warning .value {
            background: linear-gradient(135deg, var(--warning), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-card.success .value {
            background: linear-gradient(135deg, var(--secondary), var(--cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-card .description {
            font-size: 14px;
            color: var(--text);
            opacity: 0.7;
            margin-bottom: 10px;
        }

        .trend {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 20px;
            background: var(--bg);
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }

        .trend.up {
            color: var(--secondary);
            border: 1px solid var(--secondary);
        }

        .trend.down {
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* Enhanced Dashboard Layout */
        .dashboard-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        @media (max-width: 1024px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
        }

        /* Enhanced Cards */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px var(--shadow);
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: slideInLeft 0.8s ease-out;
            min-height: 650px;
        }

        .card:nth-child(2) {
            animation: slideInRight 0.8s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        .card-header h2 {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Enhanced Manual Test Section */
        .manual-test-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid var(--border);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .test-input-group {
            display: flex;
            gap: 10px;
            flex: 1;
            min-width: 300px;
        }

        .test-input {
            flex: 1;
            padding: 12px 20px;
            border-radius: 10px;
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .test-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
        }

        .test-buttons {
            display: flex;
            gap: 10px;
        }

        .test-sample {
            margin-top: 15px;
            padding: 15px;
            background: var(--bg);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .sample-title {
            font-size: 13px;
            margin-bottom: 8px;
            color: var(--text);
            opacity: 0.7;
        }

        .samples {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sample-btn {
            padding: 8px 15px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .sample-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .test-result {
            display: none;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            animation: slideDown 0.3s ease;
            border-left: 4px solid var(--primary);
        }

        .test-result.high { background: rgba(234, 67, 53, 0.1); border-left-color: var(--danger); }
        .test-result.medium { background: rgba(249, 171, 0, 0.1); border-left-color: var(--warning); }
        .test-result.low { background: rgba(52, 168, 83, 0.1); border-left-color: var(--secondary); }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Advanced Chart Containers */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
            min-height: 250px;
        }

        .chart-container:hover {
            transform: translateY(-5px);
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .chart-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .chart-wrapper {
            height: 200px;
            position: relative;
        }

        /* Enhanced Threat Types */
        .threat-types {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 640px) {
            .threat-types {
                grid-template-columns: 1fr;
            }
        }

        .threat-type {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 12px;
            background: var(--bg);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.5s ease-out backwards;
            min-height: 80px;
        }

        .threat-type:nth-child(1) { animation-delay: 0.1s; }
        .threat-type:nth-child(2) { animation-delay: 0.2s; }
        .threat-type:nth-child(3) { animation-delay: 0.3s; }
        .threat-type:nth-child(4) { animation-delay: 0.4s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .threat-type:hover {
            transform: translateX(10px);
            box-shadow: 0 10px 20px var(--shadow);
        }

        .threat-type i {
            position: absolute;
            right: 15px;
            opacity: 0.5;
            color: var(--text);
            transition: all 0.3s ease;
        }

        .threat-type:hover i {
            opacity: 1;
            transform: translateX(5px);
        }

        .threat-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: relative;
            z-index: 1;
            flex-shrink: 0;
        }

        .threat-color::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            background: inherit;
            opacity: 0.3;
            animation: pulseColor 2s infinite;
        }

        @keyframes pulseColor {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }

        .threat-info {
            flex: 1;
            z-index: 1;
        }

        .threat-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text);
        }

        .threat-count {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
        }

        /* Real-time Activity Feed */
        .activity-feed {
            margin: 20px 0;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .activity-header h3 {
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-controls {
            display: flex;
            gap: 8px;
        }
        /* Enhanced Activity Controls */
.activity-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 2px solid var(--border);
}

.activity-controls {
    display: flex;
    gap: 8px;
}

.activity-controls .btn-icon {
    width: 35px;
    height: 35px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--bg);
    color: var(--text);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 14px;
}

.activity-controls .btn-icon:hover {
    background: var(--primary);
    color: white;
    transform: scale(1.1);
    border-color: var(--primary);
}

.activity-controls .btn-icon:active {
    transform: scale(0.95);
}

/* Activity icon colors */
.activity-icon.ai-update {
    background: linear-gradient(135deg, var(--purple), var(--accent));
}

.activity-icon.scan {
    background: linear-gradient(135deg, var(--secondary), var(--cyan));
}

.activity-icon.sync {
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
}

.activity-icon.threat {
    background: linear-gradient(135deg, var(--danger), var(--warning));
}

.activity-icon.report {
    background: linear-gradient(135deg, var(--warning), var(--accent-light));
}

        .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            border-radius: 10px;
            background: var(--bg);
            margin-bottom: 10px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
            animation: slideInRightSmall 0.5s ease-out backwards;
        }

        @keyframes slideInRightSmall {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .activity-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
            font-size: 16px;
        }

        .activity-content {
            flex: 1;
        }

        .activity-text {
            font-size: 14px;
            color: var(--text);
            margin-bottom: 4px;
        }

        .activity-time {
            font-size: 12px;
            opacity: 0.7;
            color: var(--text);
        }

        /* Enhanced Logs Container */
        .logs-container {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
            margin-top: 15px;
        }

        .logs-container::-webkit-scrollbar {
            width: 8px;
        }

        .logs-container::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 4px;
        }

        .logs-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 4px;
        }

        /* Enhanced Log Items */
        .log-item {
            background: var(--bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
            animation: logEntry 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) backwards;
        }

        @keyframes logEntry {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .log-item.high {
            border-left-color: var(--danger);
            animation: dangerPulse 2s infinite;
        }

        @keyframes dangerPulse {
            0%, 100% { box-shadow: 0 5px 15px rgba(234, 67, 53, 0.1); }
            50% { box-shadow: 0 5px 25px rgba(234, 67, 53, 0.3); }
        }

        .log-item.medium {
            border-left-color: var(--warning);
        }

        .log-item.low {
            border-left-color: var(--secondary);
        }

        .log-item:hover {
            transform: translateX(5px) scale(1.02);
            box-shadow: 0 10px 20px var(--shadow);
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .log-type {
            font-weight: 700;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text);
        }

        .log-time {
            font-size: 12px;
            opacity: 0.7;
            background: var(--bg);
            padding: 4px 10px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .log-content {
            font-size: 14px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            line-height: 1.5;
            color: var(--text);
        }

        .log-tags {
            display: flex;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .log-tag {
            background: var(--bg);
            border: 1px solid var(--border);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            opacity: 0.7;
            color: var(--text);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .log-tag:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .log-details {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            position: relative;
            z-index: 1;
            animation: slideDown 0.3s ease;
        }

        .log-details.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .detail-item {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .detail-label {
            font-weight: 600;
            min-width: 140px;
            font-size: 13px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text);
        }

        .detail-value {
            flex: 1;
            font-size: 13px;
            opacity: 0.8;
            color: var(--text);
        }

        .log-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        /* Enhanced Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(5px);
            }
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 40px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            animation: modalSlideUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        .modal-header h2 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--text);
            opacity: 0.7;
            transition: opacity 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--bg);
        }

        .close-modal:hover {
            opacity: 1;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            transform: rotate(90deg);
        }

        .notification-settings {
            margin-top: 20px;
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .notification-settings::-webkit-scrollbar {
            width: 6px;
        }

        .notification-settings::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 3px;
        }

        .notification-settings::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 3px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item > div {
            flex: 1;
        }

        .setting-item h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text);
        }

        .setting-item p {
            font-size: 14px;
            opacity: 0.7;
            color: var(--text);
            line-height: 1.4;
        }

        .timer-input {
            width: 80px;
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-weight: 600;
            text-align: center;
            margin: 0 10px;
        }

        /* Language Selector */
        .language-selector {
            margin: 20px 0;
            padding: 20px;
            background: var(--bg);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .language-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .language-option {
            padding: 10px 20px;
            border-radius: 8px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .language-option:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .language-option.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border-color: var(--primary);
        }

        /* Enhanced Notification Scheduler */
        .notification-scheduler {
            background: var(--bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .scheduler-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 15px;
        }

        .time-slot {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .time-label {
            font-weight: 600;
            min-width: 120px;
            color: var(--text);
            font-size: 13px;
        }

        .time-select {
            flex: 1;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 13px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 10px 30px rgba(26, 115, 232, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            animation: floatFab 3s ease-in-out infinite;
        }

        @keyframes floatFab {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 15px 40px rgba(26, 115, 232, 0.6);
            animation: none;
        }

        #exportBtn {
            bottom: 100px;
            background: linear-gradient(135deg, var(--secondary), var(--cyan));
        }

        #refreshAllBtn {
            bottom: 170px;
            background: linear-gradient(135deg, var(--warning), var(--accent));
        }

        /* Live Indicator */
        .live-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, var(--danger), var(--warning));
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            animation: livePulse 1s infinite;
            z-index: 100;
        }

        @keyframes livePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .live-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Additional Info Panel - RESTRUCTURED LAYOUT */
        .info-panel {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 30px;
        }

        @media (max-width: 1200px) {
            .info-panel {
                grid-template-columns: 1fr;
            }
        }

        .info-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-5px);
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        .info-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-card p {
            font-size: 14px;
            color: var(--text);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .insight-tag {
    background: linear-gradient(135deg, var(--warning), var(--accent));
    color: white;
    padding: 10px 20px; /* Slightly larger padding */
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: block; /* Changed from inline-block to block */
    animation: tagFloat 2s ease-in-out infinite;
    margin: 15px auto; /* Centers horizontally and adds vertical spacing */
    text-align: center;
    width: fit-content; /* Makes box only as wide as content */
    max-width: 90%; /* Prevents it from being too wide */
    margin-top: 25px; /* Moves it down */
    margin-bottom: 15px; /* Adds space below */
}

        @keyframes tagFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        /* ===== ENHANCED SECURITY RECOMMENDATIONS ===== */
.recommendations-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 15px 0;
}

.recommendation-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 15px;
    background: var(--bg);
    border-radius: 10px;
    border-left: 4px solid var(--border);
    transition: all 0.3s ease;
    cursor: pointer;
}

.recommendation-item:hover {
    transform: translateX(5px);
    background: var(--card-bg);
    box-shadow: 0 5px 15px var(--shadow);
}

.recommendation-item i {
    font-size: 16px;
    color: var(--primary);
    margin-top: 2px;
    width: 20px;
    text-align: center;
}

.recommendation-content {
    flex: 1;
}

.recommendation-content strong {
    display: block;
    font-size: 13px;
    color: var(--text);
    margin-bottom: 5px;
    line-height: 1.4;
}

.priority-badge {
    font-size: 10px;
    font-weight: 700;
    padding: 3px 8px;
    border-radius: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Priority Colors */
.recommendation-item.high-priority {
    border-left-color: var(--danger);
}

.recommendation-item.high-priority .priority-badge {
    background: rgba(234, 67, 53, 0.1);
    color: var(--danger);
    border: 1px solid rgba(234, 67, 53, 0.3);
}

.recommendation-item.medium-priority {
    border-left-color: var(--warning);
}

.recommendation-item.medium-priority .priority-badge {
    background: rgba(249, 171, 0, 0.1);
    color: var(--warning);
    border: 1px solid rgba(249, 171, 0, 0.3);
}

.recommendation-item.low-priority {
    border-left-color: var(--secondary);
}

.recommendation-item.low-priority .priority-badge {
    background: rgba(52, 168, 83, 0.1);
    color: var(--secondary);
    border: 1px solid rgba(52, 168, 83, 0.3);
}

/* Hover effects for each priority */
.recommendation-item.high-priority:hover {
    background: rgba(234, 67, 53, 0.05);
}

.recommendation-item.medium-priority:hover {
    background: rgba(249, 171, 0, 0.05);
}

.recommendation-item.low-priority:hover {
    background: rgba(52, 168, 83, 0.05);
}

/* Progress indicator */
.recommendation-progress {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
}

.progress-label {
    font-size: 12px;
    color: var(--text);
    opacity: 0.7;
}

.progress-bar {
    flex: 1;
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--secondary), var(--primary));
    border-radius: 3px;
    width: 40%; /* 4 out of 10 recommendations implemented */
}

.progress-text {
    font-size: 12px;
    font-weight: 600;
    color: var(--primary);
    min-width: 40px;
}
/* ===== END SECURITY RECOMMENDATIONS ===== */

        .protection-meter {
            height: 12px;
            background: var(--bg);
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }

        .meter-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--cyan));
            border-radius: 6px;
            width: 94%;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .meter-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            100% { left: 100%; }
        }

        .meter-text {
            font-size: 12px;
            color: var(--text);
            opacity: 0.7;
            text-align: center;
            margin-top: -15px;
        }

        /* NEW: Enhanced Global Threat Distribution (Horizontal Layout) */
        .global-threat-distribution {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .global-map-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            justify-content: center;
        }

        .global-map-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: var(--bg);
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: visible;
            min-width: 180px;
            flex: 1;
        }

        .global-map-item:hover {
            transform: scale(1.05) translateY(-5px);
            box-shadow: 0 10px 25px var(--shadow);
            z-index: 100;
        }

        .global-map-flag {
            font-size: 32px;
            margin-bottom: 10px;
            animation: flagWave 3s ease-in-out infinite;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes flagWave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }

        .global-map-count {
            font-size: 22px;
            font-weight: 800;
            color: var(--danger);
            margin: 8px 0;
        }

        .global-map-country {
            font-size: 13px;
            font-weight: 600;
            margin-top: 5px;
            color: var(--text);
        }

        .global-map-details {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            background: var(--card-bg);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 30px var(--shadow);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            min-width: 200px;
            max-width: 250px;
            font-size: 11px;
            line-height:1.4;
        }

        .global-map-item:hover .global-map-details {
            opacity: 1;
            visibility: visible;
            transform: translateX(-20%) translateY(-20%);
        }

        .global-map-details h4 {
            margin-bottom: 8px;
            color: var(--primary);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .global-map-details ul {
            list-style: none;
            margin: 8px 0;
        }

        .global-map-details li {
            margin-bottom: 5px;
            padding-left: 12px;
            position: relative;
            font-size:10px;
        }

        .global-map-details li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: var(--danger);
        }
        .global-map-details p {
    margin: 3px 0; /* Added for consistent spacing */
    font-size: 10px; /* Added for smaller text */
}

.global-map-details strong {
    font-size: 10px; /* Added for smaller bold text */
}

.global-map-details small {
    font-size: 9px; /* Added for smaller timestamp */
}

        .top-threats {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-top: 8px;
            width: 100%;
        }

        .top-threat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 10px;
            padding: 4px 8px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }

        .threat-name {
            font-weight: 600;
        }

        .threat-count {
            color: var(--danger);
            font-weight: 700;
        }

        /* Enhanced Threat Timeline */
        .threat-timeline {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .timeline-container {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--bg);
        }

        .timeline-container::-webkit-scrollbar {
            height: 6px;
        }

        .timeline-container::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 3px;
        }

        .timeline-container::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 3px;
        }

        .timeline-item {
            flex: 0 0 auto;
            width: 70px;
            text-align: center;
            padding: 12px 5px;
            background: var(--bg);
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: visible;
        }

        .timeline-item:hover {
            transform: translateY(-8px) scale(1.1);
            box-shadow: 0 10px 20px var(--shadow);
            z-index: 5;
        }

        .timeline-item.high {
            border-bottom: 3px solid var(--danger);
        }

        .timeline-item.medium {
            border-bottom: 3px solid var(--warning);
        }

        .timeline-item.low {
            border-bottom: 3px solid var(--secondary);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(to top, rgba(255,255,255,0.1), transparent);
            transition: height 0.3s ease;
        }

        .timeline-item:hover::before {
            height: 100%;
        }

        .timeline-hour {
            font-weight: 700;
            font-size: 13px;
            color: var(--text);
            margin-bottom: 8px;
        }

        .timeline-count {
            font-size: 20px;
            font-weight: 800;
            color: var(--danger);
            margin: 5px 0;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .timeline-popup {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background: var(--card-bg);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border);
            box-shadow: 0 5px 15px var(--shadow);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            width: 200px;
            font-size: 12px;
            pointer-events: none;
        }

        .timeline-item:hover .timeline-popup {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-15px);
        }

        .timeline-popup h5 {
            margin-bottom: 5px;
            color: var(--primary);
            font-size: 11px;
        }

        .timeline-popup p {
            margin: 3px 0;
            font-size: 11px;
            line-height: 1.4;
        }

        /* NEW: Threat Heat Map (Last 7 Days) */
        .threat-heatmap-week {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .heatmap-week-container {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        /* Enhanced Heat Map Day Cells */
.heatmap-week-cell {
    aspect-ratio: 1;
    border-radius: 10px;
    background: var(--border);
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 10px;
    text-align: center;
}

.heatmap-week-cell:hover {
    transform: scale(1.15);
    z-index: 2;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.heatmap-day-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
}

.day-name {
    font-size: 15px;
    font-weight: 700;
    color: var(--text);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.threat-count {
    font-size: 25px;
    font-weight: 800;
    color: rgb(52, 50, 50);
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    margin: 5px 0;
}

.day-desc {
    font-size: 10px;
    line-height: 1.3;
    color: rgba(16, 15, 15, 0.9);
    text-shadow: 0 1px 2px rgba(177, 175, 175, 0.5);
    max-width: 90%;
    word-break: break-word;
}

/* Color intensities for different threat levels */
.heatmap-week-cell.low { 
    background: linear-gradient(135deg, rgba(52, 168, 83, 0.6), rgba(52, 168, 83, 0.3));
    border: 2px solid rgba(52, 168, 83, 0.4);
}
.heatmap-week-cell.medium { 
    background: linear-gradient(135deg, rgba(249, 171, 0, 0.6), rgba(249, 171, 0, 0.3));
    border: 2px solid rgba(249, 171, 0, 0.4);
}
.heatmap-week-cell.high { 
    background: linear-gradient(135deg, rgba(234, 67, 53, 0.6), rgba(234, 67, 53, 0.3));
    border: 2px solid rgba(234, 67, 53, 0.4);
}
.heatmap-week-cell.critical { 
    background: linear-gradient(135deg, rgba(234, 67, 53, 0.9), rgba(234, 67, 53, 0.6));
    border: 2px solid rgba(234, 67, 53, 0.8);
    animation: criticalPulse 2s infinite;
}

@keyframes criticalPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(234, 67, 53, 0.4); }
    50% { box-shadow: 0 0 0 5px rgba(234, 67, 53, 0.2); }
}

/* For responsive design */
@media (max-width: 768px) {
    .heatmap-week-cell {
        padding: 5px;
    }
    
    .day-name {
        font-size: 10px;
    }
    
    .threat-count {
        font-size: 16px;
    }
    
    .day-desc {
        font-size: 8px;
        display: none; /* Hide description on mobile */
    }
    
    .heatmap-week-cell:hover .day-desc {
        display: block;
        position: absolute;
        background: rgba(0,0,0,0.8);
        padding: 5px;
        border-radius: 5px;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        width: 120px;
        z-index: 100;
    }
}

        .heatmap-week-cell.low { background: rgba(52, 168, 83, 0.3); }
        .heatmap-week-cell.medium { background: rgba(249, 171, 0, 0.3); }
        .heatmap-week-cell.high { background: rgba(234, 67, 53, 0.3); }
        .heatmap-week-cell.critical { background: rgba(234, 67, 53, 0.7); }

        .heatmap-week-label {
            font-size: 11px;
            color: var(--text);
            opacity: 0.7;
            text-align: center;
            margin-top: 5px;
        }

        .heatmap-week-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 11px;
            color: var(--text);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* Security Score Meter */
        .security-score {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .score-circle {
            position: relative;
            width: 120px;
            height: 120px;
        }

        .score-circle svg {
            width: 120px;
            height: 120px;
            transform: rotate(-90deg);
        }

        .score-circle-bg {
            fill: none;
            stroke: var(--border);
            stroke-width: 8;
        }

        .score-circle-progress {
            fill: none;
            stroke: var(--secondary);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 339;
            stroke-dashoffset: 339;
            animation: progressAnimation 2s ease-out forwards;
        }

        @keyframes progressAnimation {
            to { stroke-dashoffset: 68; }
        }

        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 32px;
            font-weight: 800;
            color: var(--secondary);
        }

        .score-details {
            flex: 1;
        }

        .score-details h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--text);
        }

        .score-factors {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .score-factor {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }

        .factor-bar {
            flex: 1;
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            margin: 0 10px;
            overflow: hidden;
        }

        .factor-fill {
            height: 100%;
            background: var(--secondary);
            border-radius: 3px;
            transition: width 1s ease;
        }

        /* Quick Stats Cards */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .quick-stat {
            background: var(--bg);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .quick-stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px var(--shadow);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .stat-label {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 3px;
        }

        /* AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 1000;
        }

        .ai-assistant-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--purple), var(--accent));
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(156, 39, 176, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: floatAI 3s ease-in-out infinite;
        }

        @keyframes floatAI {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(5deg); }
            66% { transform: translateY(-5px) rotate(-5deg); }
        }

        .ai-assistant-btn:hover {
            transform: scale(1.1) rotate(45deg);
            animation: none;
        }

        /* AI Assistant Chat Modal */
        .ai-chat-modal {
            position: fixed;
            bottom: 100px;
            left: 30px;
            width: 400px;
            height: 500px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            z-index: 1001;
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border);
            animation: chatSlideUp 0.3s ease-out;
        }

        @keyframes chatSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .ai-chat-header {
            background: linear-gradient(135deg, var(--purple), var(--accent));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-chat-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
        }

        .close-chat {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .close-chat:hover {
            opacity: 1;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 360px;
        }

        .ai-chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .ai-chat-messages::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 3px;
        }

        .ai-chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--purple), var(--accent));
            border-radius: 3px;
        }

        .chat-message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            animation: messageAppear 0.3s ease-out;
        }

        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-bottom-right-radius: 4px;
        }

        .ai-message {
            align-self: flex-start;
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
            border-bottom-left-radius: 4px;
        }

        .ai-chat-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: var(--bg);
        }

        .chat-input-group {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border-radius: 25px;
            border: 2px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
        }

        .send-chat-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--purple), var(--accent));
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-chat-btn:hover {
            transform: scale(1.1);
        }

        /* Quick Actions Panel */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .quick-actions {
                grid-template-columns: 1fr;
            }
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background: var(--bg);
            border-radius: 12px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-5px);
        }

        .action-btn i {
            font-size: 24px;
        }

        .action-btn span {
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }

        /* Enhanced Refresh Button Animation */
        .fa-spin-fast {
            animation: spin-fast 0.5s linear infinite;
        }

        @keyframes spin-fast {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Report Preview Modal */
        .report-preview-modal {
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .report-preview {
            background: white;
            color: #333;
            padding: 40px;
            border-radius: 10px;
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
        }

        .report-header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #1a73e8;
            padding-bottom: 20px;
        }

        .report-header h1 {
            color: #1a73e8;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .report-section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }

        .report-section h2 {
            color: #1a73e8;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .report-table th,
        .report-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .report-table th {
            background: #f5f7fa;
            color: #1a73e8;
            font-weight: 600;
        }

        .report-chart {
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            text-align: center;
        }

        .report-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 3px solid #eee;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        /* Dashboard enhancements */
        .dashboard-welcome {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            animation: welcomeSlide 1s ease-out;
        }

        @keyframes welcomeSlide {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dashboard-welcome::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100"><path fill="rgba(255,255,255,0.1)" d="M0,70L1000,0V100H0Z"/></svg>');
            background-size: cover;
            opacity: 0.3;
        }

        .dashboard-welcome h2 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .dashboard-welcome p {
            opacity: 0.9;
            max-width: 600px;
        }

        /* NEW ENHANCEMENT: Animated Security Shield */
        .security-shield {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
        }

        .shield-outer {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            animation: shieldFloat 3s ease-in-out infinite;
        }

        @keyframes shieldFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        .shield-inner {
            position: absolute;
            width: 60%;
            height: 60%;
            background: white;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            top: 20%;
            left: 20%;
            animation: shieldSpin 20s linear infinite;
        }

        @keyframes shieldSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .shield-center {
            position: absolute;
            width: 30%;
            height: 30%;
            background: var(--danger);
            border-radius: 50%;
            top: 35%;
            left: 35%;
            animation: shieldPulse 2s infinite;
        }

        @keyframes shieldPulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        /* Advanced Filters */
        .advanced-filters {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text);
            opacity: 0.8;
        }

        .filter-select {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 12px;
            cursor: pointer;
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* System Health */
        .system-health {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background: var(--bg);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .health-label {
            font-weight: 600;
            min-width: 120px;
            color: var(--text);
        }

        .health-bar {
            flex: 1;
            height: 12px;
            background: var(--border);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--cyan));
            border-radius: 6px;
            transition: width 1s ease;
        }

        .health-value {
            font-weight: 700;
            color: var(--secondary);
            min-width: 50px;
            text-align: right;
        }

        /* Export Options */
        .export-options {
            position: fixed;
            bottom: 160px;
            right: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 15px 35px var(--shadow);
            display: none;
            flex-direction: column;
            gap: 10px;
            z-index: 999;
            border: 1px solid var(--border);
            animation: slideUp 0.3s ease;
        }

        .export-options.show {
            display: flex;
        }

        .export-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateX(5px);
        }

        /* Log Actions */
        .log-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .btn-icon:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .btn-icon.active {
            background: var(--primary);
            color: white;
        }

        .btn-icon .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Stats animation */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: var(--bg);
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: scale(1.05);
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary);
            animation: countUp 2s ease-out;
        }

        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
            color: var(--text);
        }

        /* Time Range Selector */
        .time-range select {
            padding: 8px 15px;
            border-radius: 10px;
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-range select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
        }

        /* Custom Notification System */
        .custom-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            min-width: 300px;
            background: linear-gradient(135deg, var(--primary-dark), var(--accent));
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 9999;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideInNotification 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-origin: top right;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideInNotification {
            from {
                opacity: 0;
                transform: translateX(100%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        .custom-notification.hide {
            animation: slideOutNotification 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes slideOutNotification {
            from {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateX(100%) scale(0.8);
            }
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .notification-message {
            font-size: 12px;
            opacity: 0.9;
            line-height: 1.4;
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            font-size: 18px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .notification-close:hover {
            opacity: 1;
            background: rgba(255, 255, 255, 0.1);
        }

        .notification-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 0 0 0 15px;
            animation: notificationTimer linear forwards;
        }

        @keyframes notificationTimer {
            from { width: 100%; }
            to { width: 0%; }
        }

        .custom-notification.high {
            background: linear-gradient(135deg, var(--danger), var(--warning));
        }

        .custom-notification.medium {
            background: linear-gradient(135deg, var(--warning), var(--accent-light));
        }

        .custom-notification.low {
            background: linear-gradient(135deg, var(--secondary), var(--cyan));
        }

        /* Suggested Questions */
        .suggested-questions {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .suggested-question {
            padding: 8px 12px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text);
        }

        .suggested-question:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Additional Charts Container */
        .additional-charts {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .additional-charts {
                grid-template-columns: 1fr;
            }
        }

        /* NEW: Protection Status Card */
        .protection-status-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .protection-status-card:hover {
            transform: translateY(-5px);
        }

        .protection-status-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            animation: gradientFlow 3s linear infinite;
            background-size: 200% 100%;
        }

        /* NEW: Security Insights Horizontal Layout */
        .security-insights-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .security-insights-panel {
                grid-template-columns: 1fr;
            }
        }

        /* NEW: Threat Intelligence Panel */
        .threat-intel-panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border);
            margin-top: 30px;
        }

        .threat-intel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .threat-intel-item {
            background: var(--bg);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--primary);
        }

        .threat-intel-item.high {
            border-left-color: var(--danger);
        }

        .threat-intel-item.medium {
            border-left-color: var(--warning);
        }

        .threat-intel-item.low {
            border-left-color: var(--secondary);
        }
/* ===== END SECURITY RECOMMENDATIONS ===== */

/* Clear button styling */
.test-input-group .btn-danger {
    padding: 10px 15px !important;
    min-width: 50px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

.test-input-group .btn-danger i {
    font-size: 14px !important;
    margin: 0 !important;
}


        /* Responsive Design */
        @media (max-width: 1200px) {
            .landing-features {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .dashboard-content {
                grid-template-columns: 1fr;
            }
            
            .info-panel {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-modal {
                width: 350px;
                height: 500px;
            }
            
            .global-map-container {
                flex-direction: column;
            }
            
            .global-map-item {
                min-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .landing-logo h1 {
                font-size: 2.5rem;
            }
            
            .protection-icons {
                flex-direction: column;
                align-items: center;
                gap: 40px;
            }
            
            .protection-icon {
                max-width: 100%;
                width: 100%;
            }
            
            .protection-icon .tooltip-content {
                width: 90%;
                left: 5%;
                transform: translateX(0) translateY(20px);
            }
            
            .controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .status-bar {
                grid-template-columns: 1fr;
            }
            
            .threat-types {
                grid-template-columns: 1fr;
            }
            
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 25px;
                margin: 20px;
            }
            
            .fab {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            #exportBtn {
                bottom: 80px;
            }
            
            #refreshAllBtn {
                bottom: 140px;
            }
            
            .scheduler-grid {
                grid-template-columns: 1fr;
            }

            .custom-notification {
                top: 20px;
                right: 10px;
                left: 10px;
                min-width: auto;
            }

            .ai-assistant {
                bottom: 20px;
                left: 20px;
            }
            
            .ai-chat-modal {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
                bottom: 80px;
                height: 450px;
            }
            
            .heatmap-week-container {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .global-map-container {
                grid-template-columns: 1fr;
            }
            
            .security-insights-panel {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .protection-icon {
                padding: 15px;
            }
            
            .dual-icons {
                gap: 15px;
            }
            
            .dual-icons i {
                font-size: 40px;
            }
            
            .test-controls {
                flex-direction: column;
            }
            
            .test-input-group {
                min-width: 100%;
            }
            
            .log-actions {
                flex-wrap: wrap;
            }
            
            .quick-stats {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-modal {
                height: 400px;
            }
            
            .heatmap-week-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Animation classes */
        .animate__animated {
            animation-duration: 1s;
            animation-fill-mode: both;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* NEW: Report Modal Enhancements */
        .report-modal-content {
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
        }

        .report-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .report-download-prompt {
            background: rgba(52, 168, 83, 0.1);
            border: 1px solid rgba(52, 168, 83, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .report-download-prompt h4 {
            color: var(--secondary);
            margin-bottom: 10px;
        }

        /* NEW: Enhanced AI Assistant Responses */
        .ai-response-section {
            margin: 10px 0;
            padding-left: 15px;
            border-left: 3px solid var(--primary);
        }

        .ai-tip {
            background: rgba(26, 115, 232, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            font-size: 12px;
        }

        .ai-warning {
            background: rgba(249, 171, 0, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            font-size: 12px;
        }

        .ai-success {
            background: rgba(52, 168, 83, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            font-size: 12px;
        }

        /* Time range update animation */
        .time-range-updating {
            animation: timeRangeUpdate 1s ease;
        }

        @keyframes timeRangeUpdate {
            0% { opacity: 0.5; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Gif and Image styling */
        .animated-gif {
            width: 100%;
            border-radius: 10px;
            margin: 10px 0;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .country-details-popup {
            display: none;
            position: absolute;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 30px var(--shadow);
            z-index: 1000;
            max-width: 300px;
            font-size: 12px;
        }

        .country-details-popup.show {
            display: block;
            animation: popupAppear 0.3s ease;
        }

        @keyframes popupAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div id="particles-js"></div>

    <!-- Background Video -->
    <video autoplay muted loop class="background-video">
        <source src="https://assets.mixkit.co/videos/preview/mixkit-abstract-digital-background-46165-large.mp4" type="video/mp4">
    </video>

    <!-- Custom Notification Container -->
    <div id="notificationContainer"></div>

    <!-- AI Assistant Chat Modal -->
    <div class="ai-chat-modal" id="aiChatModal">
        <div class="ai-chat-header">
            <h3><i class="fas fa-robot"></i> AI Security Assistant</h3>
            <button class="close-chat" id="closeChatBtn">&times;</button>
        </div>
        <div class="ai-chat-messages" id="chatMessages">
            <div class="chat-message ai-message">
                <p><strong>Hello! I'm your AI Security Assistant.</strong></p>
                <p>I can help you with:</p>
                <div class="ai-response-section">
                    <p>â€¢ Threat analysis and detailed explanations</p>
                    <p>â€¢ Comprehensive security recommendations</p>
                    <p>â€¢ System status and security enhancements</p>
                    <p>â€¢ Threat prevention strategies</p>
                    <p>â€¢ Report generation and analysis</p>
                    <p>â€¢ How-to guides for using OmniProtect</p>
                </div>
                <p>What security concern can I help you with today?</p>
                <div class="suggested-questions">
                    <div class="suggested-question" onclick="askAIQuestion('How can I enhance my overall security?')">Enhance Security</div>
                    <div class="suggested-question" onclick="askAIQuestion('How to use OmniProtect effectively?')">Usage Guide</div>
                    <div class="suggested-question" onclick="askAIQuestion('Generate a security report')">Generate Report</div>
                    <div class="suggested-question" onclick="askAIQuestion('Latest security threats?')">Latest Threats</div>
                </div>
            </div>
        </div>
        <div class="ai-chat-input">
            <div class="chat-input-group">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask about security enhancements, usage, or reports...">
                <button class="send-chat-btn" id="sendChatBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Landing Page -->
    <div class="landing-page" id="landingPage">
        <div class="live-indicator">
            <span>LIVE PROTECTION ACTIVE</span>
        </div>
        
        <div class="landing-logo animate__animated animate__fadeInDown">
            <h1>OmniProtect</h1>
            <p class="logo-quote">"Your Digital Guardian in a Connected World"</p>
        </div>
        
        <div class="protection-status animate__animated animate__fadeInUp">
            <h2>AI-Driven Security Across All Digital Platforms</h2>
            
            <div class="protection-icons">
                <div class="protection-icon" id="whatsappIcon">
                    <div class="tooltip-content">
                        <h4><i class="fab fa-whatsapp"></i> WhatsApp Security Features</h4>
                        <p>Advanced AI analyzes messages in real-time with 99.7% accuracy:</p>
                        <ul>
                            <li>Phishing link detection & blocking</li>
                            <li>Scam message identification</li>
                            <li>Malicious content filtering</li>
                            <li>Group chat monitoring</li>
                            <li>Attachment scanning</li>
                            <li>Real-time threat alerts</li>
                            <li>Encryption verification</li>
                            <li>Contact validation</li>
                        </ul>
                    </div>
                    <div class="icon-container">
                        <div class="dual-icons">
                            <i class="fab fa-whatsapp"></i>
                            <i class="fas fa-shield-alt"></i>
                        </div>
                    </div>
                    <span>WhatsApp Security</span>
                    <small>Real-time message threat analysis</small>
                </div>
                <div class="protection-icon" id="webIcon">
                    <div class="tooltip-content">
                        <h4><i class="fas fa-globe"></i> Web Protection Features</h4>
                        <p>Complete web security across all browsers:</p>
                        <ul>
                            <li>Malicious website blocking</li>
                            <li>Real-time URL analysis</li>
                            <li>Phishing detection & prevention</li>
                            <li>Harmful content filtering</li>
                            <li>Credential theft protection</li>
                            <li>Tracking script blocking</li>
                            <li>SSL certificate validation</li>
                            <li>Cookie consent management</li>
                        </ul>
                    </div>
                    <div class="icon-container">
                        <div class="dual-icons">
                            <i class="fas fa-globe"></i>
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                    <span>Web Protection</span>
                    <small>Advanced URL & content filtering</small>
                </div>
            </div>
            
            <p>Powered by next-generation AI algorithms to detect and neutralize sophisticated cyber threats in real-time.</p>
            
            <!-- Animated Security Shield -->
            <div class="security-shield">
                <div class="shield-outer"></div>
                <div class="shield-inner"></div>
                <div class="shield-center"></div>
            </div>
            
            <button class="proceed-btn animate__animated pulse" id="proceedBtn">
                <i class="fas fa-shield-alt"></i>
                Access Security Dashboard
            </button>
        </div>
        
        <div class="landing-features animate__animated animate__fadeIn">
            <div class="feature" id="realtimeFeature">
                <i class="fas fa-bolt"></i>
                <span>Real-time Detection</span>
                <div class="feature-desc">
                    Instant threat detection with zero latency. Monitors all digital channels 24/7 for immediate response. Processes 1000+ events per second.
                </div>
            </div>
            <div class="feature" id="aiFeature">
                <i class="fas fa-brain"></i>
                <span>AI-Powered Analysis</span>
                <div class="feature-desc">
                    Machine learning algorithms analyze patterns and predict threats before they occur with 96% accuracy. Self-learning models improve daily.
                </div>
            </div>
            <div class="feature" id="predictiveFeature">
                <i class="fas fa-chart-line"></i>
                <span>Predictive Analytics</span>
                <div class="feature-desc">
                    Advanced predictive models forecast emerging threats and vulnerabilities based on global threat intelligence. 30-day threat prediction window.
                </div>
            </div>
            <div class="feature" id="databaseFeature">
                <i class="fas fa-database"></i>
                <span>Global Threat Database</span>
                <div class="feature-desc">
                    Access to real-time global threat intelligence database with over 10 million known threats and patterns. Updated every 5 minutes.
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard container" id="dashboard">
        <!-- Dashboard Welcome Section -->
        <div class="dashboard-welcome">
            <h2>Welcome to OmniProtect Dashboard</h2>
            <p>Your digital assets are actively protected. Real-time monitoring is enabled across all platforms.</p>
        </div>

        <header>
            <div class="logo-container">
                <div class="logo-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="logo-text">
                    <h1>OmniProtect</h1>
                    <p class="tagline">"Your Digital Guardian in a Connected World"</p>
                </div>
                <div class="version-badge">v3.0</div>
            </div>
            <div class="controls">
                <div class="toggle-container">
                    <i class="fas fa-moon"></i>
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-sun"></i>
                </div>
                <button class="btn btn-primary" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <span class="btn-text">Alerts</span>
                    <span class="badge" id="notificationBadge">3</span>
                </button>
                <button class="btn btn-warning" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i>
                    <span class="btn-text">Refresh</span>
                </button>
                <button class="btn btn-purple" id="aiScanBtn">
                    <i class="fas fa-robot"></i>
                    <span class="btn-text">AI Scan</span>
                </button>
                <button class="btn btn-danger" id="clearLogsBtn">
                    <i class="fas fa-trash"></i>
                    <span class="btn-text">Clear</span>
                </button>
            </div>
            
        </header>

        <!-- Quick Stats Cards -->
        <div class="quick-stats">
            <div class="quick-stat">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--primary), var(--accent));">
                    <i class="fas fa-shield-check"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value" id="protectionScore">94%</div>
                    <div class="stat-label">Protection Score</div>
                </div>
            </div>
            <div class="quick-stat">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--secondary), var(--cyan));">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value" id="responseSpeed">0.8s</div>
                    <div class="stat-label">Response Time</div>
                </div>
            </div>
            <div class="quick-stat">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--warning), var(--accent));">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value" id="threatsToday">18</div>
                    <div class="stat-label">Threats Today</div>
                </div>
            </div>
            <div class="quick-stat">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--purple), var(--danger));">
                    <i class="fas fa-globe"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value" id="countries">46</div>
                    <div class="stat-label">Countries Monitored</div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <div class="action-btn" onclick="performQuickAction('scan')">
                <i class="fas fa-search"></i>
                <span>Quick Scan</span>
            </div>
            <div class="action-btn" onclick="generateFullReport()">
                <i class="fas fa-file-alt"></i>
                <span>Generate Report</span>
            </div>
            <div class="action-btn" onclick="performQuickAction('whitelist')">
                <i class="fas fa-check-circle"></i>
                <span>Whitelist URL</span>
            </div>
            <div class="action-btn" onclick="performQuickAction('block')">
                <i class="fas fa-ban"></i>
                <span>Block Threat</span>
            </div>
        </div>

        <!-- System Health -->
        <div class="system-health">
            <div class="health-label">System Health</div>
            <div class="health-bar">
                <div class="health-fill" id="healthFill" style="width: 94%;"></div>
            </div>
            <div class="health-value" id="healthValue">94%</div>
        </div>

        <div class="status-bar">
            <div class="status-card">
                <h3><i class="fas fa-shield-check"></i> ACTIVE PROTECTION</h3>
                <div class="value">ON</div>
                <div class="description">Real-time monitoring enabled</div>
                <div class="trend up"><i class="fas fa-arrow-up"></i> 100%</div>
            </div>
            <div class="status-card danger">
                <h3><i class="fas fa-skull-crossbones"></i> THREATS BLOCKED</h3>
                <div class="value" id="threatsBlocked">3,247</div>
                <div class="description">Last 24 hours</div>
                <div class="trend up"><i class="fas fa-arrow-up"></i> 12.5%</div>
            </div>
            <div class="status-card warning">
                <h3><i class="fas fa-exclamation-triangle"></i> SUSPICIOUS ACTIVITIES</h3>
                <div class="value" id="suspiciousActivities">18</div>
                <div class="description">Requires attention</div>
                <div class="trend down"><i class="fas fa-arrow-down"></i> 5.3%</div>
            </div>
            <div class="status-card success">
                <h3><i class="fas fa-bolt"></i> RESPONSE TIME</h3>
                <div class="value" id="avgResponseTime">0.8s</div>
                <div class="description">Average threat response</div>
                <div class="trend up"><i class="fas fa-arrow-up"></i> 15.2%</div>
            </div>
        </div>
        
        <!-- 1. Threat Heat Map (Last 7 Days) -->
<div class="threat-heatmap-week">
    <h3><i class="fas fa-fire"></i> THREAT HEAT MAP (LAST 7 DAYS)</h3>
    <div class="heatmap-week-container" id="heatmapWeek">
        <!-- Heatmap cells will be populated here -->
    </div>
    <div class="heatmap-week-legend">
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(52, 168, 83, 0.3);"></div>
            <span>Low (0-20 threats)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(249, 171, 0, 0.3);"></div>
            <span>Medium (21-50 threats)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(234, 67, 53, 0.3);"></div>
            <span>High (51-80 threats)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(234, 67, 53, 0.7);"></div>
            <span>Critical (81+ threats)</span>
        </div>
    </div>
</div>
        
        <!-- 2. Enhanced Global Threat Distribution with 4 additional countries -->
        <div class="global-threat-distribution">
            <h3><i class="fas fa-globe-americas"></i> GLOBAL THREAT DISTRIBUTION</h3>
            <div class="global-map-container" id="globalThreatMap">
                <!-- Countries will be populated here -->
            </div>
        </div>
        
        <!-- 3. Advanced Filters -->
        <div class="advanced-filters">
            <h3><i class="fas fa-filter"></i> ADVANCED THREAT FILTERS</h3>
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">Threat Level</label>
                    <select class="filter-select" id="threatLevelFilter">
                        <option value="all">All Levels</option>
                        <option value="high">High Only</option>
                        <option value="medium">Medium & High</option>
                        <option value="low">Low & Above</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Time Period</label>
                    <select class="filter-select" id="timePeriodFilter">
                        <option value="1h">Last Hour</option>
                        <option value="24h">Last 24 Hours</option>
                        <option value="7d">Last 7 Days</option>
                        <option value="30d">Last 30 Days</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Platform</label>
                    <select class="filter-select" id="platformFilter">
                        <option value="all">All Platforms</option>
                        <option value="whatsapp">WhatsApp</option>
                        <option value="web">Web</option>
                        <option value="email">Email</option>
                        <option value="sms">SMS</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Threat Type</label>
                    <select class="filter-select" id="threatTypeFilter">
                        <option value="all">All Types</option>
                        <option value="phishing">Phishing</option>
                        <option value="malware">Malware</option>
                        <option value="spam">Spam</option>
                        <option value="scam">Scam</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button class="btn btn-primary" id="applyFiltersBtn">
                    <i class="fas fa-check"></i> Apply Filters
                </button>
                <button class="btn btn-danger" id="resetFiltersBtn">
                    <i class="fas fa-times"></i> Reset Filters
                </button>
                <button class="btn btn-purple" id="saveFilterBtn">
                    <i class="fas fa-save"></i> Save Filter
                </button>
            </div>
        </div>
        
        <!-- 4. Enhanced Threat Timeline with hover details -->
        <div class="threat-timeline">
            <h3><i class="fas fa-clock"></i> THREAT TIMELINE (LAST 24 HOURS)</h3>
            <div class="timeline-container" id="threatTimeline">
                <!-- Timeline items will be populated here -->
            </div>
        </div>
        
        <!-- Main Dashboard Content (Charts & Logs) -->
        <div class="dashboard-content">
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-exclamation-circle"></i> REAL-TIME THREAT ALERTS</h2>
                    <div class="time-range">
                        <select id="threatTimeRange">
                            <option value="1h">Last 1 hour</option>
                            <option value="24h" selected>Last 24 hours</option>
                            <option value="7d">Last 7 days</option>
                            <option value="30d">Last 30 days</option>
                        </select>
                    </div>
                </div>
                
                <div class="logs-container" id="threatLogs">
                    <!-- Threat logs will be populated here -->
                </div>
                
                <!-- Manual Test Section -->
                <div class="manual-test-section">
                    <h3><i class="fas fa-vial"></i> MANUAL SECURITY TEST</h3>
                    <div class="test-controls">
                        <div class="test-input-group">
                            <input type="text" class="test-input" id="testInput" placeholder="Enter URL or text to analyze...">
                            <button class="btn btn-primary" id="analyzeBtn">
                                <i class="fas fa-search"></i> Analyze
                            </button>
                        <button class="btn-danger" id="clearTestBtn" title="Clear input">
                        <i class="fas fa-times"></i>

                        </button>
                            
                        </div>
                        <div class="test-buttons">
                            <button class="btn btn-warning" id="testPhishing">
                                <i class="fas fa-fish"></i> Test Phishing
                            </button>
                            <button class="btn btn-danger" id="testMalware">
                                <i class="fas fa-virus"></i> Test Malware
                            </button>
                        </div>
                    </div>
                    
                    <div class="test-sample">
                        <div class="sample-title">Quick Test Samples:</div>
                        <div class="samples">
                            <button class="sample-btn" data-text="https://fake-bank-login.com">Phishing URL</button>
                            <button class="sample-btn" data-text="Your account has been compromised">Scam Message</button>
                            <button class="sample-btn" data-text="http://malicious-download.site">Malware Link</button>
                            <button class="sample-btn" data-text="https://google.com">Safe URL</button>
                        </div>
                    </div>
                    
                    <div class="test-result" id="testResult">
                        <div id="resultContent"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-bar"></i> THREAT ANALYTICS & INSIGHTS</h2>
                    <button class="btn btn-purple" id="refreshAnalytics">
                        <i class="fas fa-sync-alt"></i> Update
                    </button>
                </div>
                
                <!-- Additional Charts -->
                <div class="additional-charts">
                    <div class="chart-container">
                        <div class="chart-title"><i class="fas fa-chart-pie"></i> Threat Severity Distribution</div>
                        <div class="chart-wrapper">
                            <canvas id="severityChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title"><i class="fas fa-laptop"></i> Platform Distribution</div>
                        <div class="chart-wrapper">
                            <canvas id="platformChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Chart Grid -->
                <div class="chart-grid">
                    <div class="chart-container">
                        <div class="chart-title"><i class="fas fa-pie-chart"></i> Threat Types Distribution</div>
                        <div class="chart-wrapper">
                            <canvas id="threatTypeChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title"><i class="fas fa-chart-line"></i> Threat Trends</div>
                        <div class="chart-wrapper">
                            <canvas id="threatTrendChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Threat Types -->
                <div class="threat-types">
                    <div class="threat-type" data-threat="phishing">
                        <div class="threat-color" style="background: var(--danger);"></div>
                        <div class="threat-info">
                            <div class="threat-name">Phishing Attacks</div>
                            <div class="threat-count">1,243</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="threat-type" data-threat="malware">
                        <div class="threat-color" style="background: var(--warning);"></div>
                        <div class="threat-info">
                            <div class="threat-name">Malware</div>
                            <div class="threat-count">876</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="threat-type" data-threat="spam">
                        <div class="threat-color" style="background: var(--accent);"></div>
                        <div class="threat-info">
                            <div class="threat-name">Spam</div>
                            <div class="threat-count">754</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="threat-type" data-threat="suspicious">
                        <div class="threat-color" style="background: var(--cyan);"></div>
                        <div class="threat-info">
                            <div class="threat-name">Suspicious</div>
                            <div class="threat-count">374</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
                
                <!-- Security Score Meter -->
                <div class="security-score">
                    <div class="score-circle">
                        <svg>
                            <circle class="score-circle-bg" cx="60" cy="60" r="54"></circle>
                            <circle class="score-circle-progress" cx="60" cy="60" r="54" stroke-dashoffset="68"></circle>
                        </svg>
                        <div class="score-value">94</div>
                    </div>
                    <div class="score-details">
                        <h4>Security Score</h4>
                        <div class="score-factors">
                            <div class="score-factor">
                                <span>Web Protection</span>
                                <div class="factor-bar">
                                    <div class="factor-fill" style="width: 96%;"></div>
                                </div>
                                <span>96%</span>
                            </div>
                            <div class="score-factor">
                                <span>Message Security</span>
                                <div class="factor-bar">
                                    <div class="factor-fill" style="width: 92%;"></div>
                                </div>
                                <span>92%</span>
                            </div>
                            <div class="score-factor">
                                <span>AI Detection</span>
                                <div class="factor-bar">
                                    <div class="factor-fill" style="width: 94%;"></div>
                                </div>
                                <span>94%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Security Insights Horizontal Panel -->
        <div class="security-insights-panel">
            <!-- Protection Status Summary -->
            <div class="protection-status-card">
                <h3><i class="fas fa-shield-alt"></i> PROTECTION STATUS SUMMARY</h3>
                <p><strong>Current Status:</strong> All systems operational and actively protecting your digital assets.</p>
                <div class="protection-meter">
                    <div class="meter-bar"></div>
                </div>
                <div class="meter-text">Real-time Protection: Active across 8 security layers</div>
                <div class="ai-tip" style="margin-top: 15px;">
                    <strong>Tip:</strong> Regular security scans and keeping software updated enhances protection by 40%.
                </div>
            </div>
            
            <!-- Security Insights -->
            <div class="info-card">
                <h3><i class="fas fa-lightbulb"></i> SECURITY INSIGHTS</h3>
                <p>AI analysis indicates increased phishing attempts targeting financial institutions. The primary attack vector remains malicious links in unsolicited messages.</p>
                <div class="protection-meter">
                    <div class="meter-bar"></div>
                </div>
                <div class="meter-text">Overall Protection Level: 94%</div>
                <div class="insight-tag">RECOMMENDATION: Enable two-factor authentication for all accounts</div>
            </div>
        </div>

        <!-- New Threat Intelligence Panel -->
        <div class="threat-intel-panel">
            <h3><i class="fas fa-brain"></i> THREAT INTELLIGENCE UPDATES</h3>
            <div class="threat-intel-grid">
                <div class="threat-intel-item high">
                    <h4><i class="fas fa-exclamation-triangle"></i> Critical Threat</h4>
                    <p>New ransomware variant targeting financial data</p>
                    <small>Detection Rate: 98.7%</small>
                </div>
                <div class="threat-intel-item medium">
                    <h4><i class="fas fa-exclamation-circle"></i> Emerging Threat</h4>
                    <p>Phishing campaigns using AI-generated content</p>
                    <small>Detection Rate: 92.3%</small>
                </div>
                <div class="threat-intel-item low">
                    <h4><i class="fas fa-info-circle"></i> Security Update</h4>
                    <p>New security patches available for review</p>
                    <small>Priority: Medium</small>
                </div>
                <div class="threat-intel-item">
                    <h4><i class="fas fa-shield-alt"></i> Protection Boost</h4>
                    <p>AI models updated with latest threat signatures</p>
                    <small>Accuracy Improved: +2.4%</small>
                </div>
            </div>
        </div>

        <!-- Info Panel (Restructured as requested) -->
        <div class="info-panel">
            <!-- Activity Timeline -->
<div class="info-card">
    <div class="activity-header">
        <h3><i class="fas fa-history"></i> ACTIVITY TIMELINE</h3>
        <div class="activity-controls">
            <button class="btn-icon" id="pauseActivity" title="Pause/Resume Updates">
                <i class="fas fa-pause"></i>
            </button>
            <button class="btn-icon" id="clearActivity" title="Clear All Activities">
                <i class="fas fa-trash"></i>
            </button>
            <button class="btn-icon" id="refreshActivity" title="Refresh Timeline">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>
    </div>
    <div class="activity-feed" id="activityFeed">
        <!-- Activities will be populated here -->
    </div>
    <div class="activity-stats" style="margin-top: 15px; font-size: 12px; color: var(--text); opacity: 0.7; text-align: center;">
        <span id="activityCount">5 activities loaded</span>
        <span style="margin: 0 10px;">â€¢</span>
        <span id="activityStatus">Live updates active</span>
    </div>
</div>
            <!-- New Feature: Security Recommendations -->
<div class="info-card">
    <h3><i class="fas fa-tasks"></i> SECURITY RECOMMENDATIONS</h3>
    <div class="recommendations-container">
        <div class="recommendation-item high-priority">
            <i class="fas fa-shield-check"></i>
            <div class="recommendation-content">
                <strong>Enable automatic threat blocking for all high-risk activities</strong>
                <span class="priority-badge">HIGH PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item high-priority">
            <i class="fas fa-search"></i>
            <div class="recommendation-content">
                <strong>Schedule weekly comprehensive system scans</strong>
                <span class="priority-badge">HIGH PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item medium-priority">
            <i class="fas fa-certificate"></i>
            <div class="recommendation-content">
                <strong>Update all security certificates and licenses</strong>
                <span class="priority-badge">MEDIUM PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item medium-priority">
            <i class="fas fa-history"></i>
            <div class="recommendation-content">
                <strong>Review access logs for unusual patterns daily</strong>
                <span class="priority-badge">MEDIUM PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item high-priority">
            <i class="fas fa-database"></i>
            <div class="recommendation-content">
                <strong>Configure automated backup systems with 3-2-1 rule</strong>
                <span class="priority-badge">HIGH PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item medium-priority">
            <i class="fas fa-user-lock"></i>
            <div class="recommendation-content">
                <strong>Implement multi-factor authentication across all systems</strong>
                <span class="priority-badge">MEDIUM PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item low-priority">
            <i class="fas fa-graduation-cap"></i>
            <div class="recommendation-content">
                <strong>Conduct monthly security awareness training for staff</strong>
                <span class="priority-badge">LOW PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item high-priority">
            <i class="fas fa-network-wired"></i>
            <div class="recommendation-content">
                <strong>Establish network segmentation for critical assets</strong>
                <span class="priority-badge">HIGH PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item medium-priority">
            <i class="fas fa-mobile-alt"></i>
            <div class="recommendation-content">
                <strong>Enforce mobile device management policies</strong>
                <span class="priority-badge">MEDIUM PRIORITY</span>
            </div>
        </div>
        
        <div class="recommendation-item low-priority">
            <i class="fas fa-file-contract"></i>
            <div class="recommendation-content">
                <strong>Review and update incident response plans quarterly</strong>
                <span class="priority-badge">LOW PRIORITY</span>
            </div>
        </div>
    </div>
    
    <div class="ai-tip" style="margin-top: 20px;">
        <strong>Pro Tip:</strong> Implementing these recommendations can improve security by up to 85%. Start with high priority items first.
    </div>
</div>


        <!-- Notification Settings Modal -->
        <div class="modal" id="notificationModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-bell"></i> NOTIFICATION SETTINGS</h2>
                    <button class="close-modal" id="closeNotificationModal">&times;</button>
                </div>
                
                <div class="notification-settings">
                    <!-- Enhanced Language Settings with additional languages -->
                    <div class="language-selector">
                        <h3><i class="fas fa-language"></i> Preferred Language</h3>
                        <p>Select your preferred language for notifications and interface:</p>
                        <div class="language-options">
                            <div class="language-option active" data-lang="en">
                                <i class="fas fa-globe"></i>
                                <span>English</span>
                            </div>
                            <div class="language-option" data-lang="es">
                                <i class="fas fa-globe"></i>
                                <span>EspaÃ±ol</span>
                            </div>
                            <div class="language-option" data-lang="fr">
                                <i class="fas fa-globe"></i>
                                <span>FranÃ§ais</span>
                            </div>
                            <div class="language-option" data-lang="de">
                                <i class="fas fa-globe"></i>
                                <span>Deutsch</span>
                            </div>
                            <div class="language-option" data-lang="zh">
                                <i class="fas fa-globe"></i>
                                <span>ä¸­æ–‡</span>
                            </div>
                            <div class="language-option" data-lang="ar">
                                <i class="fas fa-globe"></i>
                                <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                            </div>
                            <div class="language-option" data-lang="hi">
                                <i class="fas fa-globe"></i>
                                <span>à¤¹à¤¿à¤¨à¥à¤¦à¥€</span>
                            </div>
                            <div class="language-option" data-lang="ta">
                                <i class="fas fa-globe"></i>
                                <span>à®¤à®®à®¿à®´à¯</span>
                            </div>
                            <div class="language-option" data-lang="te">
                                <i class="fas fa-globe"></i>
                                <span>à°¤à±†à°²à±à°—à±</span>
                            </div>
                            <div class="language-option" data-lang="ml">
                                <i class="fas fa-globe"></i>
                                <span>à´®à´²à´¯à´¾à´³à´‚</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <h3><i class="fas fa-exclamation-triangle"></i> High Priority Alerts</h3>
                            <p>Immediate notification for critical threats</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="highAlertsToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <h3><i class="fas fa-exclamation-circle"></i> Medium Priority Alerts</h3>
                            <p>Delayed notification for suspicious activities</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mediumAlertsToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <h3><i class="fas fa-info-circle"></i> Low Priority Alerts</h3>
                            <p>Daily summary for informational alerts</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="lowAlertsToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <h3><i class="fas fa-mobile-alt"></i> Push Notifications</h3>
                            <p>Receive alerts on mobile devices</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pushNotificationsToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <h3><i class="fas fa-envelope"></i> Email Notifications</h3>
                            <p>Receive alerts via email</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="emailNotificationsToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-scheduler">
                        <h3><i class="fas fa-clock"></i> Notification Schedule</h3>
                        <p>Set quiet hours for non-critical alerts</p>
                        <div class="scheduler-grid">
                            <div class="time-slot">
                                <span class="time-label">Quiet Hours Start</span>
                                <select class="time-select" id="quietStart">
                                    <option value="22:00">10:00 PM</option>
                                    <option value="23:00">11:00 PM</option>
                                    <option value="00:00">12:00 AM</option>
                                </select>
                            </div>
                            <div class="time-slot">
                                <span class="time-label">Quiet Hours End</span>
                                <select class="time-select" id="quietEnd">
                                    <option value="06:00">6:00 AM</option>
                                    <option value="07:00">7:00 AM</option>
                                    <option value="08:00">8:00 AM</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-success" id="saveNotificationSettings">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                    <button class="btn btn-danger" id="testNotification">
                        <i class="fas fa-bell"></i> Test Notification
                    </button>
                    <button class="btn btn-primary" id="closeModalBtn">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Export Options Panel -->
        <div class="export-options" id="exportOptions">
            <button class="export-btn" onclick="exportData('pdf')">
                <i class="fas fa-file-pdf"></i> Export as PDF
            </button>
            <button class="export-btn" onclick="exportData('excel')">
                <i class="fas fa-file-excel"></i> Export as Excel
            </button>
            <button class="export-btn" onclick="exportData('csv')">
                <i class="fas fa-file-csv"></i> Export as CSV
            </button>
            <button class="export-btn" onclick="exportData('json')">
                <i class="fas fa-file-code"></i> Export as JSON
            </button>
            <button class="export-btn" onclick="generateFullReport()">
                <i class="fas fa-chart-bar"></i> Full Report
            </button>
        </div>

        <!-- Floating Action Buttons -->
        <button class="fab" id="aiAssistantBtn">
            <i class="fas fa-robot"></i>
        </button>
        <button class="fab" id="exportBtn">
            <i class="fas fa-download"></i>
        </button>
        <button class="fab" id="refreshAllBtn">
            <i class="fas fa-sync-alt"></i>
        </button>

        <!-- Footer -->
        <footer style="text-align: center; padding: 20px; color: var(--text); opacity: 0.7; font-size: 12px; margin-top: 40px;">
            <p>OmniProtect Security Dashboard v3.0 â€¢ Â© 2024 All Rights Reserved</p>
            <p>24/7 Monitoring Active â€¢ Last Updated: <span id="lastUpdated">Just now</span></p>
        </footer>
    </div>

    <script>
        // Initialize global variables
        let threatLogs = [];
        let threatData = {
            types: {
                phishing: 1243,
                malware: 876,
                spam: 754,
                suspicious: 374,
                ransomware: 289,
                dataBreach: 187,
                botnet: 154,
                zeroDay: 89
            },
            timeline: [],
            countries: [],
            heatmapWeek: [],
            severity: {
                high: 456,
                medium: 789,
                low: 1023
            },
            platforms: {
                whatsapp: 567,
                web: 892,
                email: 345,
                sms: 189
            }
        };

        let charts = {};
        let notificationCount = 3;
        let isDarkMode = false;
        let currentFilters = {
            threatLevel: 'all',
            timePeriod: '24h',
            platform: 'all',
            threatType: 'all'
        };

        let currentLanguage = 'en';

        // Enhanced country data with 4 additional countries
        const countryData = [
            { 
                code: 'US', 
                name: 'United States', 
                threats: 874, 
                trend: 'up', 
                flag: 'ðŸ‡ºðŸ‡¸',
                topThreats: [
                    { name: 'Phishing Attacks', count: 342 },
                    { name: 'Ransomware', count: 187 },
                    { name: 'Data Breaches', count: 89 }
                ],
                primaryThreats: 'Phishing, Ransomware',
                lastUpdate: '5 minutes ago',
                details: 'Major target for financial phishing attacks. High ransomware activity targeting critical infrastructure.'
            },
            { 
                code: 'IN', 
                name: 'India', 
                threats: 756, 
                trend: 'up', 
                flag: 'ðŸ‡®ðŸ‡³',
                topThreats: [
                    { name: 'Mobile Malware', count: 298 },
                    { name: 'Phishing', count: 187 },
                    { name: 'SMS Scams', count: 95 }
                ],
                primaryThreats: 'Mobile Malware, SMS Scams',
                lastUpdate: '7 minutes ago',
                details: 'Rapid increase in mobile banking malware. SMS-based scams targeting UPI users.'
            },
            { 
                code: 'BR', 
                name: 'Brazil', 
                threats: 634, 
                trend: 'up', 
                flag: 'ðŸ‡§ðŸ‡·',
                topThreats: [
                    { name: 'Banking Trojans', count: 287 },
                    { name: 'Phishing', count: 156 },
                    { name: 'Ransomware', count: 78 }
                ],
                primaryThreats: 'Banking Trojans, Phishing',
                lastUpdate: '10 minutes ago',
                details: 'High volume of banking trojans targeting financial institutions. Growing ransomware attacks.'
            },
            { 
                code: 'RU', 
                name: 'Russia', 
                threats: 587, 
                trend: 'down', 
                flag: 'ðŸ‡·ðŸ‡º',
                topThreats: [
                    { name: 'State-Sponsored Attacks', count: 245 },
                    { name: 'Ransomware', count: 134 },
                    { name: 'DDoS Attacks', count: 67 }
                ],
                primaryThreats: 'State-Sponsored, Ransomware',
                lastUpdate: '12 minutes ago',
                details: 'Known for sophisticated state-sponsored attacks. Ransomware groups operating from the region.'
            },
            { 
                code: 'CN', 
                name: 'China', 
                threats: 542, 
                trend: 'stable', 
                flag: 'ðŸ‡¨ðŸ‡³',
                topThreats: [
                    { name: 'APT Attacks', count: 198 },
                    { name: 'Data Theft', count: 145 },
                    { name: 'Phishing', count: 87 }
                ],
                primaryThreats: 'APT Attacks, Data Theft',
                lastUpdate: '15 minutes ago',
                details: 'Advanced Persistent Threat (APT) groups active. Industrial espionage and data theft campaigns.'
            },
            { 
                code: 'GB', 
                name: 'United Kingdom', 
                threats: 498, 
                trend: 'up', 
                flag: 'ðŸ‡¬ðŸ‡§',
                topThreats: [
                    { name: 'Phishing', count: 201 },
                    { name: 'Malware', count: 145 },
                    { name: 'Business Email Compromise', count: 89 }
                ],
                primaryThreats: 'Phishing, BEC Attacks',
                lastUpdate: '8 minutes ago',
                details: 'Business Email Compromise (BEC) attacks targeting corporations. Financial sector under heavy phishing attempts.'
            },
            { 
                code: 'DE', 
                name: 'Germany', 
                threats: 421, 
                trend: 'stable', 
                flag: 'ðŸ‡©ðŸ‡ª',
                topThreats: [
                    { name: 'Industrial Espionage', count: 167 },
                    { name: 'Ransomware', count: 98 },
                    { name: 'Phishing', count: 76 }
                ],
                primaryThreats: 'Industrial Espionage, Ransomware',
                lastUpdate: '9 minutes ago',
                details: 'Industrial espionage targeting manufacturing sector. Ransomware attacks on critical infrastructure.'
            },
            { 
                code: 'JP', 
                name: 'Japan', 
                threats: 387, 
                trend: 'down', 
                flag: 'ðŸ‡¯ðŸ‡µ',
                topThreats: [
                    { name: 'Spear Phishing', count: 154 },
                    { name: 'Malware', count: 98 },
                    { name: 'DDoS', count: 65 }
                ],
                primaryThreats: 'Spear Phishing, Malware',
                lastUpdate: '11 minutes ago',
                details: 'Sophisticated spear phishing campaigns targeting executives. DDoS attacks on financial institutions.'
            },
            // Additional 4 countries
            { 
                code: 'AU', 
                name: 'Australia', 
                threats: 365, 
                trend: 'up', 
                flag: 'ðŸ‡¦ðŸ‡º',
                topThreats: [
                    { name: 'Business Email Compromise', count: 145 },
                    { name: 'Ransomware', count: 98 },
                    { name: 'Phishing', count: 76 }
                ],
                primaryThreats: 'BEC, Ransomware',
                lastUpdate: '6 minutes ago',
                details: 'Increasing BEC attacks targeting corporations. Ransomware targeting critical infrastructure.'
            },
            { 
                code: 'CA', 
                name: 'Canada', 
                threats: 342, 
                trend: 'stable', 
                flag: 'ðŸ‡¨ðŸ‡¦',
                topThreats: [
                    { name: 'Phishing', count: 156 },
                    { name: 'Malware', count: 98 },
                    { name: 'Data Breaches', count: 54 }
                ],
                primaryThreats: 'Phishing, Data Breaches',
                lastUpdate: '9 minutes ago',
                details: 'Phishing attacks targeting financial institutions. Data breaches in healthcare sector.'
            },
            { 
                code: 'FR', 
                name: 'France', 
                threats: 398, 
                trend: 'up', 
                flag: 'ðŸ‡«ðŸ‡·',
                topThreats: [
                    { name: 'Ransomware', count: 167 },
                    { name: 'Phishing', count: 123 },
                    { name: 'DDoS', count: 65 }
                ],
                primaryThreats: 'Ransomware, DDoS',
                lastUpdate: '7 minutes ago',
                details: 'Ransomware attacks targeting government agencies. DDoS attacks on financial institutions.'
            },
            { 
                code: 'KR', 
                name: 'South Korea', 
                threats: 412, 
                trend: 'stable', 
                flag: 'ðŸ‡°ðŸ‡·',
                topThreats: [
                    { name: 'APT Attacks', count: 187 },
                    { name: 'Phishing', count: 134 },
                    { name: 'Malware', count: 67 }
                ],
                primaryThreats: 'APT, Phishing',
                lastUpdate: '8 minutes ago',
                details: 'Advanced Persistent Threat groups targeting tech companies. Phishing attacks on cryptocurrency platforms.'
            }
        ];

        // Translations including new languages
        const translations = {
            en: {
                welcome: "Welcome to OmniProtect Dashboard",
                welcomeDesc: "Your digital assets are actively protected. Real-time monitoring is enabled across all platforms.",
                activeProtection: "ACTIVE PROTECTION",
                threatsBlocked: "THREATS BLOCKED",
                suspiciousActivities: "SUSPICIOUS ACTIVITIES",
                responseTime: "RESPONSE TIME",
                realtimeMonitoring: "Real-time monitoring enabled",
                last24Hours: "Last 24 hours",
                requiresAttention: "Requires attention",
                avgThreatResponse: "Average threat response",
                highPriorityAlerts: "High Priority Alerts",
                mediumPriorityAlerts: "Medium Priority Alerts",
                lowPriorityAlerts: "Low Priority Alerts",
                pushNotifications: "Push Notifications",
                emailNotifications: "Email Notifications",
                notificationSchedule: "Notification Schedule",
                quietHours: "Set quiet hours for non-critical alerts",
                saveSettings: "Save Settings",
                testNotification: "Test Notification",
                close: "Close"
            },
            es: {
                welcome: "Bienvenido al Panel de Control OmniProtect",
                welcomeDesc: "Sus activos digitales estÃ¡n protegidos activamente. La monitorizaciÃ³n en tiempo real estÃ¡ habilitada en todas las plataformas.",
                activeProtection: "PROTECCIÃ“N ACTIVA",
                threatsBlocked: "AMENAZAS BLOQUEADAS",
                suspiciousActivities: "ACTIVIDADES SOSPECHOSAS",
                responseTime: "TIEMPO DE RESPUESTA",
                realtimeMonitoring: "MonitorizaciÃ³n en tiempo real habilitada",
                last24Hours: "Ãšltimas 24 horas",
                requiresAttention: "Requiere atenciÃ³n",
                avgThreatResponse: "Respuesta promedio a amenazas",
                highPriorityAlerts: "Alertas de Alta Prioridad",
                mediumPriorityAlerts: "Alertas de Prioridad Media",
                lowPriorityAlerts: "Alertas de Baja Prioridad",
                pushNotifications: "Notificaciones Push",
                emailNotifications: "Notificaciones por Email",
                notificationSchedule: "Programa de Notificaciones",
                quietHours: "Establecer horas silenciosas para alertas no crÃ­ticas",
                saveSettings: "Guardar ConfiguraciÃ³n",
                testNotification: "Probar NotificaciÃ³n",
                close: "Cerrar"
            },
            fr: {
                welcome: "Bienvenue sur le Tableau de Bord OmniProtect",
                welcomeDesc: "Vos actifs numÃ©riques sont activement protÃ©gÃ©s. La surveillance en temps rÃ©el est activÃ©e sur toutes les plateformes.",
                activeProtection: "PROTECTION ACTIVE",
                threatsBlocked: "MENACES BLOQUÃ‰ES",
                suspiciousActivities: "ACTIVITÃ‰S SUSPECTES",
                responseTime: "TEMPS DE RÃ‰PONSE",
                realtimeMonitoring: "Surveillance en temps rÃ©el activÃ©e",
                last24Hours: "DerniÃ¨res 24 heures",
                requiresAttention: "NÃ©cessite une attention",
                avgThreatResponse: "Temps de rÃ©ponse moyen aux menaces",
                highPriorityAlerts: "Alertes Haute PrioritÃ©",
                mediumPriorityAlerts: "Alertes PrioritÃ© Moyenne",
                lowPriorityAlerts: "Alertes Basse PrioritÃ©",
                pushNotifications: "Notifications Push",
                emailNotifications: "Notifications par Email",
                notificationSchedule: "Planning des Notifications",
                quietHours: "DÃ©finir des heures calmes pour les alertes non critiques",
                saveSettings: "Enregistrer les ParamÃ¨tres",
                testNotification: "Tester la Notification",
                close: "Fermer"
            },
            hi: {
                welcome: "à¤“à¤®à¤¨à¥€à¤ªà¥à¤°à¥‹à¤Ÿà¥‡à¤•à¥à¤Ÿ à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ",
                welcomeDesc: "à¤†à¤ªà¤•à¥€ à¤¡à¤¿à¤œà¤¿à¤Ÿà¤² à¤¸à¤‚à¤ªà¤¤à¥à¤¤à¤¿à¤¯à¥‹à¤‚ à¤•à¥€ à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤°à¥‚à¤ª à¤¸à¥‡ à¤¸à¥à¤°à¤•à¥à¤·à¤¾ à¤•à¥€ à¤œà¤¾ à¤°à¤¹à¥€ à¤¹à¥ˆà¥¤ à¤¸à¤­à¥€ à¤ªà¥à¤²à¥‡à¤Ÿà¤«à¤¾à¤°à¥à¤®à¥‹à¤‚ à¤ªà¤° à¤µà¤¾à¤¸à¥à¤¤à¤µà¤¿à¤• à¤¸à¤®à¤¯ à¤¨à¤¿à¤—à¤°à¤¾à¤¨à¥€ à¤¸à¤•à¥à¤·à¤® à¤¹à¥ˆà¥¤",
                activeProtection: "à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤¸à¥à¤°à¤•à¥à¤·à¤¾",
                threatsBlocked: "à¤–à¤¤à¤°à¥‡ à¤…à¤µà¤°à¥à¤¦à¥à¤§",
                suspiciousActivities: "à¤¸à¤‚à¤¦à¤¿à¤—à¥à¤§ à¤—à¤¤à¤¿à¤µà¤¿à¤§à¤¿à¤¯à¤¾à¤",
                responseTime: "à¤ªà¥à¤°à¤¤à¤¿à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤¸à¤®à¤¯",
                realtimeMonitoring: "à¤µà¤¾à¤¸à¥à¤¤à¤µà¤¿à¤• à¤¸à¤®à¤¯ à¤¨à¤¿à¤—à¤°à¤¾à¤¨à¥€ à¤¸à¤•à¥à¤·à¤®",
                last24Hours: "à¤ªà¤¿à¤›à¤²à¥‡ 24 à¤˜à¤‚à¤Ÿà¥‡",
                requiresAttention: "à¤§à¥à¤¯à¤¾à¤¨ à¤•à¥€ à¤†à¤µà¤¶à¥à¤¯à¤•à¤¤à¤¾",
                avgThreatResponse: "à¤”à¤¸à¤¤ à¤–à¤¤à¤°à¤¾ à¤ªà¥à¤°à¤¤à¤¿à¤•à¥à¤°à¤¿à¤¯à¤¾",
                highPriorityAlerts: "à¤‰à¤šà¥à¤š à¤ªà¥à¤°à¤¾à¤¥à¤®à¤¿à¤•à¤¤à¤¾ à¤…à¤²à¤°à¥à¤Ÿ",
                mediumPriorityAlerts: "à¤®à¤§à¥à¤¯à¤® à¤ªà¥à¤°à¤¾à¤¥à¤®à¤¿à¤•à¤¤à¤¾ à¤…à¤²à¤°à¥à¤Ÿ",
                lowPriorityAlerts: "à¤•à¤® à¤ªà¥à¤°à¤¾à¤¥à¤®à¤¿à¤•à¤¤à¤¾ à¤…à¤²à¤°à¥à¤Ÿ",
                pushNotifications: "à¤ªà¥à¤¶ à¤…à¤§à¤¿à¤¸à¥‚à¤šà¤¨à¤¾à¤à¤‚",
                emailNotifications: "à¤ˆà¤®à¥‡à¤² à¤…à¤§à¤¿à¤¸à¥‚à¤šà¤¨à¤¾à¤à¤‚",
                notificationSchedule: "à¤…à¤§à¤¿à¤¸à¥‚à¤šà¤¨à¤¾ à¤…à¤¨à¥à¤¸à¥‚à¤šà¥€",
                quietHours: "à¤—à¥ˆà¤°-à¤®à¤¹à¤¤à¥à¤µà¤ªà¥‚à¤°à¥à¤£ à¤…à¤²à¤°à¥à¤Ÿ à¤•à¥‡ à¤²à¤¿à¤ à¤¶à¤¾à¤‚à¤¤ à¤˜à¤‚à¤Ÿà¥‡ à¤¸à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚",
                saveSettings: "à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸ à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",
                testNotification: "à¤…à¤§à¤¿à¤¸à¥‚à¤šà¤¨à¤¾ à¤ªà¤°à¥€à¤•à¥à¤·à¤£",
                close: "à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚"
            },
            ta: {
                welcome: "à®’à®®à¯à®©à®¿à®ªà¯à®°à¯Šà®Ÿà¯†à®•à¯à®Ÿà¯ à®Ÿà®¾à®·à¯à®ªà¯‹à®°à¯à®Ÿà¯à®•à¯à®•à¯ à®µà®°à®µà¯‡à®±à¯à®•à®¿à®±à¯‹à®®à¯",
                welcomeDesc: "à®‰à®™à¯à®•à®³à¯ à®Ÿà®¿à®œà®¿à®Ÿà¯à®Ÿà®²à¯ à®šà¯Šà®¤à¯à®¤à¯à®•à¯à®•à®³à¯ à®šà¯†à®¯à®²à®¿à®²à¯ à®ªà®¾à®¤à¯à®•à®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®•à®¿à®©à¯à®±à®©. à®…à®©à¯ˆà®¤à¯à®¤à¯ à®¤à®³à®™à¯à®•à®³à®¿à®²à¯à®®à¯ à®¨à®¿à®•à®´à¯à®¨à¯‡à®° à®•à®£à¯à®•à®¾à®£à®¿à®ªà¯à®ªà¯ à®‡à®¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà¯à®³à¯à®³à®¤à¯.",
                activeProtection: "à®šà¯†à®¯à®²à®¿à®²à¯ à®ªà®¾à®¤à¯à®•à®¾à®ªà¯à®ªà¯",
                threatsBlocked: "à®…à®šà¯à®šà¯à®±à¯à®¤à¯à®¤à®²à¯à®•à®³à¯ à®¤à®Ÿà¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®©",
                suspiciousActivities: "à®šà®¨à¯à®¤à¯‡à®•à®¤à¯à®¤à®¿à®±à¯à®•à¯à®°à®¿à®¯ à®šà¯†à®¯à®²à¯à®ªà®¾à®Ÿà¯à®•à®³à¯",
                responseTime: "à®ªà®¤à®¿à®²à¯ à®¨à¯‡à®°à®®à¯",
                realtimeMonitoring: "à®¨à®¿à®•à®´à¯à®¨à¯‡à®° à®•à®£à¯à®•à®¾à®£à®¿à®ªà¯à®ªà¯ à®‡à®¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯",
                last24Hours: "à®•à®Ÿà®¨à¯à®¤ 24 à®®à®£à®¿à®¨à¯‡à®°à®®à¯",
                requiresAttention: "à®•à®µà®©à®®à¯ à®¤à¯‡à®µà¯ˆ",
                avgThreatResponse: "à®šà®°à®¾à®šà®°à®¿ à®…à®šà¯à®šà¯à®±à¯à®¤à¯à®¤à®²à¯ à®ªà®¤à®¿à®²à¯",
                highPriorityAlerts: "à®‰à®¯à®°à¯ à®®à¯à®©à¯à®©à¯à®°à®¿à®®à¯ˆ à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆà®•à®³à¯",
                mediumPriorityAlerts: "à®¨à®Ÿà¯à®¤à¯à®¤à®° à®®à¯à®©à¯à®©à¯à®°à®¿à®®à¯ˆ à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆà®•à®³à¯",
                lowPriorityAlerts: "à®•à¯à®±à¯ˆà®¨à¯à®¤ à®®à¯à®©à¯à®©à¯à®°à®¿à®®à¯ˆ à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆà®•à®³à¯",
                pushNotifications: "à®ªà¯à®·à¯ à®…à®±à®¿à®µà®¿à®ªà¯à®ªà¯à®•à®³à¯",
                emailNotifications: "à®®à®¿à®©à¯à®©à®žà¯à®šà®²à¯ à®…à®±à®¿à®µà®¿à®ªà¯à®ªà¯à®•à®³à¯",
                notificationSchedule: "à®…à®±à®¿à®µà®¿à®ªà¯à®ªà¯ à®…à®Ÿà¯à®Ÿà®µà®£à¯ˆ",
                quietHours: "à®®à¯à®•à¯à®•à®¿à®¯à®®à®±à¯à®± à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆà®•à®³à¯à®•à¯à®•à¯ à®…à®®à¯ˆà®¤à®¿à®¯à®¾à®© à®¨à¯‡à®°à®™à¯à®•à®³à¯ˆ à®…à®®à¯ˆà®•à¯à®•à®µà¯à®®à¯",
                saveSettings: "à®…à®®à¯ˆà®ªà¯à®ªà¯à®•à®³à¯ˆ à®šà¯‡à®®à®¿à®•à¯à®•à®µà¯à®®à¯",
                testNotification: "à®…à®±à®¿à®µà®¿à®ªà¯à®ªà¯ à®šà¯‹à®¤à®©à¯ˆ",
                close: "à®®à¯‚à®Ÿà¯"
            },
            te: {
                welcome: "à°“à°®à±à°¨à°¿à°ªà±à°°à±‹à°Ÿà±†à°•à±à°Ÿà± à°¡à°¾à°·à±â€Œà°¬à±‹à°°à±à°¡à±â€Œà°•à± à°¸à±à°µà°¾à°—à°¤à°‚",
                welcomeDesc: "à°®à±€ à°¡à°¿à°œà°¿à°Ÿà°²à± à°†à°¸à±à°¤à±à°²à± à°šà±à°°à±à°•à±à°—à°¾ à°°à°•à±à°·à°¿à°‚à°šà°¬à°¡à±à°¤à±à°¨à±à°¨à°¾à°¯à°¿. à°…à°¨à±à°¨à°¿ à°ªà±à°²à°¾à°Ÿà±â€Œà°«à°¾à°°à°®à±â€Œà°²à°²à±‹ à°°à°¿à°¯à°²à± à°Ÿà±ˆà°®à± à°®à°¾à°¨à°¿à°Ÿà°°à°¿à°‚à°—à± à°ªà±à°°à°¾à°°à°‚à°­à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿.",
                activeProtection: "à°¯à°¾à°•à±à°Ÿà°¿à°µà± à°ªà±à°°à±Šà°Ÿà±†à°•à±à°·à°¨à±",
                threatsBlocked: "à°¬à±†à°¦à°¿à°°à°¿à°‚à°ªà±à°²à± à°¬à±à°²à°¾à°•à± à°šà±‡à°¯à°¬à°¡à±à°¡à°¾à°¯à°¿",
                suspiciousActivities: "à°…à°¨à±à°®à°¾à°¨à°¾à°¸à±à°ªà°¦ à°•à°¾à°°à±à°¯à°•à°²à°¾à°ªà°¾à°²à±",
                responseTime: "à°ªà±à°°à°¤à°¿à°¸à±à°ªà°‚à°¦à°¨ à°¸à°®à°¯à°‚",
                realtimeMonitoring: "à°°à°¿à°¯à°²à± à°Ÿà±ˆà°®à± à°®à°¾à°¨à°¿à°Ÿà°°à°¿à°‚à°—à± à°ªà±à°°à°¾à°°à°‚à°­à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿",
                last24Hours: "à°—à°¤ 24 à°—à°‚à°Ÿà°²à±",
                requiresAttention: "à°¦à°¯à°šà±‡à°¸à°¿ à°—à°®à°¨à°¿à°‚à°šà°‚à°¡à°¿",
                avgThreatResponse: "à°¸à°—à°Ÿà± à°¬à±†à°¦à°¿à°°à°¿à°‚à°ªà± à°ªà±à°°à°¤à°¿à°¸à±à°ªà°‚à°¦à°¨",
                highPriorityAlerts: "à°¹à±ˆ à°ªà±à°°à°¯à±‹à°°à°¿à°Ÿà±€ à°…à°²à°°à±à°Ÿà±à°¸à±",
                mediumPriorityAlerts: "à°®à±€à°¡à°¿à°¯à°‚ à°ªà±à°°à°¯à±‹à°°à°¿à°Ÿà±€ à°…à°²à°°à±à°Ÿà±à°¸à±",
                lowPriorityAlerts: "à°²à±‹ à°ªà±à°°à°¯à±‹à°°à°¿à°Ÿà±€ à°…à°²à°°à±à°Ÿà±à°¸à±",
                pushNotifications: "à°ªà±à°·à± à°¨à±‹à°Ÿà°¿à°«à°¿à°•à±‡à°·à°¨à±à°¸à±",
                emailNotifications: "à°‡à°®à±†à°¯à°¿à°²à± à°¨à±‹à°Ÿà°¿à°«à°¿à°•à±‡à°·à°¨à±à°¸à±",
                notificationSchedule: "à°¨à±‹à°Ÿà°¿à°«à°¿à°•à±‡à°·à°¨à± à°·à±†à°¡à±à°¯à±‚à°²à±",
                quietHours: "à°¨à°¾à°¨à±-à°•à±à°°à°¿à°Ÿà°¿à°•à°²à± à°…à°²à°°à±à°Ÿà±â€Œà°² à°•à±‹à°¸à°‚ à°•à±à°µà°¯à°Ÿà± à°…à°µà°°à±à°¸à± à°¸à±†à°Ÿà± à°šà±‡à°¯à°‚à°¡à°¿",
                saveSettings: "à°¸à±†à°Ÿà±à°Ÿà°¿à°‚à°—à±â€Œà°²à°¨à± à°¸à±‡à°µà± à°šà±‡à°¯à°‚à°¡à°¿",
                testNotification: "à°¨à±‹à°Ÿà°¿à°«à°¿à°•à±‡à°·à°¨à± à°Ÿà±†à°¸à±à°Ÿà±",
                close: "à°®à±‚à°¸à°¿à°µà±‡à°¯à°¿"
            },
            ml: {
                welcome: "à´“à´‚à´¨à´¿à´ªàµà´°àµŠà´Ÿàµà´Ÿàµ†à´•àµà´±àµà´±àµ à´¡à´¾à´·àµà´¬àµ‹àµ¼à´¡à´¿à´²àµ‡à´•àµà´•àµ à´¸àµà´µà´¾à´—à´¤à´‚",
                welcomeDesc: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´¡à´¿à´œà´¿à´±àµà´±àµ½ à´†à´¸àµà´¤à´¿à´•àµ¾ à´¸à´œàµ€à´µà´®à´¾à´¯à´¿ à´¸à´‚à´°à´•àµà´·à´¿à´•àµà´•à´ªàµà´ªàµ†à´Ÿàµà´¨àµà´¨àµ. à´Žà´²àµà´²à´¾ à´ªàµà´²à´¾à´±àµà´±àµà´«àµ‹à´®àµà´•à´³à´¿à´²àµà´‚ à´±à´¿à´¯àµ½ à´Ÿàµˆà´‚ à´®àµ‹à´£à´¿à´±àµà´±à´±à´¿à´‚à´—àµ à´ªàµà´°à´µàµ¼à´¤àµà´¤à´¨à´•àµà´·à´®à´®à´¾à´•àµà´•à´¿à´¯à´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ.",
                activeProtection: "à´¸à´œàµ€à´µ à´¸à´‚à´°à´•àµà´·à´£à´‚",
                threatsBlocked: "à´­àµ€à´·à´£à´¿à´•àµ¾ à´¤à´Ÿà´žàµà´žàµ",
                suspiciousActivities: "à´¸à´‚à´¶à´¯à´¾à´¸àµà´ªà´¦ à´ªàµà´°à´µàµ¼à´¤àµà´¤à´¨à´™àµà´™àµ¾",
                responseTime: "à´ªàµà´°à´¤à´¿à´•à´°à´£ à´¸à´®à´¯à´‚",
                realtimeMonitoring: "à´±à´¿à´¯àµ½ à´Ÿàµˆà´‚ à´®àµ‹à´£à´¿à´±àµà´±à´±à´¿à´‚à´—àµ à´ªàµà´°à´µàµ¼à´¤àµà´¤à´¨à´•àµà´·à´®à´®à´¾à´•àµà´•à´¿",
                last24Hours: "à´•à´´à´¿à´žàµà´ž 24 à´®à´£à´¿à´•àµà´•àµ‚àµ¼",
                requiresAttention: "à´¶àµà´°à´¦àµà´§ à´†à´µà´¶àµà´¯à´®à´¾à´£àµ",
                avgThreatResponse: "à´¶à´°à´¾à´¶à´°à´¿ à´­àµ€à´·à´£à´¿ à´ªàµà´°à´¤à´¿à´•à´°à´£à´‚",
                highPriorityAlerts: "à´‰à´¯àµ¼à´¨àµà´¨ à´®àµàµ»à´—à´£à´¨ à´…à´²àµ‡àµ¼à´Ÿàµà´Ÿàµà´•àµ¾",
                mediumPriorityAlerts: "à´®àµ€à´¡à´¿à´¯à´‚ à´®àµàµ»à´—à´£à´¨ à´…à´²àµ‡àµ¼à´Ÿàµà´Ÿàµà´•àµ¾",
                lowPriorityAlerts: "à´•àµà´±à´žàµà´ž à´®àµàµ»à´—à´£à´¨ à´…à´²àµ‡àµ¼à´Ÿàµà´Ÿàµà´•àµ¾",
                pushNotifications: "à´ªàµà´·àµ à´…à´±à´¿à´¯à´¿à´ªàµà´ªàµà´•àµ¾",
                emailNotifications: "à´‡à´®àµ†à´¯à´¿àµ½ à´…à´±à´¿à´¯à´¿à´ªàµà´ªàµà´•àµ¾",
                notificationSchedule: "à´…à´±à´¿à´¯à´¿à´ªàµà´ªàµ à´·àµ†à´¡àµà´¯àµ‚àµ¾",
                quietHours: "à´¨àµ‹àµº-à´•àµà´°à´¿à´Ÿàµà´Ÿà´¿à´•àµà´•àµ½ à´…à´²àµ‡àµ¼à´Ÿàµà´Ÿàµà´•àµ¾à´•àµà´•à´¾à´¯à´¿ à´¶à´¾à´¨àµà´¤à´®à´¾à´¯ à´®à´£à´¿à´•àµà´•àµ‚à´±àµà´•àµ¾ à´¸à´œàµà´œà´®à´¾à´•àµà´•àµà´•",
                saveSettings: "à´¸àµ†à´±àµà´±à´¿à´‚à´—àµà´•àµ¾ à´¸àµ‡à´µàµ à´šàµ†à´¯àµà´¯àµà´•",
                testNotification: "à´…à´±à´¿à´¯à´¿à´ªàµà´ªàµ à´ªà´°à´¿à´¶àµ‹à´§à´¿à´•àµà´•àµà´•",
                close: "à´…à´Ÿà´¯àµà´•àµà´•àµà´•"
            }
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize particles background
            initParticles();
            
            // Initialize charts
            initCharts();
            
            // Generate sample data
            generateSampleData();
            
            // Load threat logs
            loadThreatLogs();
            
            // Load activity feed
            loadActivityFeed();
            
            // Load global threat map
            loadGlobalThreatMap();
            
            // Load threat timeline
            loadThreatTimeline();
            
            // Load heatmap week
            loadHeatmapWeek();
            
            // Update last updated time
            updateLastUpdated();
            
            // Set up event listeners
            setupEventListeners();
            
            // Start auto updates
            startAutoUpdates();
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('Welcome to OmniProtect!', 'Your security dashboard is now active. Real-time protection is enabled.', 'low');
            }, 1000);
            // Start auto activity updates
startActivityUpdates();
        });

        // Initialize particles background
        function initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: { value: 80, density: { enable: true, value_area: 800 } },
                        color: { value: "#1a73e8" },
                        shape: { type: "circle" },
                        opacity: { value: 0.5, random: true },
                        size: { value: 3, random: true },
                        line_linked: {
                            enable: true,
                            distance: 150,
                            color: "#1a73e8",
                            opacity: 0.4,
                            width: 1
                        },
                        move: {
                            enable: true,
                            speed: 2,
                            direction: "none",
                            random: true,
                            straight: false,
                            out_mode: "out",
                            bounce: false
                        }
                    },
                    interactivity: {
                        detect_on: "canvas",
                        events: {
                            onhover: { enable: true, mode: "repulse" },
                            onclick: { enable: true, mode: "push" }
                        }
                    }
                });
            }
        }

        // Initialize all charts
        function initCharts() {
            // Threat Type Chart (Doughnut)
            const threatTypeCtx = document.getElementById('threatTypeChart').getContext('2d');
            charts.threatType = new Chart(threatTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Phishing', 'Malware', 'Spam', 'Suspicious', 'Ransomware', 'Data Breach', 'Botnet', 'Zero Day'],
                    datasets: [{
                        data: Object.values(threatData.types),
                        backgroundColor: [
                            'rgba(234, 67, 53, 0.8)',
                            'rgba(249, 171, 0, 0.8)',
                            'rgba(156, 39, 176, 0.8)',
                            'rgba(0, 188, 212, 0.8)',
                            'rgba(139, 0, 0, 0.8)',
                            'rgba(76, 175, 80, 0.8)',
                            'rgba(33, 150, 243, 0.8)',
                            'rgba(255, 87, 34, 0.8)'
                        ],
                        borderColor: [
                            'rgba(234, 67, 53, 1)',
                            'rgba(249, 171, 0, 1)',
                            'rgba(156, 39, 176, 1)',
                            'rgba(0, 188, 212, 1)',
                            'rgba(139, 0, 0, 1)',
                            'rgba(76, 175, 80, 1)',
                            'rgba(33, 150, 243, 1)',
                            'rgba(255, 87, 34, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text'),
                                font: { size: 10 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) label += ': ';
                                    label += context.raw.toLocaleString();
                                    return label;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });

            // Threat Trend Chart (Line)
            const threatTrendCtx = document.getElementById('threatTrendChart').getContext('2d');
            const labels = Array.from({length: 24}, (_, i) => `${i}:00`);
            const data = Array.from({length: 24}, () => Math.floor(Math.random() * 100) + 50);
            
            charts.threatTrend = new Chart(threatTrendCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Threats Detected',
                        data: data,
                        borderColor: 'rgba(234, 67, 53, 1)',
                        backgroundColor: 'rgba(234, 67, 53, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(234, 67, 53, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text') }
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text') }
                        }
                    }
                }
            });

            // Severity Distribution Chart
            const severityCtx = document.getElementById('severityChart').getContext('2d');
            charts.severity = new Chart(severityCtx, {
                type: 'polarArea',
                data: {
                    labels: ['High', 'Medium', 'Low'],
                    datasets: [{
                        data: Object.values(threatData.severity),
                        backgroundColor: [
                            'rgba(234, 67, 53, 0.8)',
                            'rgba(249, 171, 0, 0.8)',
                            'rgba(52, 168, 83, 0.8)'
                        ],
                        borderColor: [
                            'rgba(234, 67, 53, 1)',
                            'rgba(249, 171, 0, 1)',
                            'rgba(52, 168, 83, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text'),
                                font: { size: 10 }
                            }
                        }
                    },
                    scales: {
                        r: {
                            ticks: { display: false }
                        }
                    }
                }
            });

            // Platform Distribution Chart
            const platformCtx = document.getElementById('platformChart').getContext('2d');
            charts.platform = new Chart(platformCtx, {
                type: 'bar',
                data: {
                    labels: ['WhatsApp', 'Web', 'Email', 'SMS'],
                    datasets: [{
                        label: 'Threats by Platform',
                        data: Object.values(threatData.platforms),
                        backgroundColor: [
                            'rgba(37, 211, 102, 0.8)',
                            'rgba(66, 133, 244, 0.8)',
                            'rgba(234, 67, 53, 0.8)',
                            'rgba(251, 188, 5, 0.8)'
                        ],
                        borderColor: [
                            'rgba(37, 211, 102, 1)',
                            'rgba(66, 133, 244, 1)',
                            'rgba(234, 67, 53, 1)',
                            'rgba(251, 188, 5, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text') }
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text') }
                        }
                    }
                }
            });
        }

        // Generate sample data
        function generateSampleData() {
            // Generate timeline data
            const now = new Date();
            for (let i = 0; i < 24; i++) {
                const time = new Date(now);
                time.setHours(time.getHours() - i);
                threatData.timeline.push({
                    time: time.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    threats: Math.floor(Math.random() * 50) + 10,
                    level: ['low', 'medium', 'high'][Math.floor(Math.random() * 3)]
                });
            }
            
            // Generate heatmap week data (days only, not hours)
            for (let day = 0; day < 7; day++) {
                const threatCount = Math.floor(Math.random() * 100);
                let level = 'low';
                if (threatCount > 80) level = 'critical';
                else if (threatCount > 60) level = 'high';
                else if (threatCount > 40) level = 'medium';
                
                threatData.heatmapWeek.push({
                    day: day,
                    threats: threatCount,
                    level: level
                });
            }
        }

        // Load threat logs
        function loadThreatLogs() {
            const sampleLogs = [
                {
                    id: 1,
                    type: 'Phishing Attack',
                    content: 'Detected phishing attempt from suspicious URL: https://fake-bank-login.com',
                    time: 'Just now',
                    level: 'high',
                    platform: 'WhatsApp',
                    tags: ['phishing', 'financial', 'urgent'],
                    details: {
                        source: 'International Server',
                        destination: 'User Device',
                        action: 'Blocked automatically',
                        confidence: '98%',
                        ip: '192.168.1.100',
                        location: 'Unknown'
                    }
                },
                {
                    id: 2,
                    type: 'Malware Detected',
                    content: 'Malicious file attachment blocked: invoice.exe',
                    time: '2 minutes ago',
                    level: 'high',
                    platform: 'Web',
                    tags: ['malware', 'attachment', 'executable'],
                    details: {
                        source: 'External Email',
                        destination: 'User Downloads',
                        action: 'Quarantined',
                        confidence: '95%',
                        hash: 'a1b2c3d4e5f6',
                        size: '2.4 MB'
                    }
                },
                {
                    id: 3,
                    type: 'Suspicious Activity',
                    content: 'Multiple failed login attempts detected',
                    time: '15 minutes ago',
                    level: 'medium',
                    platform: 'Web',
                    tags: ['brute-force', 'login', 'multiple'],
                    details: {
                        source: 'Multiple IPs',
                        destination: 'User Account',
                        action: 'IP temporarily blocked',
                        confidence: '85%',
                        attempts: '12',
                        timeframe: '5 minutes'
                    }
                },
                {
                    id: 4,
                    type: 'Data Leak',
                    content: 'Sensitive data transmission detected to unauthorized server',
                    time: '1 hour ago',
                    level: 'high',
                    platform: 'All',
                    tags: ['data-leak', 'sensitive', 'exfiltration'],
                    details: {
                        source: 'User Device',
                        destination: 'External Server',
                        action: 'Connection terminated',
                        confidence: '92%',
                        data: 'Credentials',
                        protocol: 'HTTPS'
                    }
                },
                {
                    id: 5,
                    type: 'Spam Message',
                    content: 'Blocked spam message with suspicious links',
                    time: '2 hours ago',
                    level: 'low',
                    platform: 'WhatsApp',
                    tags: ['spam', 'marketing', 'links'],
                    details: {
                        source: 'Unknown Number',
                        destination: 'User Chat',
                        action: 'Filtered automatically',
                        confidence: '75%',
                        sender: '+1234567890',
                        country: 'Unknown'
                    }
                }
            ];

            threatLogs = sampleLogs;
            renderThreatLogs();
        }

        // Render threat logs
        function renderThreatLogs() {
            const threatLogsContainer = document.getElementById('threatLogs');
            if (!threatLogsContainer) return;
            
            threatLogsContainer.innerHTML = '';
            
            threatLogs.forEach(log => {
                const logElement = document.createElement('div');
                logElement.className = `log-item ${log.level}`;
                logElement.innerHTML = `
                    <div class="log-header">
                        <div class="log-type">
                            <i class="fas fa-${getLogIcon(log.level)}"></i>
                            ${log.type}
                        </div>
                        <div class="log-time">
                            <i class="far fa-clock"></i>
                            ${log.time}
                        </div>
                    </div>
                    <div class="log-content">
                        ${log.content}
                    </div>
                    <div class="log-tags">
                        ${log.tags.map(tag => `<span class="log-tag">${tag}</span>`).join('')}
                        <span class="log-tag"><i class="fab fa-${log.platform.toLowerCase()}"></i> ${log.platform}</span>
                    </div>
                    <div class="log-details" id="logDetails${log.id}">
                        ${Object.entries(log.details).map(([key, value]) => `
                            <div class="detail-item">
                                <span class="detail-label">${formatKey(key)}</span>
                                <span class="detail-value">${value}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="log-footer">
                        <div class="log-actions">
                            <button class="btn-icon" onclick="handleLogAction(${log.id}, 'block')">
                                <i class="fas fa-ban"></i>
                            </button>
                            <button class="btn-icon" onclick="handleLogAction(${log.id}, 'whitelist')">
                                <i class="fas fa-check-circle"></i>
                            </button>
                            <button class="btn-icon" onclick="toggleLogDetails(${log.id})">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </div>
                        <span class="trend ${log.level === 'high' ? 'down' : 'up'}">
                            <i class="fas fa-${log.level === 'high' ? 'arrow-down' : 'arrow-up'}"></i>
                            ${log.level.toUpperCase()}
                        </span>
                    </div>
                `;
                threatLogsContainer.appendChild(logElement);
            });
        }

        // Load activity feed
        function loadActivityFeed() {
            const activityFeed = document.getElementById('activityFeed');
            if (!activityFeed) return;
            
            const activities = [
                {
                    text: 'AI model updated with latest threat signatures',
                    time: 'Just now',
                    icon: 'fas fa-brain'
                },
                {
                    text: 'System scan completed - No threats found',
                    time: '5 minutes ago',
                    icon: 'fas fa-search'
                },
                {
                    text: 'Real-time protection database synchronized',
                    time: '15 minutes ago',
                    icon: 'fas fa-sync'
                },
                {
                    text: 'New threat pattern detected and added to database',
                    time: '1 hour ago',
                    icon: 'fas fa-shield-alt'
                },
                {
                    text: 'Daily security report generated',
                    time: '2 hours ago',
                    icon: 'fas fa-file-alt'
                }
            ];

            activityFeed.innerHTML = '';
            activities.forEach(activity => {
                const activityElement = document.createElement('div');
                activityElement.className = 'activity-item';
                activityElement.innerHTML = `
                    <div class="activity-icon">
                        <i class="${activity.icon}"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-text">${activity.text}</div>
                        <div class="activity-time"><i class="far fa-clock"></i> ${activity.time}</div>
                    </div>
                `;
                activityFeed.appendChild(activityElement);
            });
        }
        // Add these variables at the top with your other global variables
let isActivityPaused = false;
let activityInterval = null;
let activities = [];

// Updated loadActivityFeed function
function loadActivityFeed() {
    const activityFeed = document.getElementById('activityFeed');
    if (!activityFeed) return;
    
    activities = [
        {
            text: 'AI model updated with latest threat signatures',
            time: 'Just now',
            icon: 'fas fa-brain',
            type: 'ai-update'
        },
        {
            text: 'System scan completed - No threats found',
            time: '5 minutes ago',
            icon: 'fas fa-search',
            type: 'scan'
        },
        {
            text: 'Real-time protection database synchronized',
            time: '15 minutes ago',
            icon: 'fas fa-sync',
            type: 'sync'
        },
        {
            text: 'New threat pattern detected and added to database',
            time: '1 hour ago',
            icon: 'fas fa-shield-alt',
            type: 'threat'
        },
        {
            text: 'Daily security report generated',
            time: '2 hours ago',
            icon: 'fas fa-file-alt',
            type: 'report'
        }
    ];

    renderActivityFeed();
}

// Function to render activity feed
function renderActivityFeed() {
    const activityFeed = document.getElementById('activityFeed');
    if (!activityFeed) return;
    
    activityFeed.innerHTML = '';
    
    activities.forEach(activity => {
        const activityElement = document.createElement('div');
        activityElement.className = 'activity-item';
        activityElement.innerHTML = `
            <div class="activity-icon ${activity.type}">
                <i class="${activity.icon}"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">${activity.text}</div>
                <div class="activity-time"><i class="far fa-clock"></i> ${activity.time}</div>
            </div>
        `;
        activityFeed.appendChild(activityElement);
    });
    
    // Update activity count
    const activityCount = document.getElementById('activityCount');
    if (activityCount) {
        activityCount.textContent = `${activities.length} activities loaded`;
    }
}

// Function to add new activity
function addNewActivity(type = 'info') {
    if (isActivityPaused) return;
    
    const activityTypes = {
        'ai-update': {
            icon: 'fas fa-brain',
            text: 'AI models optimized for new threat patterns',
            type: 'ai-update'
        },
        'scan': {
            icon: 'fas fa-search',
            text: 'Quick security scan completed - All systems secure',
            type: 'scan'
        },
        'sync': {
            icon: 'fas fa-sync',
            text: 'Threat intelligence database synchronized',
            type: 'sync'
        },
        'threat': {
            icon: 'fas fa-shield-alt',
            text: 'Potential threat detected and neutralized',
            type: 'threat'
        },
        'report': {
            icon: 'fas fa-chart-bar',
            text: 'System performance report updated',
            type: 'report'
        }
    };
    
    const selectedType = activityTypes[type] || activityTypes['info'];
    const now = new Date();
    const timeText = 'Just now';
    
    const newActivity = {
        text: selectedType.text,
        time: timeText,
        icon: selectedType.icon,
        type: selectedType.type
    };
    
    activities.unshift(newActivity);
    
    // Keep only last 10 activities
    if (activities.length > 10) {
        activities.pop();
    }
    
    renderActivityFeed();
    updateActivityStatus();
}

// Toggle pause/resume activity updates
function toggleActivityPause() {
    isActivityPaused = !isActivityPaused;
    const pauseBtn = document.getElementById('pauseActivity');
    const activityStatus = document.getElementById('activityStatus');
    
    if (pauseBtn) {
        const icon = pauseBtn.querySelector('i');
        if (isActivityPaused) {
            icon.classList.remove('fa-pause');
            icon.classList.add('fa-play');
            if (activityStatus) activityStatus.textContent = 'Updates paused';
            showNotification('Activity Updates Paused', 'Timeline updates have been paused.', 'low');
        } else {
            icon.classList.remove('fa-play');
            icon.classList.add('fa-pause');
            if (activityStatus) activityStatus.textContent = 'Live updates active';
            showNotification('Activity Updates Resumed', 'Timeline updates are now active.', 'low');
        }
    }
}

// Clear all activities
function clearActivities() {
    if (confirm('Are you sure you want to clear all activity logs? This action cannot be undone.')) {
        activities = [];
        renderActivityFeed();
        showNotification('Activities Cleared', 'All activity logs have been cleared.', 'low');
    }
}

// Refresh activities
function refreshActivities() {
    const refreshBtn = document.getElementById('refreshActivity');
    if (refreshBtn) {
        const icon = refreshBtn.querySelector('i');
        icon.classList.add('fa-spin-fast');
        
        setTimeout(() => {
            // Add a new activity to show refresh
            const types = ['ai-update', 'scan', 'sync', 'threat', 'report'];
            const randomType = types[Math.floor(Math.random() * types.length)];
            addNewActivity(randomType);
            
            icon.classList.remove('fa-spin-fast');
            showNotification('Timeline Refreshed', 'Activity timeline has been updated.', 'low');
        }, 1000);
    }
}

// Update activity status
function updateActivityStatus() {
    const activityStatus = document.getElementById('activityStatus');
    if (activityStatus) {
        activityStatus.textContent = isActivityPaused ? 'Updates paused' : 'Live updates active';
    }
}

// Start auto activity updates
function startActivityUpdates() {
    // Add new activity every 30-60 seconds
    activityInterval = setInterval(() => {
        if (!isActivityPaused) {
            const types = ['ai-update', 'scan', 'sync', 'threat', 'report'];
            const randomType = types[Math.floor(Math.random() * types.length)];
            addNewActivity(randomType);
        }
    }, 30000 + Math.random() * 30000); // 30-60 seconds
}

        // Load global threat map with hover details
        function loadGlobalThreatMap() {
            const globalThreatMap = document.getElementById('globalThreatMap');
            if (!globalThreatMap) return;
            
            globalThreatMap.innerHTML = '';
            countryData.forEach(country => {
                const countryElement = document.createElement('div');
                countryElement.className = 'global-map-item';
                countryElement.innerHTML = `
                    <div class="global-map-flag">${country.flag}</div>
                    <div class="global-map-count">${country.threats}</div>
                    <div class="global-map-country">${country.name}</div>
                    <div class="global-map-details">
                        <h4><i class="fas fa-info-circle"></i> ${country.name} Threat Details</h4>
                        <p><strong>Total Threats:</strong> ${country.threats}</p>
                        <p><strong>Trend:</strong> ${country.trend.toUpperCase()}</p>
                        <p><strong>Primary Threats:</strong> ${country.primaryThreats}</p>
                        <ul>
                            ${country.topThreats.map(threat => `
                                <li>${threat.name}: ${threat.count} incidents</li>
                            `).join('')}
                        </ul>
                        <p><strong>Details:</strong> ${country.details}</p>
                        <p><small>Last updated: ${country.lastUpdate}</small></p>
                    </div>
                `;
                globalThreatMap.appendChild(countryElement);
            });
        }

        // Load threat timeline with hover popups
        function loadThreatTimeline() {
            const threatTimeline = document.getElementById('threatTimeline');
            if (!threatTimeline) return;
            
            threatTimeline.innerHTML = '';
            
            // Generate hourly data for last 24 hours
            const now = new Date();
            for (let i = 23; i >= 0; i--) {
                const hour = new Date(now);
                hour.setHours(hour.getHours() - i);
                const hourStr = hour.getHours().toString().padStart(2, '0');
                const threats = Math.floor(Math.random() * 50) + 10;
                const level = threats > 40 ? 'high' : threats > 20 ? 'medium' : 'low';
                
                const timelineItem = document.createElement('div');
                timelineItem.className = `timeline-item ${level}`;
                timelineItem.innerHTML = `
                    <div class="timeline-hour">${hourStr}:00</div>
                    <div class="timeline-count">${threats}</div>
                    <div class="timeline-popup">
                        <h5>${hourStr}:00 - ${(parseInt(hourStr) + 1).toString().padStart(2, '0')}:00</h5>
                        <p><strong>Threats Detected:</strong> ${threats}</p>
                        <p><strong>Level:</strong> ${level.toUpperCase()}</p>
                        <p><strong>Primary Type:</strong> Phishing</p>
                        <p><strong>Platform:</strong> ${Math.random() > 0.5 ? 'Web' : 'WhatsApp'}</p>
                        <p><strong>Action Taken:</strong> ${level === 'high' ? 'Blocked Immediately' : 'Flagged for Review'}</p>
                    </div>
                `;
                threatTimeline.appendChild(timelineItem);
            }
        }

        // Load heatmap week with day names and threat statements
function loadHeatmapWeek() {
    const heatmapWeek = document.getElementById('heatmapWeek');
    if (!heatmapWeek) return;
    
    heatmapWeek.innerHTML = '';
    
    // Days of week with threat statements
    const days = [
        { 
            name: 'MON', 
            desc: 'Weekly Peak<br>High traffic volume',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'TUE', 
            desc: 'Phishing Surge<br>Email attacks spike',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'WED', 
            desc: 'Midweek Lull<br>Reduced activity',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'THU', 
            desc: 'Malware Spike<br>New variants detected',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'FRI', 
            desc: 'Weekend Prep<br>Ransomware attempts',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'SAT', 
            desc: 'Low Monitoring<br>Fewer IT staff',
            threats: Math.floor(Math.random() * 100)
        },
        { 
            name: 'SUN', 
            desc: 'Sunday Reset<br>System maintenance',
            threats: Math.floor(Math.random() * 100)
        }
    ];
    
    days.forEach(day => {
        let level = 'low';
        if (day.threats > 80) level = 'critical';
        else if (day.threats > 60) level = 'high';
        else if (day.threats > 40) level = 'medium';
        
        // Create day cell
        const dayCell = document.createElement('div');
        dayCell.className = `heatmap-week-cell ${level}`;
        dayCell.title = `${day.name}: ${day.threats} threats\n${day.desc.replace('<br>', ' - ')}`;
        dayCell.setAttribute('data-threats', day.threats);
        
        // Add day name and description
        const dayContent = document.createElement('div');
        dayContent.className = 'heatmap-day-content';
        dayContent.innerHTML = `
            <div class="day-name">${day.name}</div>
            <div class="threat-count">${day.threats}</div>
            <div class="day-desc">${day.desc}</div>
        `;
        dayCell.appendChild(dayContent);
        
        // Add click/hover functionality
        dayCell.addEventListener('click', () => {
            showNotification(`${day.name} - Threat Analysis`, 
                `Threats: ${day.threats}\nLevel: ${level.toUpperCase()}\n${day.desc.replace('<br>', ' - ')}`, 
                level === 'critical' || level === 'high' ? 'medium' : 'low');
        });
        
        heatmapWeek.appendChild(dayCell);
    });
}

        // Setup event listeners
        function setupEventListeners() {
            
            // Proceed to dashboard
            document.getElementById('proceedBtn').addEventListener('click', () => {
                // Add these inside your setupEventListeners function

// Activity controls
document.getElementById('pauseActivity').addEventListener('click', toggleActivityPause);
document.getElementById('clearActivity').addEventListener('click', clearActivities);
document.getElementById('refreshActivity').addEventListener('click', refreshActivities);
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                document.body.classList.add('dashboard-active');
                showNotification('Dashboard Loaded', 'Security dashboard is now active. Real-time monitoring enabled.', 'low');
                
            });

            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('change', toggleDarkMode);

            // Notification button
            document.getElementById('notificationBtn').addEventListener('click', () => {
                document.getElementById('notificationModal').classList.add('active');
            });

            // Close modal buttons
            document.getElementById('closeNotificationModal').addEventListener('click', closeModal);
            document.getElementById('closeModalBtn').addEventListener('click', closeModal);

            // Language selection
            document.querySelectorAll('.language-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.language-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    currentLanguage = this.getAttribute('data-lang');
                    updateLanguage();
                });
            });

            // Save notification settings
            document.getElementById('saveNotificationSettings').addEventListener('click', saveSettings);

            // Test notification
            document.getElementById('testNotification').addEventListener('click', () => {
                showNotification('Test Notification', 'This is a test notification from OmniProtect Security Dashboard.', 'medium');
            });

            // Refresh button
            document.getElementById('refreshBtn').addEventListener('click', refreshDashboard);

            // AI Scan button
            document.getElementById('aiScanBtn').addEventListener('click', performAIScan);

            // Clear logs button
            document.getElementById('clearLogsBtn').addEventListener('click', clearLogs);

            // Export button
            document.getElementById('exportBtn').addEventListener('click', toggleExportOptions);

            // Refresh all button
            document.getElementById('refreshAllBtn').addEventListener('click', refreshAllData);

            // AI Assistant button
            document.getElementById('aiAssistantBtn').addEventListener('click', toggleAIChat);

            // Close AI chat
            document.getElementById('closeChatBtn').addEventListener('click', () => {
                document.getElementById('aiChatModal').style.display = 'none';
            });

            // Send chat message
            document.getElementById('sendChatBtn').addEventListener('click', sendChatMessage);
            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendChatMessage();
            });

            // Analyze button
            document.getElementById('analyzeBtn').addEventListener('click', analyzeInput);
            // ADD THIS LINE RIGHT HERE:
    document.getElementById('clearTestBtn').addEventListener('click', clearTestInput);

            // Test buttons
            document.getElementById('testPhishing').addEventListener('click', () => testSample('phishing'));
            document.getElementById('testMalware').addEventListener('click', () => testSample('malware'));

            // Sample buttons
            document.querySelectorAll('.sample-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.getElementById('testInput').value = btn.getAttribute('data-text');
                    analyzeInput();
                });
            });

            // Filter buttons
            document.getElementById('applyFiltersBtn').addEventListener('click', applyFilters);
            document.getElementById('resetFiltersBtn').addEventListener('click', resetFilters);
            document.getElementById('saveFilterBtn').addEventListener('click', saveFilter);

            // Refresh analytics
            document.getElementById('refreshAnalytics').addEventListener('click', refreshAnalytics);

            // Time range selector
            document.getElementById('threatTimeRange').addEventListener('change', updateTimeRange);

            // Click outside to close modals
            window.addEventListener('click', (e) => {
                if (e.target === document.getElementById('notificationModal')) {
                    closeModal();
                }
                if (e.target === document.getElementById('exportBtn') || e.target.closest('#exportOptions')) {
                    return;
                }
                const exportOptions = document.getElementById('exportOptions');
                if (exportOptions && exportOptions.classList.contains('show')) {
                    exportOptions.classList.remove('show');
                }
            });
        }

        // Update language
        function updateLanguage() {
            const lang = translations[currentLanguage];
            if (!lang) return;
            
            // Update dashboard welcome
            const welcomeTitle = document.querySelector('.dashboard-welcome h2');
            const welcomeDesc = document.querySelector('.dashboard-welcome p');
            if (welcomeTitle) welcomeTitle.textContent = lang.welcome;
            if (welcomeDesc) welcomeDesc.textContent = lang.welcomeDesc;
            
            // Update status cards
            const statusCards = document.querySelectorAll('.status-card h3');
            if (statusCards[0]) statusCards[0].innerHTML = `<i class="fas fa-shield-check"></i> ${lang.activeProtection}`;
            if (statusCards[1]) statusCards[1].innerHTML = `<i class="fas fa-skull-crossbones"></i> ${lang.threatsBlocked}`;
            if (statusCards[2]) statusCards[2].innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${lang.suspiciousActivities}`;
            if (statusCards[3]) statusCards[3].innerHTML = `<i class="fas fa-bolt"></i> ${lang.responseTime}`;
            
            // Update status descriptions
            const descriptions = document.querySelectorAll('.status-card .description');
            if (descriptions[0]) descriptions[0].textContent = lang.realtimeMonitoring;
            if (descriptions[1]) descriptions[1].textContent = lang.last24Hours;
            if (descriptions[2]) descriptions[2].textContent = lang.requiresAttention;
            if (descriptions[3]) descriptions[3].textContent = lang.avgThreatResponse;
            
            // Update notification settings
            const settingTitles = document.querySelectorAll('.setting-item h3');
            if (settingTitles[0]) settingTitles[0].innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${lang.highPriorityAlerts}`;
            if (settingTitles[1]) settingTitles[1].innerHTML = `<i class="fas fa-exclamation-circle"></i> ${lang.mediumPriorityAlerts}`;
            if (settingTitles[2]) settingTitles[2].innerHTML = `<i class="fas fa-info-circle"></i> ${lang.lowPriorityAlerts}`;
            if (settingTitles[3]) settingTitles[3].innerHTML = `<i class="fas fa-mobile-alt"></i> ${lang.pushNotifications}`;
            if (settingTitles[4]) settingTitles[4].innerHTML = `<i class="fas fa-envelope"></i> ${lang.emailNotifications}`;
            
            const schedulerTitle = document.querySelector('.notification-scheduler h3');
            if (schedulerTitle) schedulerTitle.innerHTML = `<i class="fas fa-clock"></i> ${lang.notificationSchedule}`;
            
            const schedulerDesc = document.querySelector('.notification-scheduler p');
            if (schedulerDesc) schedulerDesc.textContent = lang.quietHours;
            
            // Update modal buttons
            const saveBtn = document.getElementById('saveNotificationSettings');
            const testBtn = document.getElementById('testNotification');
            const closeBtn = document.getElementById('closeModalBtn');
            
            if (saveBtn) saveBtn.innerHTML = `<i class="fas fa-save"></i> ${lang.saveSettings}`;
            if (testBtn) testBtn.innerHTML = `<i class="fas fa-bell"></i> ${lang.testNotification}`;
            if (closeBtn) closeBtn.innerHTML = `<i class="fas fa-times"></i> ${lang.close}`;
            
            showNotification('Language Updated', `Interface language changed to ${currentLanguage.toUpperCase()}`, 'low');
        }

        // Toggle dark mode
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            
            // Update charts for dark mode
            updateChartColors();
        }

        // Update chart colors for dark mode
        function updateChartColors() {
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text');
            
            Object.keys(charts).forEach(chartName => {
                if (charts[chartName]) {
                    const chart = charts[chartName];
                    
                    // Update legend labels
                    if (chart.options.plugins && chart.options.plugins.legend && chart.options.plugins.legend.labels) {
                        chart.options.plugins.legend.labels.color = textColor;
                    }
                    
                    // Update axis ticks
                    if (chart.options.scales) {
                        Object.keys(chart.options.scales).forEach(axis => {
                            if (chart.options.scales[axis].ticks) {
                                chart.options.scales[axis].ticks.color = textColor;
                            }
                        });
                    }
                    
                    chart.update();
                }
            });
        }

        // Close modal
        function closeModal() {
            document.getElementById('notificationModal').classList.remove('active');
        }

        // Save notification settings
        function saveSettings() {
            showNotification('Settings Saved', 'Notification preferences have been updated successfully.', 'low');
            closeModal();
        }

        // Show notification
        function showNotification(title, message, level = 'medium') {
            const container = document.getElementById('notificationContainer');
            if (!container) return;
            
            const notificationId = 'notification-' + Date.now();
            
            const notification = document.createElement('div');
            notification.className = `custom-notification ${level}`;
            notification.id = notificationId;
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close" onclick="removeNotification('${notificationId}')">&times;</button>
                <div class="notification-timer" style="animation-duration: 5s;"></div>
            `;
            
            container.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                removeNotification(notificationId);
            }, 5000);
            
            // Update badge if high priority
            if (level === 'high') {
                notificationCount++;
                const badge = document.getElementById('notificationBadge');
                if (badge) {
                    badge.textContent = notificationCount;
                    badge.style.display = 'inline-block';
                }
            }
        }

        // Remove notification
        function removeNotification(id) {
            const notification = document.getElementById(id);
            if (notification) {
                notification.classList.add('hide');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }
        }

        // Refresh dashboard
        function refreshDashboard() {
            const icon = document.getElementById('refreshBtn').querySelector('i');
            icon.classList.add('fa-spin-fast');
            
            showNotification('Refreshing', 'Updating dashboard data...', 'low');
            
            // Simulate API call
            setTimeout(() => {
                // Update counters with random data
                updateCounters();
                updateQuickStats();
                updateHealth();
                addNewLog();
                updateLastUpdated();
                
                icon.classList.remove('fa-spin-fast');
                showNotification('Refresh Complete', 'Dashboard data has been updated.', 'low');
            }, 1500);
        }

        // Update counters based on time range
        function updateCounters() {
            const timeRange = document.getElementById('threatTimeRange').value;
            let multiplier = 1;
            
            switch(timeRange) {
                case '1h': multiplier = 0.04; break;
                case '24h': multiplier = 1; break;
                case '7d': multiplier = 7; break;
                case '30d': multiplier = 30; break;
            }
            
            const threatsBlocked = document.getElementById('threatsBlocked');
            if (threatsBlocked) {
                threatsBlocked.textContent = Math.floor(3247 * multiplier).toLocaleString();
            }
            
            const suspiciousActivities = document.getElementById('suspiciousActivities');
            if (suspiciousActivities) {
                suspiciousActivities.textContent = Math.floor(18 * multiplier);
            }
            
            const avgResponseTime = document.getElementById('avgResponseTime');
            if (avgResponseTime) {
                avgResponseTime.textContent = (0.7 + Math.random() * 0.3).toFixed(1) + 's';
            }
        }

        // Update quick stats
        function updateQuickStats() {
            const protectionScore = document.getElementById('protectionScore');
            if (protectionScore) {
                protectionScore.textContent = Math.floor(90 + Math.random() * 8) + '%';
            }
            
            const responseSpeed = document.getElementById('responseSpeed');
            if (responseSpeed) {
                responseSpeed.textContent = (0.5 + Math.random() * 0.5).toFixed(1) + 's';
            }
            
            const threatsToday = document.getElementById('threatsToday');
            if (threatsToday) {
                threatsToday.textContent = Math.floor(Math.random() * 10) + 15;
            }
        }

        // Update health
        function updateHealth() {
            const health = Math.floor(90 + Math.random() * 8);
            const healthFill = document.getElementById('healthFill');
            const healthValue = document.getElementById('healthValue');
            
            if (healthFill) healthFill.style.width = health + '%';
            if (healthValue) healthValue.textContent = health + '%';
        }

        // Add new log
        function addNewLog() {
            const newLog = {
                id: threatLogs.length + 1,
                type: ['Suspicious Login', 'Malware Scan', 'Data Transfer'][Math.floor(Math.random() * 3)],
                content: 'System refresh completed successfully',
                time: 'Just now',
                level: 'low',
                platform: 'System',
                tags: ['refresh', 'system', 'update'],
                details: {
                    action: 'Dashboard refresh',
                    result: 'Successful',
                    timestamp: new Date().toLocaleTimeString()
                }
            };
            
            threatLogs.unshift(newLog);
            if (threatLogs.length > 10) threatLogs.pop();
            renderThreatLogs();
        }

        // Perform AI scan
        function performAIScan() {
            const aiScanBtn = document.getElementById('aiScanBtn');
            if (!aiScanBtn) return;
            
            const icon = aiScanBtn.querySelector('i');
            icon.classList.remove('fa-robot');
            icon.classList.add('fa-spinner', 'fa-spin');
            
            showNotification('AI Scan Initiated', 'Deep security scan in progress...', 'medium');
            
            // Simulate AI scan
            setTimeout(() => {
                const threatsFound = Math.floor(Math.random() * 5);
                const newLog = {
                    id: threatLogs.length + 1,
                    type: 'AI Security Scan',
                    content: `AI scan completed. Found ${threatsFound} potential threat${threatsFound !== 1 ? 's' : ''}.`,
                    time: 'Just now',
                    level: threatsFound > 0 ? 'medium' : 'low',
                    platform: 'AI System',
                    tags: ['ai-scan', 'deep-scan', 'analysis'],
                    details: {
                        scanType: 'Deep AI Analysis',
                        duration: '45 seconds',
                        filesScanned: '15,247',
                        threatsFound: threatsFound,
                        confidence: '96.7%'
                    }
                };
                
                threatLogs.unshift(newLog);
                if (threatLogs.length > 10) threatLogs.pop();
                renderThreatLogs();
                
                icon.classList.remove('fa-spinner', 'fa-spin');
                icon.classList.add('fa-robot');
                
                showNotification('AI Scan Complete', 
                    `Scan completed. ${threatsFound} potential threat${threatsFound !== 1 ? 's' : ''} identified.`, 
                    threatsFound > 0 ? 'medium' : 'low');
            }, 3000);
        }

        // Clear logs
        function clearLogs() {
            if (confirm('Are you sure you want to clear all threat logs? This action cannot be undone.')) {
                threatLogs = [];
                renderThreatLogs();
                showNotification('Logs Cleared', 'All threat logs have been cleared.', 'low');
            }
        }

        // Toggle export options
        function toggleExportOptions() {
            const exportOptions = document.getElementById('exportOptions');
            if (exportOptions) {
                exportOptions.classList.toggle('show');
            }
        }

        // Export data
        function exportData(format) {
            showNotification('Export Started', `Preparing ${format.toUpperCase()} export...`, 'low');
            
            // Simulate export process
            setTimeout(() => {
                let message = '';
                switch(format) {
                    case 'pdf':
                        message = 'PDF report generated successfully.';
                        generatePDFReport();
                        break;
                    case 'excel':
                        message = 'Excel spreadsheet exported successfully.';
                        break;
                    case 'csv':
                        message = 'CSV data exported successfully.';
                        break;
                    case 'json':
                        message = 'JSON data exported successfully.';
                        break;
                    case 'report':
                        message = 'Full security report generated.';
                        generateFullReport();
                        break;
                }
                
                showNotification('Export Complete', message, 'low');
                const exportOptions = document.getElementById('exportOptions');
                if (exportOptions) {
                    exportOptions.classList.remove('show');
                }
            }, 2000);
        }

        // Generate full report
        function generateFullReport() {
            showNotification('Report Generation', 'Generating comprehensive security report...', 'medium');
            
            setTimeout(() => {
                // Create enhanced report content based on the PDF file
                const reportContent = `
                    <div class="report-header">
                        <h1>OmniProtect Comprehensive Security Report</h1>
                        <p>Report Period: Last 24 Hours | Generated: ${new Date().toLocaleString()}</p>
                    </div>
                    
                    <div class="report-section">
                        <h2>Executive Summary</h2>
                        <p>OmniProtect has successfully protected your digital assets against sophisticated cyber threats. The AI-powered security system maintained optimal performance with high accuracy and fast response times.</p>
                        
                        <div class="report-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Key Metric</th>
                                        <th>Value</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Threats Blocked</td>
                                        <td>18</td>
                                        <td>Optimal</td>
                                    </tr>
                                    <tr>
                                        <td>Suspicious Activities</td>
                                        <td>7</td>
                                        <td>Monitoring</td>
                                    </tr>
                                    <tr>
                                        <td>Safe Requests</td>
                                        <td>324</td>
                                        <td>Normal</td>
                                    </tr>
                                    <tr>
                                        <td>AI Accuracy</td>
                                        <td>96.7%</td>
                                        <td>Excellent</td>
                                    </tr>
                                    <tr>
                                        <td>System Uptime</td>
                                        <td>99.9%</td>
                                        <td>Optimal</td>
                                    </tr>
                                    <tr>
                                        <td>Response Time</td>
                                        <td>0.8s</td>
                                        <td>Fast</td>
                                    </tr>
                                    <tr>
                                        <td>System Health</td>
                                        <td>94%</td>
                                        <td>Healthy</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h2>Detailed Threat Analysis</h2>
                        <div class="report-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Platform</th>
                                        <th>Severity</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Web</td>
                                        <td>LOW</td>
                                        <td>Social engineering attempt detected and blocked</td>
                                    </tr>
                                    <tr>
                                        <td>WhatsApp</td>
                                        <td>HIGH</td>
                                        <td>Advanced phishing attempt with malicious tracking</td>
                                    </tr>
                                    <tr>
                                        <td>Web</td>
                                        <td>MEDIUM</td>
                                        <td>Suspicious login page mimicking bank portal</td>
                                    </tr>
                                    <tr>
                                        <td>WhatsApp</td>
                                        <td>HIGH</td>
                                        <td>Fake account verification request from suspicious number</td>
                                    </tr>
                                    <tr>
                                        <td>Web</td>
                                        <td>LOW</td>
                                        <td>Excessive tracking scripts on e-commerce site</td>
                                    </tr>
                                    <tr>
                                        <td>Email</td>
                                        <td>HIGH</td>
                                        <td>Invoice scam email with malicious attachment</td>
                                    </tr>
                                    <tr>
                                        <td>WhatsApp</td>
                                        <td>MEDIUM</td>
                                        <td>Job offer scam from unverified business account</td>
                                    </tr>
                                    <tr>
                                        <td>Web</td>
                                        <td>HIGH</td>
                                        <td>Fake tech support popup attempting system access</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h2>Security Recommendations</h2>
                        <ol>
                            <li><strong>Enable auto-block for phishing attempts during peak hours (2-4 PM)</strong></li>
                            <li><strong>Review and update whitelist for frequently visited websites</strong></li>
                            <li><strong>Schedule weekly deep scans for comprehensive threat detection</strong></li>
                            <li><strong>Enable two-factor authentication for all critical accounts</strong></li>
                            <li><strong>Regularly update browser extensions and security software</strong></li>
                            <li><strong>Conduct security awareness training for all users</strong></li>
                            <li><strong>Implement network segmentation for critical systems</strong></li>
                            <li><strong>Establish incident response procedures for security breaches</strong></li>
                        </ol>
                    </div>
                    
                    <div class="report-section">
                        <h2>Global Threat Intelligence</h2>
                        <div class="report-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Country</th>
                                        <th>Threat Count</th>
                                        <th>Primary Threats</th>
                                        <th>Risk Level</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>United States ðŸ‡ºðŸ‡¸</td>
                                        <td>874</td>
                                        <td>Phishing, Ransomware</td>
                                        <td>High</td>
                                    </tr>
                                    <tr>
                                        <td>India ðŸ‡®ðŸ‡³</td>
                                        <td>756</td>
                                        <td>Mobile Malware, SMS Scams</td>
                                        <td>High</td>
                                    </tr>
                                    <tr>
                                        <td>Brazil ðŸ‡§ðŸ‡·</td>
                                        <td>634</td>
                                        <td>Banking Trojans, Phishing</td>
                                        <td>Medium</td>
                                    </tr>
                                    <tr>
                                        <td>Russia ðŸ‡·ðŸ‡º</td>
                                        <td>587</td>
                                        <td>State-Sponsored, Ransomware</td>
                                        <td>High</td>
                                    </tr>
                                    <tr>
                                        <td>China ðŸ‡¨ðŸ‡³</td>
                                        <td>542</td>
                                        <td>APT Attacks, Data Theft</td>
                                        <td>Medium</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h2>System Performance Metrics</h2>
                        <div class="report-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Performance Metric</th>
                                        <th>Current Value</th>
                                        <th>Target</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Threat Detection Accuracy</td>
                                        <td>96.7%</td>
                                        <td>95%</td>
                                        <td>Exceeding Target</td>
                                    </tr>
                                    <tr>
                                        <td>False Positive Rate</td>
                                        <td>2.3%</td>
                                        <td>&lt; 5%</td>
                                        <td>Within Range</td>
                                    </tr>
                                    <tr>
                                        <td>System Response Time</td>
                                        <td>0.8s</td>
                                        <td>&lt; 1s</td>
                                        <td>Meeting Target</td>
                                    </tr>
                                    <tr>
                                        <td>Data Processing Speed</td>
                                        <td>1,250 events/sec</td>
                                        <td>1,000 events/sec</td>
                                        <td>Exceeding Target</td>
                                    </tr>
                                    <tr>
                                        <td>Report Generation Time</td>
                                        <td>3.2 seconds</td>
                                        <td>5 seconds</td>
                                        <td>Exceeding Target</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="report-footer">
                        <p><strong>Confidentiality Notice:</strong> This report contains sensitive security information. Handle with appropriate confidentiality measures.</p>
                        <p><strong>Report Generated By:</strong> OmniProtect AI Security System v3.0</p>
                        <p><strong>Contact Information:</strong> security@omniprotect.ai | +1-800-OMNI-PROTECT</p>
                        <p>Â© 2024 OmniProtect Security Solutions. All rights reserved.</p>
                    </div>
                `;
                
                // Create modal for report preview
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content report-modal-content">
                        <div class="modal-header">
                            <h2><i class="fas fa-file-alt"></i> SECURITY REPORT PREVIEW</h2>
                            <button class="close-modal" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <div class="report-preview" id="reportPreview">
                            ${reportContent}
                        </div>
                        <div class="report-download-prompt">
                            <h4><i class="fas fa-download"></i> Report Ready for Download</h4>
                            <p>Your comprehensive security report has been generated. Download it for offline viewing or printing.</p>
                        </div>
                        <div class="report-actions">
                            <button class="btn btn-primary" onclick="downloadReportPDF()">
                                <i class="fas fa-download"></i> Download PDF Report
                            </button>
                            <button class="btn btn-success" onclick="printReport()">
                                <i class="fas fa-print"></i> Print Report
                            </button>
                            <button class="btn btn-danger" onclick="this.closest('.modal').remove()">
                                <i class="fas fa-times"></i> Close Preview
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                showNotification('Report Generated', 'Comprehensive security report is ready for download.', 'low');
            }, 1500);
        }

        // Download report as PDF
        function downloadReportPDF() {
            const { jsPDF } = window.jspdf;
            if (!jsPDF) {
                showNotification('Error', 'PDF library not loaded. Please try again.', 'high');
                return;
            }
            
            const doc = new jsPDF('p', 'mm', 'a4');
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            
            // Add header
            doc.setFillColor(26, 115, 232);
            doc.rect(0, 0, pageWidth, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.text('OmniProtect Security Report', pageWidth / 2, 20, { align: 'center' });
            
            // Add report details
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(`Generated: ${new Date().toLocaleString()}`, 20, 40);
            doc.text('Time Range: Last 24 Hours', 20, 46);
            
            // Add summary table
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Executive Summary', 20, 60);
            
            const summaryData = [
                ['Threats Blocked', '18'],
                ['Suspicious Activities', '7'],
                ['Safe Requests', '324'],
                ['AI Accuracy', '96.7%'],
                ['System Uptime', '99.9%'],
                ['Response Time', '0.8s'],
                ['System Health', '94%']
            ];
            
            let yPos = 70;
            summaryData.forEach(row => {
                doc.setFontSize(12);
                doc.setTextColor(0, 0, 0);
                doc.text(row[0], 20, yPos);
                doc.setTextColor(26, 115, 232);
                doc.text(row[1], 150, yPos);
                yPos += 7;
            });
            
            // Add threat analysis
            yPos += 10;
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Threat Analysis', 20, yPos);
            
            yPos += 10;
            const threats = [
                ['Web', 'LOW', 'Social engineering attempt'],
                ['WhatsApp', 'HIGH', 'Advanced phishing attempt'],
                ['Web', 'MEDIUM', 'Suspicious login page'],
                ['WhatsApp', 'HIGH', 'Fake account verification'],
                ['Web', 'LOW', 'Excessive tracking scripts'],
                ['Email', 'HIGH', 'Invoice scam email'],
                ['WhatsApp', 'MEDIUM', 'Job offer scam'],
                ['Web', 'HIGH', 'Fake tech support popup']
            ];
            
            threats.forEach(threat => {
                if (yPos > pageHeight - 30) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.setFontSize(10);
                doc.text(threat[0], 20, yPos);
                doc.text(threat[1], 50, yPos);
                doc.text(threat[2], 70, yPos, { maxWidth: 120 });
                yPos += 8;
            });
            
            // Save the PDF
            doc.save(`OmniProtect-Report-${new Date().toISOString().split('T')[0]}.pdf`);
            
            showNotification('Report Downloaded', 'PDF report has been downloaded successfully.', 'low');
        }

        // Print report
        function printReport() {
            const printWindow = window.open('', '_blank');
            const reportContent = document.getElementById('reportPreview').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>OmniProtect Security Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                        h1 { color: #1a73e8; border-bottom: 3px solid #1a73e8; padding-bottom: 10px; }
                        h2 { color: #1a73e8; border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 30px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                        th { background-color: #f5f7fa; color: #1a73e8; font-weight: 600; }
                        ol { margin: 20px 0; padding-left: 20px; }
                        li { margin-bottom: 10px; }
                        @media print {
                            body { margin: 20px; }
                            .page-break { page-break-before: always; }
                        }
                    </style>
                </head>
                <body>
                    ${reportContent}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.print();
        }

        // Generate PDF report
        function generatePDFReport() {
            downloadReportPDF();
        }

        // Refresh all data
        function refreshAllData() {
            const refreshAllBtn = document.getElementById('refreshAllBtn');
            if (!refreshAllBtn) return;
            
            const icon = refreshAllBtn.querySelector('i');
            icon.classList.add('fa-spin-fast');
            
            showNotification('Full Refresh', 'Refreshing all dashboard data...', 'medium');
            
            // Refresh all components
            setTimeout(() => {
                refreshDashboard();
                loadGlobalThreatMap();
                loadThreatTimeline();
                loadHeatmapWeek();
                loadActivityFeed();
                refreshAnalytics();
                
                setTimeout(() => {
                    icon.classList.remove('fa-spin-fast');
                    showNotification('Refresh Complete', 'All dashboard components have been updated.', 'low');
                }, 1000);
            }, 500);
        }

        // Toggle AI chat
        function toggleAIChat() {
            const aiChatModal = document.getElementById('aiChatModal');
            if (!aiChatModal) return;
            
            if (aiChatModal.style.display === 'flex') {
                aiChatModal.style.display = 'none';
            } else {
                aiChatModal.style.display = 'flex';
                document.getElementById('chatInput').focus();
            }
        }

        // Ask AI question from suggested questions
        function askAIQuestion(question) {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.value = question;
                sendChatMessage();
            }
        }

        // Send chat message
        function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');
            
            if (!chatInput || !chatMessages) return;
            
            const message = chatInput.value.trim();
            if (!message) return;
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message user-message';
            userMessage.innerHTML = `<p>${message}</p>`;
            chatMessages.appendChild(userMessage);
            
            // Clear input
            chatInput.value = '';
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'chat-message ai-message';
            typingIndicator.innerHTML = '<p><i class="fas fa-ellipsis-h"></i> AI is analyzing your question...</p>';
            chatMessages.appendChild(typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate AI response
            setTimeout(() => {
                typingIndicator.remove();
                
                const aiResponse = document.createElement('div');
                aiResponse.className = 'chat-message ai-message';
                
                // Enhanced AI responses
                let response = generateEnhancedAIResponse(message);
                
                aiResponse.innerHTML = response;
                chatMessages.appendChild(aiResponse);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1500);
        }

        // Generate enhanced AI response
function generateEnhancedAIResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    // Comprehensive cybersecurity dictionary
    if (lowerMessage.includes('what is') || lowerMessage.includes('define') || 
        lowerMessage.includes('definition') || lowerMessage.includes('explain') ||
        lowerMessage.includes('tell me about') || lowerMessage.includes('meaning of')) {
        
        if (lowerMessage.includes('ransomware') || lowerMessage.includes('ransom')) {
            return `
                <p><strong>RANSOMWARE - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Malicious software designed to block access to computer systems or data until a ransom is paid.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>How It Works:</strong>
                        <p>1. <em>Infection:</em> Delivered via phishing emails, malicious downloads, or exploit kits</p>
                        <p>2. <em>Encryption:</em> Encrypts files using strong algorithms (AES-256, RSA-2048)</p>
                        <p>3. <em>Ransom Note:</em> Displays payment instructions, usually in cryptocurrency</p>
                        <p>4. <em>Decryption:</em> Promises to provide decryption key after payment</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Major Ransomware Families:</strong>
                        <p><strong>1. WannaCry (2017):</strong> Exploited EternalBlue vulnerability, affected 230,000+ computers across 150 countries</p>
                        <p><strong>2. NotPetya (2017):</strong> Wiping malware disguised as ransomware, caused $10 billion+ in damages</p>
                        <p><strong>3. Ryuk (2018-present):</strong> Targeted ransomware attacking large enterprises, demands up to millions</p>
                        <p><strong>4. REvil (2019-2021):</strong> RaaS (Ransomware-as-a-Service) with double extortion tactics</p>
                        <p><strong>5. LockBit (2019-present):</strong> Fastest encrypting ransomware, uses triple extortion</p>
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Recent Attacks (2023-2024):</strong>
                        <p><strong>â€¢ MOVEit Transfer Exploit:</strong> Clop ransomware gang stole data from 2,500+ organizations</p>
                        <p><strong>â€¢ Royal Mail Attack:</strong> LockBit disrupted UK postal service international deliveries</p>
                        <p><strong>â€¢ Healthcare Sector:</strong> 46% increase in ransomware attacks on hospitals in 2023</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>Protection Measures:</strong>
                        <p>1. Regular backups (3-2-1 rule: 3 copies, 2 media types, 1 offsite)</p>
                        <p>2. Email filtering and user training</p>
                        <p>3. Patch management (especially RDP vulnerabilities)</p>
                        <p>4. Endpoint Detection and Response (EDR) solutions</p>
                        <p>5. Network segmentation and zero-trust architecture</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Statistics:</strong>
                        <p>â€¢ Average ransom payment: $812,380 (2023)</p>
                        <p>â€¢ Average downtime: 24 days</p>
                        <p>â€¢ 72% of organizations experienced ransomware attacks in 2023</p>
                        <p>â€¢ Only 65% of victims who pay get their data back</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('malware') && !lowerMessage.includes('ransomware')) {
            return `
                <p><strong>MALWARE - Complete Definition & Classification</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Malicious software designed to harm, exploit, or perform unauthorized actions on computer systems.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Primary Malware Categories:</strong>
                        
                        <div class="ai-warning">
                            <strong>1. Viruses:</strong>
                            <p><em>Definition:</em> Self-replicating programs that attach to clean files and spread</p>
                            <p><em>Examples:</em> ILOVEYOU, Melissa, MyDoom</p>
                            <p><em>Impact:</em> File corruption, system crashes, data loss</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>2. Worms:</strong>
                            <p><em>Definition:</em> Standalone malware that replicates to spread to other computers</p>
                            <p><em>Examples:</em> SQL Slammer, Code Red, Stuxnet</p>
                            <p><em>Impact:</em> Network congestion, resource exhaustion</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>3. Trojans:</strong>
                            <p><em>Definition:</em> Malware disguised as legitimate software</p>
                            <p><em>Examples:</em> Zeus, Emotet, Remote Access Trojans (RATs)</p>
                            <p><em>Impact:</em> Backdoor access, data theft, DDoS participation</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>4. Spyware:</strong>
                            <p><em>Definition:</em> Software that secretly monitors user activities</p>
                            <p><em>Examples:</em> Keyloggers, Adware, Tracking cookies</p>
                            <p><em>Impact:</em> Privacy invasion, credential theft</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>5. Adware:</strong>
                            <p><em>Definition:</em> Unwanted software displaying advertisements</p>
                            <p><em>Examples:</em> Fireball, DeskAd, Gator</p>
                            <p><em>Impact:</em> System slowdown, browser hijacking</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>6. Rootkits:</strong>
                            <p><em>Definition:</em> Malware providing privileged access while hiding its existence</p>
                            <p><em>Examples:</em> Sony BMG rootkit, ZeroAccess, Necurs</p>
                            <p><em>Impact:</em> Persistent access, system compromise</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>7. Botnets:</strong>
                            <p><em>Definition:</em> Network of infected computers controlled remotely</p>
                            <p><em>Examples:</em> Mirai, Emotet botnet, Avalanche</p>
                            <p><em>Impact:</em> DDoS attacks, spam distribution, crypto-mining</p>
                        </div>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Historical Malware Milestones:</strong>
                        <p><strong>1986:</strong> Brain - First PC virus</p>
                        <p><strong>1999:</strong> Melissa - First mass-mailing macro virus</p>
                        <p><strong>2000:</strong> ILOVEYOU - Caused $15 billion in damages</p>
                        <p><strong>2004:</strong> MyDoom - Fastest spreading email worm</p>
                        <p><strong>2010:</strong> Stuxnet - First cyberweapon targeting industrial systems</p>
                        <p><strong>2017:</strong> NotPetya - Most destructive malware in history</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>How Malware Spreads:</strong>
                        <p>1. Email attachments and links</p>
                        <p>2. Malicious websites and drive-by downloads</p>
                        <p>3. Software vulnerabilities and exploits</p>
                        <p>4. Removable media (USB drives)</p>
                        <p>5. Social engineering and phishing</p>
                        <p>6. Pirated software and cracks</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('phishing') || lowerMessage.includes('spear phishing')) {
            return `
                <p><strong>PHISHING ATTACKS - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Social engineering attack where attackers impersonate trusted entities to steal sensitive information.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Phishing Types:</strong>
                        
                        <div class="ai-warning">
                            <strong>1. Email Phishing:</strong>
                            <p><em>Method:</em> Mass emails pretending to be from legitimate companies</p>
                            <p><em>Example:</em> "Your account has been compromised" emails</p>
                            <p><em>Success Rate:</em> 3% of recipients typically click</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>2. Spear Phishing:</strong>
                            <p><em>Method:</em> Targeted attacks on specific individuals/organizations</p>
                            <p><em>Example:</em> Fake CEO emails to finance departments</p>
                            <p><em>Target:</em> Executives, HR, finance personnel</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>3. Whaling:</strong>
                            <p><em>Method:</em> Targeting high-profile individuals (CEOs, executives)</p>
                            <p><em>Example:</em> Fake legal subpoenas or board meeting invites</p>
                            <p><em>Impact:</em> Average loss: $1.6 million per incident</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>4. Smishing (SMS Phishing):</strong>
                            <p><em>Method:</em> Phishing via text messages</p>
                            <p><em>Example:</em> "Your package delivery failed" texts with links</p>
                            <p><em>Click Rate:</em> 14% (much higher than email)</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>5. Vishing (Voice Phishing):</strong>
                            <p><em>Method:</em> Phone calls pretending to be tech support or banks</p>
                            <p><em>Example:</em> "Microsoft Support" call about virus infections</p>
                            <p><em>Success:</em> 45% of people over 65 fall victim</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>6. Angler Phishing:</strong>
                            <p><em>Method:</em> Attacks via social media customer service accounts</p>
                            <p><em>Example:</em> Fake customer support accounts on Twitter</p>
                            <p><em>Platforms:</em> Twitter, Facebook, Instagram</p>
                        </div>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Recent Phishing Campaigns (2024):</strong>
                        <p><strong>â€¢ Microsoft 365 Phishing:</strong> Fake login pages stealing Office 365 credentials</p>
                        <p><strong>â€¢ Tax Season Scams:</strong> IRS impersonation emails during tax season</p>
                        <p><strong>â€¢ Cryptocurrency Phishing:</strong> Fake wallet validation requests</p>
                        <p><strong>â€¢ Job Offer Scams:</strong> Fake interviews and job offers on LinkedIn</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>How to Identify Phishing:</strong>
                        <p>1. Check sender email address (look for misspellings)</p>
                        <p>2. Hover over links (don't click immediately)</p>
                        <p>3. Look for urgent language and threats</p>
                        <p>4. Check for spelling and grammar errors</p>
                        <p>5. Verify through official channels</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Statistics:</strong>
                        <p>â€¢ 36% of data breaches involve phishing</p>
                        <p>â€¢ 74% of organizations experience phishing attacks</p>
                        <p>â€¢ Average cost of phishing attack: $4.91 million</p>
                        <p>â€¢ 96% of phishing attacks arrive via email</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('ddos') || lowerMessage.includes('denial of service')) {
            return `
                <p><strong>DDoS ATTACKS - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Distributed Denial of Service attack - overwhelming a target with traffic from multiple sources.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>DDoS Attack Types:</strong>
                        
                        <div class="ai-warning">
                            <strong>1. Volumetric Attacks:</strong>
                            <p><em>Method:</em> Overwhelming bandwidth with massive traffic</p>
                            <p><em>Examples:</em> UDP floods, ICMP floods, DNS amplification</p>
                            <p><em>Record:</em> 3.47 Tbps attack on AWS (2020)</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>2. Protocol Attacks:</strong>
                            <p><em>Method:</em> Exploiting network protocol weaknesses</p>
                            <p><em>Examples:</em> SYN floods, Ping of Death, Smurf attacks</p>
                            <p><em>Target:</em> Network infrastructure (routers, firewalls)</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>3. Application Layer Attacks:</strong>
                            <p><em>Method:</em> Targeting specific applications/services</p>
                            <p><em>Examples:</em> HTTP floods, Slowloris, WordPress XML-RPC</p>
                            <p><em>Impact:</em> Website crashes, API failures</p>
                        </div>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Major DDoS Attacks:</strong>
                        <p><strong>â€¢ GitHub (2018):</strong> 1.35 Tbps attack using Memcached amplification</p>
                        <p><strong>â€¢ Google (2020):</strong> 2.54 Tbps attack, largest recorded</p>
                        <p><strong>â€¢ Amazon Web Services (2020):</strong> 3-day attack peaking at 2.3 Tbps</p>
                        <p><strong>â€¢ Ukrainian Banks (2022):</strong> Coordinated attacks during conflict</p>
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Botnets Used in DDoS:</strong>
                        <p><strong>â€¢ Mirai:</strong> IoT botnet responsible for major attacks</p>
                        <p><strong>â€¢ Meris:</strong> Russian botnet behind record-breaking attacks</p>
                        <p><strong>â€¢ Necurs:</strong> Largest spam botnet with DDoS capabilities</p>
                        <p><strong>â€¢ Emotet:</strong> Banking trojan turned DDoS botnet</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>Protection Strategies:</strong>
                        <p>1. DDoS mitigation services (Cloudflare, Akamai)</p>
                        <p>2. Rate limiting and traffic filtering</p>
                        <p>3. Anycast network distribution</p>
                        <p>4. Web Application Firewalls (WAF)</p>
                        <p>5. Incident response planning</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Statistics:</strong>
                        <p>â€¢ DDoS attacks increased by 150% in 2023</p>
                        <p>â€¢ Average attack duration: 30 minutes</p>
                        <p>â€¢ 77% of attacks target applications</p>
                        <p>â€¢ Average cost per attack: $120,000</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('zero-day') || lowerMessage.includes('0day')) {
            return `
                <p><strong>ZERO-DAY EXPLOITS - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Vulnerabilities unknown to software vendors, giving attackers advantage until patched.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Zero-Day Lifecycle:</strong>
                        <p>1. <em>Discovery:</em> Vulnerability found by researchers or attackers</p>
                        <p>2. <em>Exploit Development:</em> Attackers create working exploit</p>
                        <p>3. <em>Attack:</em> Exploit deployed in the wild</p>
                        <p>4. <em>Detection:</em> Vendor or researchers discover attack</p>
                        <p>5. <em>Patch Development:</em> Vendor creates and tests fix</p>
                        <p>6. <em>Patch Deployment:</em> Update released to users</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Famous Zero-Day Exploits:</strong>
                        <p><strong>1. Stuxnet (2010):</strong> Used 4 zero-days to target Iranian nuclear facilities</p>
                        <p><strong>2. Operation Aurora (2009):</strong> Targeted Google using Internet Explorer vulnerability</p>
                        <p><strong>3. WannaCry (2017):</strong> Used EternalBlue exploit leaked from NSA</p>
                        <p><strong>4. SolarWinds (2020):</strong> Supply chain attack using multiple zero-days</p>
                        <p><strong>5. Log4Shell (2021):</strong> Critical vulnerability in Log4j logging library</p>
                        <p><strong>6. MOVEit Transfer (2023):</strong> SQL injection zero-day affecting file transfer software</p>
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Zero-Day Market:</strong>
                        <p><strong>â€¢ Price Range:</strong> $10,000 to $2.5 million per exploit</p>
                        <p><strong>â€¢ Buyers:</strong> Governments, intelligence agencies, cybercriminals</p>
                        <p><strong>â€¢ Sellers:</strong> Security researchers, exploit brokers</p>
                        <p><strong>â€¢ Platforms:</strong> Zerodium, Hacking Team, private markets</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>Protection Measures:</strong>
                        <p>1. Regular patching and updates</p>
                        <p>2. Intrusion Prevention Systems (IPS)</p>
                        <p>3. Application whitelisting</p>
                        <p>4. Network segmentation</p>
                        <p>5. Threat intelligence feeds</p>
                        <p>6. Endpoint Detection and Response (EDR)</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Statistics (2023):</strong>
                        <p>â€¢ 55 zero-day vulnerabilities exploited</p>
                        <p>â€¢ Average time to patch: 52 days</p>
                        <p>â€¢ 80% exploited by state-sponsored actors</p>
                        <p>â€¢ Chrome had most zero-days (15)</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('social engineering') || lowerMessage.includes('pretexting') || 
            lowerMessage.includes('baiting') || lowerMessage.includes('tailgating')) {
            return `
                <p><strong>SOCIAL ENGINEERING - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Psychological manipulation to trick people into revealing confidential information or performing actions.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>Social Engineering Techniques:</strong>
                        
                        <div class="ai-warning">
                            <strong>1. Pretexting:</strong>
                            <p><em>Method:</em> Creating fake scenarios to obtain information</p>
                            <p><em>Example:</em> Impersonating IT support asking for passwords</p>
                            <p><em>Target:</em> Help desks, customer service</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>2. Baiting:</strong>
                            <p><em>Method:</em> Offering something enticing to deliver malware</p>
                            <p><em>Example:</em> "Free software" USB drives left in parking lots</p>
                            <p><em>Success Rate:</em> 60% of people plug in found USB drives</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>3. Tailgating/Piggybacking:</strong>
                            <p><em>Method:</em> Following authorized person into restricted area</p>
                            <p><em>Example:</em> Holding coffee while someone holds door open</p>
                            <p><em>Defense:</em> "No tailgating" policies and access control</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>4. Quid Pro Quo:</strong>
                            <p><em>Method:</em> Offering service in exchange for information</p>
                            <p><em>Example:</em> Fake tech support offering "free security check"</p>
                            <p><em>Victims:</em> Often elderly or less tech-savvy users</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>5. Watering Hole:</strong>
                            <p><em>Method:</em> Compromising websites frequented by target group</p>
                            <p><em>Example:</em> Hacking industry-specific forums or news sites</p>
                            <p><em>Target:</em> Specific organizations or industries</p>
                        </div>
                        
                        <div class="ai-warning">
                            <strong>6. Honey Trap:</strong>
                            <p><em>Method:</em> Using romantic or sexual appeal to extract information</p>
                            <p><em>Example:</em> Fake social media profiles targeting executives</p>
                            <p><em>Platforms:</em> LinkedIn, dating apps, social media</p>
                        </div>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Famous Social Engineering Attacks:</strong>
                        <p><strong>â€¢ Kevin Mitnick (1990s):</strong> Used social engineering to access phone networks</p>
                        <p><strong>â€¢ Target Breach (2013):</strong> HVAC contractor credentials stolen via phishing</p>
                        <p><strong>â€¢ Ubiquiti (2021):</strong> Lost $46.7 million to business email compromise</p>
                        <p><strong>â€¢ Twitter Bitcoin Scam (2020):</strong> Hackers social engineered Twitter employees</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>Defense Strategies:</strong>
                        <p>1. Security awareness training (quarterly)</p>
                        <p>2. Multi-factor authentication</p>
                        <p>3. Clear desk policies</p>
                        <p>4. Verification procedures for requests</p>
                        <p>5. Incident reporting culture</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Psychology Behind Attacks:</strong>
                        <p>â€¢ <strong>Authority:</strong> Impersonating figures of authority</p>
                        <p>â€¢ <strong>Urgency:</strong> Creating time pressure</p>
                        <p>â€¢ <strong>Reciprocity:</strong> Offering something first</p>
                        <p>â€¢ <strong>Social Proof:</strong> "Everyone else is doing it"</p>
                        <p>â€¢ <strong>Likability:</strong> Building rapport and trust</p>
                    </div>
                </div>
            `;
        }
        
        if (lowerMessage.includes('apt') || lowerMessage.includes('advanced persistent threat')) {
            return `
                <p><strong>ADVANCED PERSISTENT THREATS (APTs) - Complete Guide</strong></p>
                
                <div class="ai-response-section">
                    <div class="ai-tip">
                        <strong>Definition:</strong> Sophisticated, long-term cyber attacks by nation-states or organized groups targeting specific entities.
                    </div>
                    
                    <div class="ai-warning">
                        <strong>APT Characteristics:</strong>
                        <p>1. <strong>Advanced:</strong> Uses sophisticated techniques and custom malware</p>
                        <p>2. <strong>Persistent:</strong> Maintains access for months or years</p>
                        <p>3. <strong>Threat:</strong> Well-resourced, organized adversaries</p>
                        <p>4. <strong>Objectives:</strong> Espionage, sabotage, intellectual property theft</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Major APT Groups:</strong>
                        
                        <div class="ai-success">
                            <strong>â€¢ APT29 (Cozy Bear):</strong>
                            <p><em>Attribution:</em> Russian SVR/FSB</p>
                            <p><em>Targets:</em> Governments, think tanks, healthcare</p>
                            <p><em>Notable Attacks:</em> SolarWinds, DNC hack</p>
                        </div>
                        
                        <div class="ai-success">
                            <strong>â€¢ APT28 (Fancy Bear):</strong>
                            <p><em>Attribution:</em> Russian GRU</p>
                            <p><em>Targets:</em> Military, political organizations</p>
                            <p><em>Notable Attacks:</em> French TV5Monde, German parliament</p>
                        </div>
                        
                        <div class="ai-success">
                            <strong>â€¢ APT1 (Comment Crew):</strong>
                            <p><em>Attribution:</em> Chinese PLA Unit 61398</p>
                            <p><em>Targets:</em> Defense contractors, technology firms</p>
                            <p><em>Notable Attacks:</em> Operation Aurora</p>
                        </div>
                        
                        <div class="ai-success">
                            <strong>â€¢ Lazarus Group:</strong>
                            <p><em>Attribution:</em> North Korean Reconnaissance General Bureau</p>
                            <p><em>Targets:</em> Financial institutions, cryptocurrency</p>
                            <p><em>Notable Attacks:</em> Sony Pictures, Bangladesh Bank, WannaCry</p>
                        </div>
                    </div>
                    
                    <div class="ai-warning">
                        <strong>APT Attack Lifecycle:</strong>
                        <p>1. <em>Reconnaissance:</em> Research and information gathering</p>
                        <p>2. <em>Initial Access:</em> Spear phishing, exploit delivery</p>
                        <p>3. <em>Execution:</em> Malware deployment and execution</p>
                        <p>4. <em>Persistence:</strong> Maintaining long-term access</p>
                        <p>5. <em>Lateral Movement:</em> Expanding within network</p>
                        <p>6. <em>Exfiltration:</em> Stealing and sending data</p>
                        <p>7. <em>Cleanup:</em> Removing traces of attack</p>
                    </div>
                    
                    <div class="ai-tip">
                        <strong>Detection Strategies:</strong>
                        <p>1. Network traffic analysis</p>
                        <p>2. Endpoint behavior monitoring</p>
                        <p>3. Threat intelligence integration</p>
                        <p>4. User entity behavior analytics</p>
                        <p>5. Deception technology</p>
                    </div>
                    
                    <div class="ai-success">
                        <strong>Statistics:</strong>
                        <p>â€¢ 86% of APT attacks start with spear phishing</p>
                        <p>â€¢ Average dwell time: 56 days</p>
                        <p>â€¢ 60% target intellectual property</p>
                        <p>â€¢ Detection cost: $2.4 million on average</p>
                    </div>
                </div>
            `;
        }
        
        // Default cybersecurity definitions response
        return `
            <p><strong>CYBERSECURITY THREATS - Complete Definitions</strong></p>
            
            <div class="ai-response-section">
                <div class="ai-tip">
                    <strong>I can provide detailed information about:</strong>
                </div>
                
                <div class="ai-success">
                    <strong>Malware Types:</strong>
                    <p>â€¢ <strong>Ransomware:</strong> Encrypts files for ransom</p>
                    <p>â€¢ <strong>Viruses:</strong> Self-replicating programs</p>
                    <p>â€¢ <strong>Worms:</strong> Network-spreading malware</p>
                    <p>â€¢ <strong>Trojans:</strong> Disguised malicious software</p>
                    <p>â€¢ <strong>Spyware:</strong> Secret monitoring software</p>
                    <p>â€¢ <strong>Rootkits:</strong> System-level hiding malware</p>
                    <p>â€¢ <strong>Botnets:</strong> Networks of infected devices</p>
                </div>
                
                <div class="ai-success">
                    <strong>Attack Methods:</strong>
                    <p>â€¢ <strong>Phishing:</strong> Deceptive emails/websites</p>
                    <p>â€¢ <strong>DDoS:</strong> Overwhelming traffic attacks</p>
                    <p>â€¢ <strong>Zero-Day:</strong> Unknown vulnerabilities</p>
                    <p>â€¢ <strong>Social Engineering:</strong> Psychological manipulation</p>
                    <p>â€¢ <strong>APT:</strong> Advanced Persistent Threats</p>
                    <p>â€¢ <strong>Man-in-the-Middle:</strong> Communication interception</p>
                    <p>â€¢ <strong>SQL Injection:</strong> Database attacks</p>
                </div>
                
                <div class="ai-success">
                    <strong>Real-World Examples:</strong>
                    <p>â€¢ <strong>WannaCry:</strong> Global ransomware attack</p>
                    <p>â€¢ <strong>SolarWinds:</strong> Supply chain compromise</p>
                    <p>â€¢ <strong>Stuxnet:</strong> Industrial system attack</p>
                    <p>â€¢ <strong>Log4Shell:</strong> Critical vulnerability</p>
                    <p>â€¢ <strong>MOVEit:</strong> Mass data theft attack</p>
                </div>
                
                <div class="ai-tip">
                    <p><strong>Ask me about specific threats like:</strong></p>
                    <p>"What is ransomware?"</p>
                    <p>"Explain DDoS attacks"</p>
                    <p>"Define social engineering"</p>
                    <p>"Tell me about APT groups"</p>
                    <p>"Examples of zero-day exploits"</p>
                </div>
            </div>
            
            <div class="suggested-questions">
                <div class="suggested-question" onclick="askAIQuestion('What is ransomware? Give complete details')">Ransomware Details</div>
                <div class="suggested-question" onclick="askAIQuestion('Explain all malware types with examples')">All Malware Types</div>
                <div class="suggested-question" onclick="askAIQuestion('What are APT attacks? Give examples')">APT Attacks</div>
                <div class="suggested-question" onclick="askAIQuestion('Define social engineering techniques')">Social Engineering</div>
            </div>
        `;
    }
    
    // Enhanced security guidance
    if (lowerMessage.includes('enhance') || lowerMessage.includes('improve') || lowerMessage.includes('better security')) {
        return `
            <p><strong>Comprehensive Security Enhancement Guide:</strong></p>
            
            <div class="ai-response-section">
                <p><strong>1. Multi-Layered Defense Strategy:</strong></p>
                <div class="ai-tip">
                    <strong>Network Layer:</strong> Implement next-gen firewalls, intrusion prevention systems, and secure web gateways
                </div>
                <div class="ai-tip">
                    <strong>Endpoint Protection:</strong> Deploy EDR solutions, application whitelisting, and device control
                </div>
                <div class="ai-tip">
                    <strong>Identity Management:</strong> Enforce MFA, least privilege access, and regular access reviews
                </div>
                
                <p><strong>2. Advanced Threat Detection:</strong></p>
                <div class="ai-success">
                    â€¢ Implement User and Entity Behavior Analytics (UEBA)
                    â€¢ Deploy deception technology for early threat detection
                    â€¢ Use threat intelligence feeds for proactive defense
                </div>
                
                <p><strong>3. Data Protection Measures:</strong></p>
                <div class="ai-warning">
                    â€¢ Encrypt sensitive data at rest and in transit
                    â€¢ Implement Data Loss Prevention (DLP) solutions
                    â€¢ Regular backup and disaster recovery testing
                </div>
                
                <p><strong>4. Continuous Monitoring & Response:</strong></p>
                <div class="ai-tip">
                    â€¢ 24/7 Security Operations Center (SOC)
                    â€¢ Automated incident response workflows
                    â€¢ Regular security assessments and penetration testing
                </div>
            </div>
            
            <p><strong>Immediate Actions You Can Take:</strong></p>
            <ol>
                <li>Enable all OmniProtect security modules</li>
                <li>Schedule regular AI security scans</li>
                <li>Review and update security policies</li>
                <li>Implement security awareness training</li>
            </ol>
        `;
    } 
    // OmniProtect usage guide
    else if (lowerMessage.includes('use') || lowerMessage.includes('how to') || lowerMessage.includes('guide') || lowerMessage.includes('tutorial')) {
        return `
            <p><strong>OmniProtect Comprehensive Usage Guide:</strong></p>
            
            <div class="ai-response-section">
                <p><strong>Getting Started:</strong></p>
                <div class="ai-tip">
                    1. <strong>Dashboard Navigation:</strong> Use the main dashboard to monitor real-time threats and system status
                </div>
                <div class="ai-tip">
                    2. <strong>Quick Actions:</strong> Utilize the quick action buttons for immediate security tasks
                </div>
                <div class="ai-tip">
                    3. <strong>Manual Testing:</strong> Use the manual test section to analyze suspicious URLs or content
                </div>
                
                <p><strong>Key Features & How to Use Them:</strong></p>
                <div class="ai-success">
                    <strong>Real-Time Monitoring:</strong>
                    â€¢ View threat logs in real-time
                    â€¢ Filter threats by type, severity, and platform
                    â€¢ Click on any log for detailed information
                </div>
                
                <div class="ai-success">
                    <strong>Security Analytics:</strong>
                    â€¢ Monitor threat distribution charts
                    â€¢ Track security trends over time
                    â€¢ Review platform-specific threat data
                </div>
                
                <div class="ai-success">
                    <strong>Global Threat Intelligence:</strong>
                    â€¢ View global threat distribution map
                    â€¢ Monitor country-specific threat data
                    â€¢ Analyze heat maps for pattern detection
                </div>
            </div>
        `;
    }
    // Report generation
    else if (lowerMessage.includes('report') || lowerMessage.includes('generate report') || lowerMessage.includes('summary')) {
        return `
            <p><strong>Security Report Generation Guide:</strong></p>
            
            <div class="ai-response-section">
                <p>I can help you generate comprehensive security reports with detailed threat analysis, recommendations, and system performance metrics.</p>
                
                <div class="ai-success">
                    <strong>Report Features Include:</strong>
                    â€¢ Executive summary with key metrics
                    â€¢ Detailed threat analysis by platform
                    â€¢ Global threat intelligence
                    â€¢ Security recommendations
                    â€¢ System performance metrics
                </div>
            </div>
            
            <p><strong>How to Generate a Report:</strong></p>
            <ol>
                <li>Click the "Generate Report" quick action button</li>
                <li>Or use the export button and select "Full Report"</li>
                <li>Preview the report before downloading</li>
                <li>Download in PDF format or print directly</li>
            </ol>
            
            <p>Would you like me to generate a comprehensive security report for you now?</p>
        `;
    }
    // Default response
    else {
        return `
            <p><strong>OmniProtect AI Security Assistant</strong></p>
            
            <div class="ai-response-section">
                <p>I can provide comprehensive information about:</p>
                
                <div class="ai-tip">
                    <strong>Cybersecurity Threats:</strong>
                    <p>â€¢ Malware (Ransomware, Viruses, Worms, Trojans, Spyware)</p>
                    <p>â€¢ Attack Methods (Phishing, DDoS, Social Engineering)</p>
                    <p>â€¢ Advanced Threats (APTs, Zero-Days, Supply Chain)</p>
                    <p>â€¢ Real-World Attack Examples</p>
                </div>
                
                <div class="ai-tip">
                    <strong>Security Guidance:</strong>
                    <p>â€¢ Security enhancement strategies</p>
                    <p>â€¢ Threat prevention measures</p>
                    <p>â€¢ Incident response planning</p>
                    <p>â€¢ Compliance and best practices</p>
                </div>
                
                <div class="ai-tip">
                    <strong>OmniProtect Features:</strong>
                    <p>â€¢ Dashboard usage and navigation</p>
                    <p>â€¢ Threat analysis and reporting</p>
                    <p>â€¢ Security scanning and monitoring</p>
                    <p>â€¢ Configuration and optimization</p>
                </div>
            </div>
            
            <p><strong>Try asking me:</strong></p>
            <div class="suggested-questions">
                <div class="suggested-question" onclick="askAIQuestion('What is ransomware? Give complete details')">Ransomware Details</div>
                <div class="suggested-question" onclick="askAIQuestion('Explain all malware types with examples')">All Malware Types</div>
                <div class="suggested-question" onclick="askAIQuestion('What are APT attacks? Give examples')">APT Attacks</div>
                <div class="suggested-question" onclick="askAIQuestion('Define social engineering techniques')">Social Engineering</div>
                <div class="suggested-question" onclick="askAIQuestion('Explain DDoS attacks and prevention')">DDoS Attacks</div>
                <div class="suggested-question" onclick="askAIQuestion('What are zero-day exploits?')">Zero-Day Exploits</div>
            </div>
        `;
    }
}

        // Analyze input
        function analyzeInput() {
            const testInput = document.getElementById('testInput');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const testResult = document.getElementById('testResult');
            const resultContent = document.getElementById('resultContent');
            
            if (!testInput || !analyzeBtn || !testResult || !resultContent) return;
            
            const input = testInput.value.trim();
            if (!input) {
                showNotification('Input Required', 'Please enter a URL or text to analyze.', 'medium');
                return;
            }
            
            const icon = analyzeBtn.querySelector('i');
            icon.classList.remove('fa-search');
            icon.classList.add('fa-spinner', 'fa-spin');
            
            // Simulate analysis
            setTimeout(() => {
                let result = '';
                let level = 'low';
                
                // Simple analysis logic
                if (input.includes('fake') || input.includes('phishing') || input.includes('login') || input.includes('verify')) {
                    result = `
                        <h4><i class="fas fa-exclamation-triangle"></i> HIGH RISK - PHISHING ATTACK DETECTED</h4>
                        <p><strong>Analysis:</strong> This appears to be a phishing attempt designed to steal credentials.</p>
                        <p><strong>Confidence:</strong> 96%</p>
                        <p><strong>Recommendation:</strong> Block immediately and do not interact with this content.</p>
                        <p><strong>Action Taken:</strong> Added to threat database and blocked for all users.</p>
                    `;
                    level = 'high';
                } else if (input.includes('malware') || input.includes('.exe') || input.includes('virus') || input.includes('trojan')) {
                    result = `
                        <h4><i class="fas fa-virus"></i> HIGH RISK - MALWARE DETECTED</h4>
                        <p><strong>Analysis:</strong> Potentially malicious software identified.</p>
                        <p><strong>Confidence:</strong> 92%</p>
                        <p><strong>Recommendation:</strong> Do not download or execute this file.</p>
                        <p><strong>Action Taken:</strong> Quarantined and added to malware signatures.</p>
                    `;
                    level = 'high';
                } else if (input.includes('http://') && !input.includes('https://')) {
                    result = `
                        <h4><i class="fas fa-exclamation-circle"></i> MEDIUM RISK - INSECURE CONNECTION</h4>
                        <p><strong>Analysis:</strong> Unencrypted HTTP connection detected.</p>
                        <p><strong>Confidence:</strong> 85%</p>
                        <p><strong>Recommendation:</strong> Use HTTPS version if available.</p>
                        <p><strong>Action Taken:</strong> Warning issued, connection allowed with caution.</p>
                    `;
                    level = 'medium';
                } else if (input.includes('https://google.com') || input.includes('https://microsoft.com') || input.includes('https://apple.com')) {
                    result = `
                        <h4><i class="fas fa-check-circle"></i> LOW RISK - TRUSTED SOURCE</h4>
                        <p><strong>Analysis:</strong> This appears to be a legitimate and trusted website.</p>
                        <p><strong>Confidence:</strong> 99%</p>
                        <p><strong>Recommendation:</strong> Safe to proceed.</p>
                        <p><strong>Action Taken:</strong> No action required.</p>
                    `;
                    level = 'low';
                } else {
                    result = `
                        <h4><i class="fas fa-info-circle"></i> ANALYSIS COMPLETE</h4>
                        <p><strong>Analysis:</strong> No immediate threats detected.</p>
                        <p><strong>Confidence:</strong> 78%</p>
                        <p><strong>Recommendation:</strong> Proceed with normal caution.</p>
                        <p><strong>Action Taken:</strong> Monitored for suspicious activity.</p>
                    `;
                    level = 'low';
                }
                
                resultContent.innerHTML = result;
                testResult.className = `test-result ${level}`;
                testResult.style.display = 'block';
                
                icon.classList.remove('fa-spinner', 'fa-spin');
                icon.classList.add('fa-search');
                
                // Add to logs
                const newLog = {
                    id: threatLogs.length + 1,
                    type: 'Manual Security Test',
                    content: `Manual analysis of: ${input.substring(0, 50)}${input.length > 50 ? '...' : ''}`,
                    time: 'Just now',
                    level: level,
                    platform: 'Manual Test',
                    tags: ['manual', 'analysis', level],
                    details: {
                        input: input.substring(0, 100),
                        result: level.toUpperCase() + ' RISK',
                        confidence: result.match(/Confidence.*?(\d+%)/)?.[1] || 'Unknown',
                        action: 'Analyzed manually'
                    }
                };
                
                threatLogs.unshift(newLog);
                if (threatLogs.length > 10) threatLogs.pop();
                renderThreatLogs();
                
                showNotification('Analysis Complete', `Security analysis completed. Result: ${level.toUpperCase()} risk.`, level);
            }, 2000);
        }

        // Test sample
        function testSample(type) {
            const testInput = document.getElementById('testInput');
            if (!testInput) return;
            
            let sample = '';
            switch(type) {
                case 'phishing':
                    sample = 'https://secure-bank-login-verification.com/update-your-credentials-now';
                    break;
                case 'malware':
                    sample = 'http://download-free-software-now.com/setup.exe';
                    break;
            }
            
            testInput.value = sample;
            analyzeInput();
        }

        // Handle log action
        function handleLogAction(logId, action) {
            const log = threatLogs.find(l => l.id === logId);
            if (!log) return;
            
            let message = '';
            switch(action) {
                case 'block':
                    message = `Threat "${log.type}" has been permanently blocked.`;
                    break;
                case 'whitelist':
                    message = `"${log.type}" has been added to whitelist.`;
                    break;
            }
            
            showNotification('Action Completed', message, 'low');
            
            // Update log
            log.tags.push(action);
            renderThreatLogs();
        }

        // Toggle log details
        function toggleLogDetails(logId) {
            const details = document.getElementById(`logDetails${logId}`);
            if (details) {
                details.classList.toggle('active');
            }
        }

        // Apply filters
        function applyFilters() {
            const threatLevel = document.getElementById('threatLevelFilter').value;
            const timePeriod = document.getElementById('timePeriodFilter').value;
            const platform = document.getElementById('platformFilter').value;
            const threatType = document.getElementById('threatTypeFilter').value;
            
            currentFilters = { threatLevel, timePeriod, platform, threatType };
            
            // Filter threat logs
            let filteredLogs = [...threatLogs];
            
            // Apply threat level filter
            if (threatLevel !== 'all') {
                if (threatLevel === 'high') {
                    filteredLogs = filteredLogs.filter(log => log.level === 'high');
                } else if (threatLevel === 'medium') {
                    filteredLogs = filteredLogs.filter(log => log.level === 'high' || log.level === 'medium');
                } else if (threatLevel === 'low') {
                    filteredLogs = filteredLogs.filter(log => log.level === 'high' || log.level === 'medium' || log.level === 'low');
                }
            }
            
            // Apply platform filter
            if (platform !== 'all') {
                filteredLogs = filteredLogs.filter(log => log.platform.toLowerCase() === platform.toLowerCase());
            }
            
            // Apply threat type filter
            if (threatType !== 'all') {
                filteredLogs = filteredLogs.filter(log => 
                    log.tags.some(tag => tag.toLowerCase().includes(threatType.toLowerCase())) ||
                    log.type.toLowerCase().includes(threatType.toLowerCase())
                );
            }
            
            // Show filtered logs
            const threatLogsContainer = document.getElementById('threatLogs');
            if (threatLogsContainer) {
                threatLogsContainer.innerHTML = '';
                
                filteredLogs.forEach(log => {
                    const logElement = document.createElement('div');
                    logElement.className = `log-item ${log.level}`;
                    logElement.innerHTML = `
                        <div class="log-header">
                            <div class="log-type">
                                <i class="fas fa-${getLogIcon(log.level)}"></i>
                                ${log.type}
                            </div>
                            <div class="log-time">
                                <i class="far fa-clock"></i>
                                ${log.time}
                            </div>
                        </div>
                        <div class="log-content">
                            ${log.content}
                        </div>
                        <div class="log-tags">
                            ${log.tags.map(tag => `<span class="log-tag">${tag}</span>`).join('')}
                            <span class="log-tag"><i class="fab fa-${log.platform.toLowerCase()}"></i> ${log.platform}</span>
                        </div>
                    `;
                    threatLogsContainer.appendChild(logElement);
                });
            }
            
            showNotification('Filters Applied', `Showing ${filteredLogs.length} filtered threats`, 'low');
        }

        // Reset filters
        function resetFilters() {
            document.getElementById('threatLevelFilter').value = 'all';
            document.getElementById('timePeriodFilter').value = '24h';
            document.getElementById('platformFilter').value = 'all';
            document.getElementById('threatTypeFilter').value = 'all';
            
            currentFilters = { threatLevel: 'all', timePeriod: '24h', platform: 'all', threatType: 'all' };
            
            // Reload all logs
            renderThreatLogs();
            
            showNotification('Filters Reset', 'All filters have been reset to default.', 'low');
        }

        // Save filter
        function saveFilter() {
            const filterName = prompt('Enter a name for this filter:');
            if (filterName) {
                // Save to localStorage
                const savedFilters = JSON.parse(localStorage.getItem('omniprotect_filters') || '[]');
                savedFilters.push({
                    name: filterName,
                    filters: currentFilters,
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem('omniprotect_filters', JSON.stringify(savedFilters));
                
                showNotification('Filter Saved', `Filter "${filterName}" has been saved.`, 'low');
            }
        }

        // Update time range
        function updateTimeRange() {
            const timeRange = document.getElementById('threatTimeRange').value;
            const threatLogsContainer = document.getElementById('threatLogs');
            
            if (!threatLogsContainer) return;
            
            // Add animation
            threatLogsContainer.classList.add('time-range-updating');
            
            setTimeout(() => {
                // Filter logs based on time range
                let filteredLogs = [...threatLogs];
                
                if (timeRange === '1h') {
                    // Show only recent logs (simulated)
                    filteredLogs = filteredLogs.slice(0, 2);
                } else if (timeRange === '7d') {
                    // Show more logs for 7 days
                    filteredLogs = filteredLogs.concat(generateAdditionalLogs(10));
                } else if (timeRange === '30d') {
                    // Show even more logs for 30 days
                    filteredLogs = filteredLogs.concat(generateAdditionalLogs(20));
                }
                
                // Render filtered logs
                threatLogsContainer.innerHTML = '';
                filteredLogs.forEach(log => {
                    const logElement = document.createElement('div');
                    logElement.className = `log-item ${log.level}`;
                    logElement.innerHTML = `
                        <div class="log-header">
                            <div class="log-type">
                                <i class="fas fa-${getLogIcon(log.level)}"></i>
                                ${log.type}
                            </div>
                            <div class="log-time">
                                <i class="far fa-clock"></i>
                                ${log.time}
                            </div>
                        </div>
                        <div class="log-content">
                            ${log.content}
                        </div>
                        <div class="log-tags">
                            ${log.tags.map(tag => `<span class="log-tag">${tag}</span>`).join('')}
                            <span class="log-tag"><i class="fab fa-${log.platform.toLowerCase()}"></i> ${log.platform}</span>
                        </div>
                    `;
                    threatLogsContainer.appendChild(logElement);
                });
                
                // Update counters based on time range
                updateCounters();
                
                // Remove animation class
                setTimeout(() => {
                    threatLogsContainer.classList.remove('time-range-updating');
                }, 1000);
                
                showNotification('Time Range Updated', `Showing threats from ${timeRange}`, 'low');
            }, 500);
        }

        // Generate additional logs for time range
        function generateAdditionalLogs(count) {
            const types = ['Phishing', 'Malware', 'Spam', 'Suspicious', 'Data Leak'];
            const platforms = ['WhatsApp', 'Web', 'Email', 'SMS'];
            const levels = ['high', 'medium', 'low'];
            const times = ['1 hour ago', '3 hours ago', '5 hours ago', 'Yesterday', '2 days ago', 'Last week'];
            
            const additionalLogs = [];
            
            for (let i = 0; i < count; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const platform = platforms[Math.floor(Math.random() * platforms.length)];
                const level = levels[Math.floor(Math.random() * levels.length)];
                const time = times[Math.floor(Math.random() * times.length)];
                
                additionalLogs.push({
                    id: threatLogs.length + i + 1,
                    type: `${type} Detected`,
                    content: `Historical ${type.toLowerCase()} threat detected on ${platform}`,
                    time: time,
                    level: level,
                    platform: platform,
                    tags: [type.toLowerCase(), platform.toLowerCase(), 'historical']
                });
            }
            
            return additionalLogs;
        }

        // Refresh analytics
        function refreshAnalytics() {
            const refreshAnalyticsBtn = document.getElementById('refreshAnalytics');
            if (!refreshAnalyticsBtn) return;
            
            const icon = refreshAnalyticsBtn.querySelector('i');
            icon.classList.add('fa-spin-fast');
            
            // Update charts with new random data
            if (charts.threatTrend) {
                const newData = Array.from({length: 24}, () => Math.floor(Math.random() * 100) + 50);
                charts.threatTrend.data.datasets[0].data = newData;
                charts.threatTrend.update();
            }
            
            // Update threat counts with slight variations
            Object.keys(threatData.types).forEach(key => {
                const change = Math.floor(Math.random() * 20) - 10;
                threatData.types[key] = Math.max(50, threatData.types[key] + change);
            });
            
            if (charts.threatType) {
                charts.threatType.data.datasets[0].data = Object.values(threatData.types);
                charts.threatType.update();
            }
            
            // Update severity distribution
            Object.keys(threatData.severity).forEach(key => {
                const change = Math.floor(Math.random() * 30) - 15;
                threatData.severity[key] = Math.max(100, threatData.severity[key] + change);
            });
            
            if (charts.severity) {
                charts.severity.data.datasets[0].data = Object.values(threatData.severity);
                charts.severity.update();
            }
            
            // Update platform distribution
            Object.keys(threatData.platforms).forEach(key => {
                const change = Math.floor(Math.random() * 20) - 10;
                threatData.platforms[key] = Math.max(50, threatData.platforms[key] + change);
            });
            
            if (charts.platform) {
                charts.platform.data.datasets[0].data = Object.values(threatData.platforms);
                charts.platform.update();
            }
            
            setTimeout(() => {
                icon.classList.remove('fa-spin-fast');
                showNotification('Analytics Updated', 'Charts and statistics have been refreshed.', 'low');
            }, 1000);
        }

        // Start auto updates
        function startAutoUpdates() {
            // Update time every minute
            setInterval(updateLastUpdated, 60000);
            
            // Simulate new threats every 2-5 minutes
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% chance
                    simulateNewThreat();
                }
            }, 120000 + Math.random() * 180000);
        }

        // Update last updated time
        function updateLastUpdated() {
            const lastUpdated = document.getElementById('lastUpdated');
            if (lastUpdated) {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                lastUpdated.textContent = `${timeString}`;
            }
        }

        // Simulate new threat
        function simulateNewThreat() {
            const threatTypes = ['Phishing', 'Malware', 'Spam', 'Suspicious'];
            const platforms = ['WhatsApp', 'Web', 'Email', 'SMS'];
            const levels = ['high', 'medium', 'low'];
            
            const type = threatTypes[Math.floor(Math.random() * threatTypes.length)];
            const platform = platforms[Math.floor(Math.random() * platforms.length)];
            const level = levels[Math.floor(Math.random() * levels.length)];
            
            const newLog = {
                id: threatLogs.length + 1,
                type: `${type} Detected`,
                content: `New ${type.toLowerCase()} threat detected on ${platform}`,
                time: 'Just now',
                level: level,
                platform: platform,
                tags: [type.toLowerCase(), platform.toLowerCase(), 'auto'],
                details: {
                    detected: 'Automated monitoring',
                    action: level === 'high' ? 'Blocked immediately' : 'Flagged for review',
                    confidence: `${Math.floor(70 + Math.random() * 25)}%`,
                    source: 'Real-time monitoring'
                }
            };
            
            threatLogs.unshift(newLog);
            if (threatLogs.length > 10) threatLogs.pop();
            renderThreatLogs();
            
            // Update counters
            const threatsBlocked = document.getElementById('threatsBlocked');
            if (threatsBlocked) {
                threatsBlocked.textContent = (parseInt(threatsBlocked.textContent.replace(/,/g, '')) + 1).toLocaleString();
            }
            
            const suspiciousActivities = document.getElementById('suspiciousActivities');
            if (suspiciousActivities) {
                suspiciousActivities.textContent = parseInt(suspiciousActivities.textContent) + 1;
            }
            
            // Show notification for high priority
            if (level === 'high') {
                showNotification('New High Threat', newLog.content, 'high');
            }
        }

        // Helper function to get log icon
        function getLogIcon(level) {
            switch(level) {
                case 'high': return 'exclamation-triangle';
                case 'medium': return 'exclamation-circle';
                case 'low': return 'info-circle';
                default: return 'info-circle';
            }
        }

        // Helper function to format key
        function formatKey(key) {
            return key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
        }

        // Quick action handler
        function performQuickAction(action) {
            switch(action) {
                case 'scan':
                    performAIScan();
                    break;
                case 'report':
                    generateFullReport();
                    break;
                case 'whitelist':
                    const url = prompt('Enter URL to whitelist:');
                    if (url) {
                        showNotification('URL Whitelisted', `${url} has been added to safe list.`, 'low');
                    }
                    break;
                case 'block':
                    const threat = prompt('Enter threat to block (URL, IP, or pattern):');
                    if (threat) {
                        showNotification('Threat Blocked', `${threat} has been blocked.`, 'medium');
                    }
                    break;
            }
        }

        // Add animation to protection icons on landing page
        document.querySelectorAll('.protection-icon').forEach(icon => {
            icon.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px)';
                const iconContainer = this.querySelector('.icon-container');
                if (iconContainer) {
                    iconContainer.style.transform = 'scale(1.1) rotate(360deg)';
                }
            });
            
            icon.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                const iconContainer = this.querySelector('.icon-container');
                if (iconContainer) {
                    iconContainer.style.transform = 'scale(1) rotate(0deg)';
                }
            });
        });

        // Add click effect to feature cards
        document.querySelectorAll('.feature').forEach(feature => {
            feature.addEventListener('click', function() {
                this.classList.toggle('active');
            });
        });

        // Initialize tooltips for protection icons
        document.querySelectorAll('.protection-icon').forEach(icon => {
            const tooltip = icon.querySelector('.tooltip-content');
            if (tooltip) {
                icon.addEventListener('mouseenter', () => {
                    tooltip.style.opacity = '1';
                    tooltip.style.visibility = 'visible';
                    tooltip.style.transform = 'translateY(0)';
                });
                
                icon.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = '0';
                    tooltip.style.visibility = 'hidden';
                    tooltip.style.transform = 'translateY(-20px)';
                });
            }
        });

        // Add real-time updating for some values
        setInterval(() => {
            // Randomly update response time slightly
            const responseTime = document.getElementById('avgResponseTime');
            if (responseTime) {
                const currentTime = parseFloat(responseTime.textContent);
                const variation = (Math.random() - 0.5) * 0.2;
                const newTime = Math.max(0.1, Math.min(2.0, currentTime + variation));
                responseTime.textContent = newTime.toFixed(1) + 's';
                
                // Update quick response time
                const responseSpeed = document.getElementById('responseSpeed');
                if (responseSpeed) {
                    responseSpeed.textContent = (newTime * 0.8).toFixed(1) + 's';
                }
            }
        }, 10000);

        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl + R to refresh
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                refreshAllData();
            }
            
            // Ctrl + D for dark mode
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                const darkModeToggle = document.getElementById('darkModeToggle');
                if (darkModeToggle) {
                    darkModeToggle.click();
                }
            }
            
            // Ctrl + / for AI chat
            if (e.ctrlKey && e.key === '/') {
                e.preventDefault();
                toggleAIChat();
            }
            
            // Escape to close modals
            if (e.key === 'Escape') {
                closeModal();
                const aiChatModal = document.getElementById('aiChatModal');
                if (aiChatModal && aiChatModal.style.display === 'flex') {
                    aiChatModal.style.display = 'none';
                }
                const exportOptions = document.getElementById('exportOptions');
                if (exportOptions && exportOptions.classList.contains('show')) {
                    exportOptions.classList.remove('show');
                }
            }
        });

        // Add responsive behavior for window resize
        window.addEventListener('resize', () => {
            Object.keys(charts).forEach(chartName => {
                if (charts[chartName]) {
                    charts[chartName].resize();
                }
            });
        });

        // Add click outside for export options
        document.addEventListener('click', (e) => {
            const exportBtn = document.getElementById('exportBtn');
            const exportOptions = document.getElementById('exportOptions');
            
            if (exportBtn && exportOptions) {
                if (!exportBtn.contains(e.target) && !exportOptions.contains(e.target)) {
                    exportOptions.classList.remove('show');
                }
            }
        });

        // Initialize with a welcome message in console
        console.log('%cðŸ” OmniProtect Security Dashboard v3.0', 'color: #1a73e8; font-size: 16px; font-weight: bold;');
        console.log('%cYour digital assets are being protected by advanced AI algorithms.', 'color: #34a853;');
        console.log('%câš ï¸ This is a security monitoring system. Do not attempt to bypass any security measures.', 'color: #ea4335; font-weight: bold;');

        // Final initialization complete
        setTimeout(() => {
            console.log('%câœ… System initialization complete. All modules active.', 'color: #34a853;');
            showNotification('System Ready', 'All security modules are active and monitoring.', 'low');
        }, 2000);
        // ... all your existing JavaScript code ...

// ===== SIMPLE CLEAR FUNCTION =====
// Simple clear input function
function clearTestInput() {
    const testInput = document.getElementById('testInput');
    if (testInput) {
        testInput.value = '';
        testInput.focus();
    }
}

    </script>
</body>
</html>